import{d as X,r as m,e as $,n as ee,O as ae,o as i,c as n,f as e,w as t,a as r,P as F,F as w,p as z,q as v,Q as le,D as H,x as c,y as S,g as f,t as u,a5 as D,U as re,C as te,G as oe,A as se,B as ie,H as ue,I as pe,J as de,K as me,L as ne,i as ce,M as fe}from"./index-CIfmhqRC.js";import{_ as he}from"./index.vue_vue_type_script_setup_true_lang-DYHi04Tm.js";import{E as we}from"./el-image-DLpquQe6.js";import{_ as ve}from"./DictTag.vue_vue_type_script_lang-CTpVFm77.js";import{_ as ge}from"./ContentWrap.vue_vue_type_script_setup_true_lang-sm5dIhPQ.js";import{c as _e}from"./formatTime-DFFN_xWx.js";import{_ as be}from"./PurchaseOrderForm.vue_vue_type_script_setup_true_lang-eg3s4DM-.js";import{_ as ye}from"./CheckList.vue_vue_type_script_setup_true_lang-CP3KGs2E.js";import{Z as J}from"./index-H3f_2XHj.js";import{n as ke}from"./PurchaseOrderItemForm.vue_vue_type_script_setup_true_lang-Wwp1t-rc.js";import"./index-CrBeVHKs.js";import"./color-BN7ZL7BD.js";import"./el-card-DyMugU68.js";import"./Dialog.vue_vue_type_style_index_0_lang-CtaLqQeX.js";import"./el-descriptions-item-BL6ba85F.js";const xe={class:"flex bg-blue-50 py-1 px-3 dark:bg-blue-900"},Ne={class:"flex-1 text-blue-500 ml-4 dark:text-blue-50"},Se={class:"flex-1 text-blue-500 ml-4 dark:text-blue-50"},Te={class:"pl-4"},Ve={class:"flex gap-5"},Ue={class:"flex-1"},ze={key:1,class:"bg-gray-100 text-gray-600 px-2 dark:bg-blue-100"},De={class:"text-gray-400"},qe=X({name:"ErpPurchaseOrder",__name:"index",setup(Pe){const _=m(!0),T=m([]),V=m(0),l=$({pageNo:1,pageSize:10,orderNumber:void 0,status:void 0,orderTime:"",email:"",shopName:void 0}),q=m();m(!1);const P=m([]),Z=m([{info:"\u5546\u54C1\u4FE1\u606F",price:"\u5355\u4EF7\uFF08USD\uFF09",num:"\u6570\u91CF",requiresShipping:"\u914D\u9001\u65B9\u5F0F"}]),b=async()=>{_.value=!0;let k={pageNo:l.pageNo,pageSize:l.pageSize,id:l.orderNumber,status:l.status,email:l.email,shopName:l.shopName,startDate:l.orderTime&&l.orderTime.length===2?l.orderTime[0]:"",endDate:l.orderTime&&l.orderTime.length===2?l.orderTime[1]:""};try{const o=await J.getOrderPage(k);o?(T.value=o.list?o.list:[],V.value=o.total):(T.value=[],V.value=0)}finally{_.value=!1}},y=()=>{l.pageNo=1,b()},I=()=>{q.value.resetFields(),y()},C=m(),O=m();return ee(async()=>{await b(),await(async()=>{var o;const k=await J.shopPage({pageNo:1,pageSize:10});P.value=(o=k.list)==null?void 0:o.map(g=>({label:g.name,value:g.enName}))})()}),(k,o)=>{const g=re,h=te,Q=oe,R=se,K=ie,A=ue,x=pe,B=de,E=ge,p=me,U=ne,G=ve,L=ce,j=we,W=he,M=ae("hasPermi"),Y=fe;return i(),n(w,null,[e(E,null,{default:t(()=>[e(B,{class:"-mb-15px",model:r(l),ref_key:"queryFormRef",ref:q,inline:!0,"label-width":"88px"},{default:t(()=>[e(h,{label:"\u8BA2\u5355\u53F7",prop:"orderNumber"},{default:t(()=>[e(g,{modelValue:r(l).orderNumber,"onUpdate:modelValue":o[0]||(o[0]=a=>r(l).orderNumber=a),modelModifiers:{number:!0},placeholder:"\u8BF7\u8F93\u5165\u8BA2\u5355\u53F7",clearable:"",onKeyup:F(y,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),e(h,{label:"\u4E70\u5BB6\u90AE\u7BB1"},{default:t(()=>[e(g,{modelValue:r(l).email,"onUpdate:modelValue":o[1]||(o[1]=a=>r(l).email=a),placeholder:"\u8BF7\u8F93\u5165\u4E70\u5BB6\u90AE\u7BB1",clearable:"",onKeyup:F(y,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),e(h,{label:"\u8BA2\u5355\u65F6\u95F4",prop:"orderTime"},{default:t(()=>[e(Q,{modelValue:r(l).orderTime,"onUpdate:modelValue":o[2]||(o[2]=a=>r(l).orderTime=a),"value-format":"YYYY-MM-DD HH:mm:ss",type:"daterange","start-placeholder":"\u5F00\u59CB\u65E5\u671F","end-placeholder":"\u7ED3\u675F\u65E5\u671F","default-time":[new Date("1 00:00:00"),new Date("1 23:59:59")],class:"!w-240px"},null,8,["modelValue","default-time"])]),_:1}),e(h,{label:"\u5E97\u94FA",prop:"shopName"},{default:t(()=>[e(K,{modelValue:r(l).shopName,"onUpdate:modelValue":o[3]||(o[3]=a=>r(l).shopName=a),placeholder:"\u8BF7\u9009\u62E9\u5E97\u94FA",clearable:"",class:"!w-240px"},{default:t(()=>[(i(!0),n(w,null,z(r(P),a=>(i(),v(R,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(h,{label:"\u72B6\u6001",prop:"status"},{default:t(()=>[e(K,{multiple:"",modelValue:r(l).status,"onUpdate:modelValue":o[4]||(o[4]=a=>r(l).status=a),placeholder:"\u8BF7\u9009\u62E9\u72B6\u6001",clearable:"",class:"!w-240px"},{default:t(()=>[(i(!0),n(w,null,z(r(le)(r(H).ZN_ORDER_STATUS),a=>(i(),v(R,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(h,null,{default:t(()=>[e(x,{onClick:y},{default:t(()=>[e(A,{icon:"ep:search",class:"mr-5px"}),c(" \u641C\u7D22 ")]),_:1}),e(x,{onClick:I},{default:t(()=>[e(A,{icon:"ep:refresh",class:"mr-5px"}),c(" \u91CD\u7F6E ")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(E,null,{default:t(()=>[S((i(),v(U,{data:r(T)},{default:t(()=>[e(p,null,{header:t(()=>[e(U,{data:r(Z),"show-header":!1},{default:t(()=>[e(p,{prop:"info","min-width":"300"}),e(p,{prop:"price","min-width":"70"}),e(p,{prop:"num","min-width":"50"}),e(p,{prop:"requiresShipping"})]),_:1},8,["data"])]),default:t(a=>[f("div",xe,[e(G,{type:r(H).ZN_ORDER_STATUS,value:a.row.status},null,8,["type","value"]),f("div",Ne,"\u8BA2\u5355\u53F7\uFF1A#"+u(a.row.orderNumber),1),f("div",Se,"\u521B\u5EFA\u65F6\u95F4\uFF1A"+u(r(_e)(a.row.createdAt)),1),f("div",Te,[S((i(),v(x,{link:"",onClick:s=>{return d="detail",N=a.row,void C.value.open(d,N);var d,N}},{default:t(()=>[c(" \u67E5\u770B\u8BE6\u60C5 ")]),_:2},1032,["onClick"])),[[M,["znerp:alllist:query"]]]),a.row.status===0?(i(),n(w,{key:0},[e(L,{direction:"vertical"}),a.row.status===0?S((i(),v(x,{key:0,link:"",onClick:s=>{return d=a.row,void O.value.open(d);var d}},{default:t(()=>[c(" \u5BA1\u6838 ")]),_:2},1032,["onClick"])),[[M,["znerp:alllist:check"]]]):D("",!0)],64)):D("",!0)])]),S((i(),v(U,{data:a.row.orderItems,"show-header":!1},{default:t(()=>[e(p,{"min-width":"300"},{default:t(s=>[f("div",Ve,[e(j,{style:{width:"64px",height:"64px"},src:s.row.src?s.row.src:r(ke),fit:"cover"},null,8,["src"]),f("div",Ue,[f("h4",null,u(s.row.title),1),JSON.parse(s.row.properties).length>0?(i(!0),n(w,{key:0},z(JSON.parse(s.row.properties),(d,N)=>(i(),n("p",{key:"prop_"+N},[d.value.includes("https://")?D("",!0):(i(),n(w,{key:0},[c(u(d.name)+": "+u(d.value),1)],64))]))),128)):(i(),n("span",ze,"Variants: "+u(s.row.variantTitle?s.row.variantTitle:"\u6682\u65E0"),1)),f("p",De,"SKU\uFF1A"+u(s.row.zhProductSku?s.row.zhProductSku:"\u6682\u65E0"),1)])])]),_:1}),e(p,{"min-width":"70"},{default:t(s=>[c(u(s.row.price),1)]),_:1}),e(p,{"min-width":"50"},{default:t(s=>[c(u(s.row.quantity),1)]),_:1}),e(p,{prop:"requiresShipping"},{default:t(s=>[c(u(s.row.requiresShipping==1?"\u8FD0\u8F93":"\u65E0\u9700\u53D1\u8D27"),1)]),_:1})]),_:2},1032,["data"])),[[Y,r(_)]])]),_:1})]),_:1},8,["data"])),[[Y,r(_)]]),e(W,{total:r(V),page:r(l).pageNo,"onUpdate:page":o[5]||(o[5]=a=>r(l).pageNo=a),limit:r(l).pageSize,"onUpdate:limit":o[6]||(o[6]=a=>r(l).pageSize=a),onPagination:b},null,8,["total","page","limit"])]),_:1}),e(be,{ref_key:"formRef",ref:C},null,512),e(ye,{ref_key:"checkRef",ref:O,onSuccess:b},null,512)],64)}}});export{qe as default};
