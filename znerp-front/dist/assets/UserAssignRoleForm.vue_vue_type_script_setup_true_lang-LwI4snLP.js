import{d as R,h as S,z as j,r,o as i,q as f,w as u,f as o,a as l,x as y,y as q,c as z,F as B,p as J,k as D,U as M,C as E,A as G,B as H,J as K,I as L,M as N}from"./index-CIfmhqRC.js";import{_ as O}from"./Dialog.vue_vue_type_style_index_0_lang-CtaLqQeX.js";import{c as P,d as Q}from"./index-C2AwNSU-.js";import{g as T}from"./index-CSBlvrKl.js";const W=R({name:"SystemUserAssignRoleForm",__name:"UserAssignRoleForm",emits:["success"],setup(X,{expose:V,emit:k}){const{t:b}=S(),I=j(),m=r(!1),n=r(!1),e=r({id:-1,nickname:"",username:"",roleIds:[]}),t=r(),v=r([]);V({open:async d=>{m.value=!0,F(),e.value.id=d.id,e.value.username=d.username,e.value.nickname=d.nickname,n.value=!0;try{e.value.roleIds=await P(d.id)}finally{n.value=!1}v.value=await T()}});const U=k,w=async()=>{if(t&&await t.value.validate()){n.value=!0;try{await Q({userId:e.value.id,roleIds:e.value.roleIds}),I.success(b("common.updateSuccess")),m.value=!1,U("success",!0)}finally{n.value=!1}}},F=()=>{var d;e.value={id:-1,nickname:"",username:"",roleIds:[]},(d=t.value)==null||d.resetFields()};return(d,s)=>{const p=M,c=E,x=G,g=H,h=K,_=L,A=O,C=N;return i(),f(A,{modelValue:l(m),"onUpdate:modelValue":s[4]||(s[4]=a=>D(m)?m.value=a:null),title:"\u5206\u914D\u89D2\u8272"},{footer:u(()=>[o(_,{disabled:l(n),type:"primary",onClick:w},{default:u(()=>[y("\u786E \u5B9A")]),_:1},8,["disabled"]),o(_,{onClick:s[3]||(s[3]=a=>m.value=!1)},{default:u(()=>[y("\u53D6 \u6D88")]),_:1})]),default:u(()=>[q((i(),f(h,{ref_key:"formRef",ref:t,model:l(e),"label-width":"80px"},{default:u(()=>[o(c,{label:"\u7528\u6237\u540D\u79F0"},{default:u(()=>[o(p,{modelValue:l(e).username,"onUpdate:modelValue":s[0]||(s[0]=a=>l(e).username=a),disabled:!0},null,8,["modelValue"])]),_:1}),o(c,{label:"\u7528\u6237\u6635\u79F0"},{default:u(()=>[o(p,{modelValue:l(e).nickname,"onUpdate:modelValue":s[1]||(s[1]=a=>l(e).nickname=a),disabled:!0},null,8,["modelValue"])]),_:1}),o(c,{label:"\u89D2\u8272"},{default:u(()=>[o(g,{modelValue:l(e).roleIds,"onUpdate:modelValue":s[2]||(s[2]=a=>l(e).roleIds=a),multiple:"",placeholder:"\u8BF7\u9009\u62E9\u89D2\u8272"},{default:u(()=>[(i(!0),z(B,null,J(l(v),a=>(i(),f(x,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])),[[C,l(n)]])]),_:1},8,["modelValue"])}}});export{W as _};
