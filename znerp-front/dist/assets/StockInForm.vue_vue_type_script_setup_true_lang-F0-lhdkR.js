import{bt as r,d as K,h as N,z as O,r as i,e as Q,a3 as W,o as f,q as v,w as l,a as e,x as F,a5 as X,f as a,y as Z,c as ee,F as ae,p as le,k as C,U as te,C as se,E as oe,G as ue,A as de,B as ie,cn as re,j as ne,J as pe,l as me,m as ce,I as fe,M as ve}from"./index-CIfmhqRC.js";import{_ as ke}from"./Dialog.vue_vue_type_style_index_0_lang-CtaLqQeX.js";import{_ as _e}from"./ContentWrap.vue_vue_type_script_setup_true_lang-sm5dIhPQ.js";import{_ as ye}from"./StockInItemForm.vue_vue_type_script_setup_true_lang-CI6ZJ13g.js";import{S as be}from"./index-DDwo_T5x.js";const k={getStockInPage:async u=>await r.get({url:"/erp/stock-in/page",params:u}),getStockIn:async u=>await r.get({url:"/erp/stock-in/get?id="+u}),createStockIn:async u=>await r.post({url:"/erp/stock-in/create",data:u}),updateStockIn:async u=>await r.put({url:"/erp/stock-in/update",data:u}),updateStockInStatus:async(u,_)=>await r.put({url:"/erp/stock-in/update-status",params:{id:u,status:_}}),deleteStockIn:async u=>await r.delete({url:"/erp/stock-in/delete",params:{ids:u.join(",")}}),exportStockIn:async u=>await r.download({url:"/erp/stock-in/export-excel",params:u})},we=K({name:"StockInForm",__name:"StockInForm",emits:["success"],setup(u,{expose:_,emit:j}){const{t:y}=N(),I=O(),n=i(!1),g=i(""),p=i(!1),b=i(""),o=i({id:void 0,supplierId:void 0,inTime:void 0,remark:void 0,fileUrl:"",items:[]}),q=Q({inTime:[{required:!0,message:"\u5165\u5E93\u65F6\u95F4\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),w=W(()=>b.value==="detail"),V=i(),U=i([]),S=i("item"),x=i();_({open:async(d,t)=>{if(n.value=!0,g.value=y("action."+d),b.value=d,E(),t){p.value=!0;try{o.value=await k.getStockIn(t)}finally{p.value=!1}}U.value=await be.getSupplierSimpleList()}});const z=j,A=async()=>{await V.value.validate(),await x.value.validate(),p.value=!0;try{const d=o.value;b.value==="create"?(await k.createStockIn(d),I.success(y("common.createSuccess"))):(await k.updateStockIn(d),I.success(y("common.updateSuccess"))),n.value=!1,z("success")}finally{p.value=!1}},E=()=>{var d;o.value={id:void 0,supplierId:void 0,inTime:void 0,remark:void 0,fileUrl:void 0,items:[]},(d=V.value)==null||d.resetFields()};return(d,t)=>{const h=te,m=se,c=oe,G=ue,P=de,R=ie,B=re,D=ne,J=pe,L=me,M=ce,Y=_e,T=fe,$=ke,H=ve;return f(),v($,{title:e(g),modelValue:e(n),"onUpdate:modelValue":t[7]||(t[7]=s=>C(n)?n.value=s:null),width:"1080"},{footer:l(()=>[e(w)?X("",!0):(f(),v(T,{key:0,onClick:A,type:"primary",disabled:e(p)},{default:l(()=>[F(" \u786E \u5B9A ")]),_:1},8,["disabled"])),a(T,{onClick:t[6]||(t[6]=s=>n.value=!1)},{default:l(()=>[F("\u53D6 \u6D88")]),_:1})]),default:l(()=>[Z((f(),v(J,{ref_key:"formRef",ref:V,model:e(o),rules:e(q),"label-width":"100px",disabled:e(w)},{default:l(()=>[a(D,{gutter:20},{default:l(()=>[a(c,{span:8},{default:l(()=>[a(m,{label:"\u5165\u5E93\u5355\u53F7",prop:"no"},{default:l(()=>[a(h,{disabled:"",modelValue:e(o).no,"onUpdate:modelValue":t[0]||(t[0]=s=>e(o).no=s),placeholder:"\u4FDD\u5B58\u65F6\u81EA\u52A8\u751F\u6210"},null,8,["modelValue"])]),_:1})]),_:1}),a(c,{span:8},{default:l(()=>[a(m,{label:"\u5165\u5E93\u65F6\u95F4",prop:"inTime"},{default:l(()=>[a(G,{modelValue:e(o).inTime,"onUpdate:modelValue":t[1]||(t[1]=s=>e(o).inTime=s),type:"date","value-format":"x",placeholder:"\u9009\u62E9\u5165\u5E93\u65F6\u95F4",class:"!w-1/1"},null,8,["modelValue"])]),_:1})]),_:1}),a(c,{span:8},{default:l(()=>[a(m,{label:"\u4F9B\u5E94\u5546",prop:"supplierId"},{default:l(()=>[a(R,{modelValue:e(o).supplierId,"onUpdate:modelValue":t[2]||(t[2]=s=>e(o).supplierId=s),clearable:"",filterable:"",placeholder:"\u8BF7\u9009\u62E9\u4F9B\u5E94\u5546",class:"!w-1/1"},{default:l(()=>[(f(!0),ee(ae,null,le(e(U),s=>(f(),v(P,{key:s.id,label:s.name,value:s.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),a(c,{span:16},{default:l(()=>[a(m,{label:"\u5907\u6CE8",prop:"remark"},{default:l(()=>[a(h,{type:"textarea",modelValue:e(o).remark,"onUpdate:modelValue":t[3]||(t[3]=s=>e(o).remark=s),rows:1,placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8"},null,8,["modelValue"])]),_:1})]),_:1}),a(c,{span:8},{default:l(()=>[a(m,{label:"\u9644\u4EF6",prop:"fileUrl"},{default:l(()=>[a(B,{"is-show-tip":!1,modelValue:e(o).fileUrl,"onUpdate:modelValue":t[4]||(t[4]=s=>e(o).fileUrl=s),limit:1},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules","disabled"])),[[H,e(p)]]),a(Y,null,{default:l(()=>[a(M,{modelValue:e(S),"onUpdate:modelValue":t[5]||(t[5]=s=>C(S)?S.value=s:null),class:"-mt-15px -mb-10px"},{default:l(()=>[a(L,{label:"\u5165\u5E93\u4EA7\u54C1\u6E05\u5355",name:"item"},{default:l(()=>[a(ye,{ref_key:"itemFormRef",ref:x,items:e(o).items,disabled:e(w)},null,8,["items","disabled"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["title","modelValue"])}}});export{k as S,we as _};
