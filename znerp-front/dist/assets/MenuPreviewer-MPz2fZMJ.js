import{d as M,a3 as N,o as i,c as u,f as m,w as g,g as _,W as b,x as O,t as y,a as h,a5 as k,k as T,F as j,H as A,_ as D}from"./index-CIfmhqRC.js";import{V}from"./vuedraggable.umd-CcTr7I5e.js";const F={class:"menu_bottom"},H=["onClick"],L={key:0,class:"submenu"},P={class:"menu_bottom subtitle"},S=["onClick"],W=["onClick"],q=D(M({__name:"MenuPreviewer",props:{modelValue:{},activeIndex:{},parentIndex:{},accountId:{}},emits:["update:modelValue","menu-clicked","submenu-clicked"],setup(f,{emit:C}){const d=f,o=C,s=N({get:()=>d.modelValue,set:n=>o("update:modelValue",n)}),E=()=>{const n=s.value.length,l={name:"\u83DC\u5355\u540D\u79F0",children:[],reply:{type:"text",accountId:d.accountId}};s.value[n]=l,x(l,n-1)},x=(n,l)=>{o("menu-clicked",n,l)},I=(n,l,a)=>{o("submenu-clicked",n,l,a)},w=({oldIndex:n,newIndex:l})=>{if(d.activeIndex==="__MENU_NOT_SELECTED__")return;let a=new Array(s.value.length).fill(!1);a[d.parentIndex]=!0;const[e]=a.splice(n,1);a.splice(l,0,e);const t=a.indexOf(!0),c=s.value[t];o("menu-clicked",c,t)},U=({newIndex:n})=>{var t;const l=d.parentIndex,a=n,e=(t=s.value[l])==null?void 0:t.children;if(e&&(e==null?void 0:e.length)>0){const c=e[a];o("submenu-clicked",c,l,a)}};return(n,l)=>{const a=A;return i(),u(j,null,[m(h(V),{modelValue:h(s),"onUpdate:modelValue":l[0]||(l[0]=e=>T(s)?s.value=e:null),"item-key":"id","ghost-class":"draggable-ghost",animation:400,onEnd:w},{item:g(({element:e,index:t})=>[_("div",F,[_("div",{onClick:c=>x(e,t),class:b(["menu_item",{active:d.activeIndex===`${t}`}])},[m(a,{icon:"ep:fold",color:"black"}),O(y(e.name),1)],10,H),d.parentIndex===t&&e.children?(i(),u("div",L,[m(h(V),{modelValue:e.children,"onUpdate:modelValue":c=>e.children=c,"item-key":"id","ghost-class":"draggable-ghost",animation:400,onEnd:U},{item:g(({element:c,index:r})=>[_("div",P,[e.children?(i(),u("div",{key:0,class:b(["menu_subItem",{active:d.activeIndex===`${t}-${r}`}]),onClick:p=>I(c,t,r)},y(c.name),11,S)):k("",!0)])]),_:2},1032,["modelValue","onUpdate:modelValue"]),!e.children||e.children.length<5?(i(),u("div",{key:0,class:"menu_bottom menu_addicon",onClick:c=>((r,p)=>{const v=p.children.length,$={name:"\u5B50\u83DC\u5355\u540D\u79F0",reply:{type:"text",accountId:d.accountId}};p.children[v]=$,I(p.children[v],r,v)})(t,e)},[m(a,{icon:"ep:plus",class:"plus"})],8,W)):k("",!0)])):k("",!0)])]),_:1},8,["modelValue"]),h(s).length<3?(i(),u("div",{key:0,class:"menu_bottom menu_addicon",onClick:E},[m(a,{icon:"ep:plus",class:"plus"})])):k("",!0)],64)}}}),[["__scopeId","data-v-7c5212d5"]]);export{q as default};
