import{d as ee,b as re,z as ae,r as f,e as te,n as le,o as l,c,f as e,w as t,a as o,P as oe,F as y,p as G,q as g,x as p,y as H,g as h,D as ie,t as n,a5 as k,U as se,C as pe,A as ne,B as ue,H as de,I as ce,J as me,K as we,L as fe,i as ye,M as ke}from"./index-CIfmhqRC.js";import{_ as ge}from"./index.vue_vue_type_script_setup_true_lang-DYHi04Tm.js";import{E as he}from"./el-image-DLpquQe6.js";import{_ as _e}from"./DictTag.vue_vue_type_script_lang-CTpVFm77.js";import{_ as ve}from"./ContentWrap.vue_vue_type_script_setup_true_lang-sm5dIhPQ.js";import{_ as Se}from"./PurchaseOrderForm.vue_vue_type_script_setup_true_lang-eg3s4DM-.js";import{_ as be}from"./UploadImage.vue_vue_type_script_setup_true_lang-CrxuI2Mo.js";import{_ as xe}from"./CheckForm.vue_vue_type_script_setup_true_lang-Cf0grHjr.js";import{Z as z}from"./index-H3f_2XHj.js";import{n as Ie}from"./PurchaseOrderItemForm.vue_vue_type_script_setup_true_lang-Wwp1t-rc.js";import"./index-CrBeVHKs.js";import"./color-BN7ZL7BD.js";import"./el-card-DyMugU68.js";import"./Dialog.vue_vue_type_style_index_0_lang-CtaLqQeX.js";import"./el-descriptions-item-BL6ba85F.js";import"./formatTime-DFFN_xWx.js";const Ne={class:"flex bg-blue-50 py-1 px-3 dark:bg-blue-900"},Ce={class:"flex-1 text-blue-500 ml-4"},Ue={class:"pl-4"},qe={class:"flex gap-5"},ze={class:"flex-1"},Pe={key:1,class:"bg-gray-100 text-gray-600 px-2 dark:bg-blue-100"},Ve={class:"text-gray-400"},Re={class:"flex flex-row-reverse"},De=ee({__name:"index",setup(Je){const P=re().getUser.id,V=ae(),v=f(!0),I=f(0),N=f([]),u=te({pageNo:1,pageSize:10,orderNumber:"",status:"11,22",shopName:void 0}),R=f(),D=f([]),L=f([{info:"\u5546\u54C1\u4FE1\u606F",price:"\u5355\u4EF7\uFF08USD\uFF09",num:"\u6570\u91CF",requiresShipping:"\u914D\u9001\u65B9\u5F0F",option:""}]),_=async()=>{v.value=!0;try{const s=await z.getOrderPage(u);s?(N.value=s.list?s.list:[],I.value=s.total):(N.value=[],I.value=0)}finally{v.value=!1}},C=()=>{u.pageNo=1,_()},M=()=>{R.value.resetFields(),C()},J=f(),O=f(),T=(s,i)=>{O.value.open(s,i)},F=f(),K=(s,i)=>{F.value.open(s,i)},A=async s=>{try{await V.confirm("\u786E\u5B9A\u9886\u53D6\u5236\u7248\u4EFB\u52A1\u5417\uFF1F");let i={orderId:s.orderId,itemId:s.id,productId:s.productId,type:2};await z.updateDraftsPage(i),V.success("\u9886\u53D6\u6210\u529F\uFF01"),await _()}catch{}};return le(async()=>{await _(),await(async()=>{var i;const s=await z.shopPage({pageNo:1,pageSize:10});D.value=(i=s.list)==null?void 0:i.map(S=>({label:S.name,value:S.enName}))})()}),(s,i)=>{const S=se,U=pe,W=ne,j=ue,E=de,m=ce,Q=me,Z=ve,d=we,q=fe,X=_e,b=ye,Y=he,$=ge,B=ke;return l(),c(y,null,[e(Z,null,{default:t(()=>[e(Q,{ref_key:"queryFormRef",ref:R,inline:!0,model:o(u),class:"-mb-15px","label-width":"88px"},{default:t(()=>[e(U,{label:"\u8BA2\u5355\u53F7",prop:"orderNumber"},{default:t(()=>[e(S,{modelValue:o(u).orderNumber,"onUpdate:modelValue":i[0]||(i[0]=a=>o(u).orderNumber=a),placeholder:"\u8BF7\u8F93\u5165\u8BA2\u5355\u53F7",clearable:"",onKeyup:oe(C,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),e(U,{label:"\u5E97\u94FA",prop:"shopName"},{default:t(()=>[e(j,{modelValue:o(u).shopName,"onUpdate:modelValue":i[1]||(i[1]=a=>o(u).shopName=a),placeholder:"\u8BF7\u9009\u62E9\u5E97\u94FA",clearable:"",class:"!w-240px"},{default:t(()=>[(l(!0),c(y,null,G(o(D),a=>(l(),g(W,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(U,null,{default:t(()=>[e(m,{onClick:C},{default:t(()=>[e(E,{class:"mr-5px",icon:"ep:search"}),p(" \u641C\u7D22 ")]),_:1}),e(m,{onClick:M},{default:t(()=>[e(E,{class:"mr-5px",icon:"ep:refresh"}),p(" \u91CD\u7F6E ")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(Z,null,{default:t(()=>[H((l(),g(q,{data:o(N)},{default:t(()=>[e(d,null,{header:t(()=>[e(q,{data:o(L),"show-header":!1},{default:t(()=>[e(d,{prop:"info",width:"500"}),e(d,{prop:"price",width:"200"}),e(d,{prop:"num",width:"100"}),e(d,{prop:"requiresShipping",width:"200"}),e(d,{prop:"option",align:"right"})]),_:1},8,["data"])]),default:t(a=>[h("div",Ne,[e(X,{type:o(ie).ZN_ORDER_STATUS,value:a.row.status},null,8,["type","value"]),h("div",Ce,"#"+n(a.row.orderNumber),1),h("div",Ue,[e(m,{link:"",onClick:r=>{return w="detail",x=a.row,void J.value.open(w,x);var w,x}},{default:t(()=>[p(" \u67E5\u770B\u8BE6\u60C5 ")]),_:2},1032,["onClick"]),a.row.type==1&&a.row.orderItems[0].printers.length===0?(l(),c(y,{key:0},[e(b,{direction:"vertical"}),e(m,{link:"",onClick:r=>A(a.row.orderItems[0])},{default:t(()=>[p(" \u9886\u53D6\u4EFB\u52A1 ")]),_:2},1032,["onClick"])],64)):k("",!0),a.row.type==1&&a.row.orderItems[0].printers.length>0?(l(),c(y,{key:1},[e(b,{direction:"vertical"}),a.row.orderItems[0].printers[0].userId===o(P)?(l(),g(m,{key:0,onClick:r=>T("plate",a.row.orderItems[0]),link:""},{default:t(()=>[p(n(a.row.orderItems[0].printers[0].imgUrl?"\u4FEE\u6539":"\u4E0A\u4F20")+"\u56FE\u7247 ",1)]),_:2},1032,["onClick"])):k("",!0),a.row.orderItems[0].printers[0].imgUrl?(l(),c(y,{key:1},[e(b,{direction:"vertical"}),e(m,{type:a.row.orderItems[0].printStatus==1?"success":a.row.orderItems[0].printStatus==2?"danger":"primary",onClick:r=>K("plate",a.row.orderItems[0].printers[0]),link:""},{default:t(()=>[p(" \u5BA1\u6838"+n(a.row.orderItems[0].printStatus==1?"\u901A\u8FC7":a.row.orderItems[0].printStatus==2?"\u4E0D\u901A\u8FC7":""),1)]),_:2},1032,["type","onClick"])],64)):k("",!0)],64)):k("",!0)])]),H((l(),g(q,{data:a.row.orderItems,"show-header":!1},{default:t(()=>[e(d,{width:"500"},{default:t(r=>[h("div",qe,[e(Y,{style:{width:"64px",height:"64px"},src:r.row.src?r.row.src:o(Ie),fit:"cover"},null,8,["src"]),h("div",ze,[h("h4",null,n(r.row.title),1),JSON.parse(r.row.properties).length>0?(l(!0),c(y,{key:0},G(JSON.parse(r.row.properties),(w,x)=>(l(),c("p",{key:"prop_"+x},[w.value.includes("https://")?k("",!0):(l(),c(y,{key:0},[p(n(w.name)+": "+n(w.value),1)],64))]))),128)):(l(),c("span",Pe,"Variants: "+n(r.row.variantTitle?r.row.variantTitle:"\u6682\u65E0"),1)),h("p",Ve,"SKU\uFF1A"+n(r.row.zhProductSku?r.row.zhProductSku:"\u6682\u65E0"),1)])])]),_:1}),e(d,{width:"200"},{default:t(r=>[p(n(r.row.price),1)]),_:1}),e(d,{width:"100"},{default:t(r=>[p(n(r.row.quantity),1)]),_:1}),e(d,{prop:"requiresShipping"},{default:t(r=>[p(n(r.row.requiresShipping==1?"\u8FD0\u8F93":"\u65E0\u9700\u53D1\u8D27"),1)]),_:1}),a.row.type==2?(l(),g(d,{key:0,width:"200"},{default:t(r=>[h("div",Re,[r.row.printers.length===0?(l(),g(m,{key:0,type:"primary",link:"",onClick:w=>A(r.row)},{default:t(()=>[p(" \u9886\u53D6\u4EFB\u52A1 ")]),_:2},1032,["onClick"])):(l(),c(y,{key:1},[r.row.printers[0].imgUrl?(l(),c(y,{key:0},[e(m,{type:r.row.printStatus==1?"success":r.row.printStatus==2?"danger":"primary",onClick:w=>K("plate",r.row),link:""},{default:t(()=>[p(" \u5BA1\u6838"+n(r.row.printStatus==1?"\u901A\u8FC7":r.row.printStatus==2?"\u4E0D\u901A\u8FC7":""),1)]),_:2},1032,["type","onClick"]),r.row.printStatus==2?(l(),g(b,{key:0,direction:"vertical"})):k("",!0)],64)):k("",!0),r.row.printStatus!==1&&r.row.printers[0].userId===o(P)?(l(),g(m,{key:1,type:"primary",link:"",onClick:w=>T("plate",r.row)},{default:t(()=>[p(n(r.row.printers[0].imgUrl?"\u4FEE\u6539":"\u4E0A\u4F20")+"\u56FE\u7247 ",1)]),_:2},1032,["onClick"])):k("",!0)],64))])]),_:1})):k("",!0)]),_:2},1032,["data"])),[[B,o(v)]])]),_:1})]),_:1},8,["data"])),[[B,o(v)]]),e($,{limit:o(u).pageSize,"onUpdate:limit":i[2]||(i[2]=a=>o(u).pageSize=a),page:o(u).pageNo,"onUpdate:page":i[3]||(i[3]=a=>o(u).pageNo=a),total:o(I),onPagination:_},null,8,["limit","page","total"])]),_:1}),e(Se,{ref_key:"detailRef",ref:J,onSuccess:_},null,512),e(be,{ref_key:"uploadImgRef",ref:O,onSuccess:_},null,512),e(xe,{ref_key:"checkRef",ref:F,onSuccess:_},null,512)],64)}}});export{De as default};
