import{d as S,z as q,e4 as B,r as b,a3 as z,n as I,o as r,c as v,a as i,b as F,c7 as J,g as s,F as P,p as K,f as e,w as n,x as O,t as T,q as Q,a5 as k,e5 as X,e6 as Z,e7 as s2,aw as e2,I as a2,bm as t2,a0 as c2,a1 as l2,_ as i2}from"./index-CIfmhqRC.js";import{E as n2}from"./el-text-DMgoq9G3.js";import{E as o2}from"./el-avatar-Cbg-oQZd.js";import{f as R}from"./formatTime-DFFN_xWx.js";import{M as r2}from"./index-CY7R6inO.js";import{H as $}from"./index-BDu05CpY.js";import{C as d2}from"./index-CdT4chXa.js";import{a as p2}from"./avatar-BG6NdH5s.js";import{r as v2}from"./gpt-WhTktY3S.js";import"./fetch-D5K_4anA.js";const j="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1715352878351'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='1499'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='200'%20height='200'%3e%3cpath%20d='M624.5%20786.3c92.9%200%20168.2-75.3%20168.2-168.2V309c0-92.4-75.3-168.2-168.2-168.2H303.6c-92.4%200-168.2%2075.3-168.2%20168.2v309.1c0%2092.4%2075.3%20168.2%20168.2%20168.2h320.9zM178.2%20618.1V309c0-69.4%2056.1-125.5%20125.5-125.5h320.9c69.4%200%20125.5%2056.1%20125.5%20125.5v309.1c0%2069.4-56.1%20125.5-125.5%20125.5h-321c-69.4%200-125.4-56.1-125.4-125.5z'%20p-id='1500'%20fill='%238a8a8a'%3e%3c/path%3e%3cpath%20d='M849.8%20295.1v361.5c0%20102.7-83.6%20186.3-186.3%20186.3H279.1v42.7h384.4c126.3%200%20229.1-102.8%20229.1-229.1V295.1h-42.8zM307.9%20361.8h312.3c11.8%200%2021.4-9.6%2021.4-21.4%200-11.8-9.6-21.4-21.4-21.4H307.9c-11.8%200-21.4%209.6-21.4%2021.4%200%2011.9%209.6%2021.4%2021.4%2021.4zM307.9%20484.6h312.3c11.8%200%2021.4-9.6%2021.4-21.4%200-11.8-9.6-21.4-21.4-21.4H307.9c-11.8%200-21.4%209.6-21.4%2021.4%200%2011.9%209.6%2021.4%2021.4%2021.4z'%20p-id='1501'%20fill='%238a8a8a'%3e%3c/path%3e%3cpath%20d='M620.2%20607.4c11.8%200%2021.4-9.6%2021.4-21.4%200-11.8-9.6-21.4-21.4-21.4H307.9c-11.8%200-21.4%209.6-21.4%2021.4%200%2011.8%209.6%2021.4%2021.4%2021.4h312.3z'%20p-id='1502'%20fill='%238a8a8a'%3e%3c/path%3e%3c/svg%3e",A="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1715354120346'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='3256'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='200'%20height='200'%3e%3cpath%20d='M907.1%20263.7H118.9c-9.1%200-16.4-7.3-16.4-16.4s7.3-16.4%2016.4-16.4H907c9.1%200%2016.4%207.3%2016.4%2016.4s-7.3%2016.4-16.3%2016.4z'%20fill='%238a8a8a'%20p-id='3257'%3e%3c/path%3e%3cpath%20d='M772.5%20928.3H257.4c-27.7%200-50.2-22.5-50.2-50.2V247.2c0-9.1%207.3-16.4%2016.4-16.4H801c12.1%200%2021.9%209.8%2021.9%2021.9v625.2c0%2027.8-22.6%2050.4-50.4%2050.4zM240%20263.7v614.4c0%209.6%207.8%2017.4%2017.4%2017.4h515.2c9.7%200%2017.5-7.9%2017.5-17.5V263.7H240zM657.4%20131.1H368.6c-9.1%200-16.4-7.3-16.4-16.4s7.3-16.4%2016.4-16.4h288.7c9.1%200%2016.4%207.3%2016.4%2016.4s-7.3%2016.4-16.3%2016.4z'%20fill='%238a8a8a'%20p-id='3258'%3e%3c/path%3e%3cpath%20d='M416%20754.5c-9.1%200-16.4-7.3-16.4-16.4V517.8c0-9.1%207.3-16.4%2016.4-16.4s16.4%207.3%2016.4%2016.4V738c0.1%209.1-7.3%2016.5-16.4%2016.5z'%20fill='%238a8a8a'%20p-id='3259'%3e%3c/path%3e%3cpath%20d='M416%20465.2c-9.1%200-16.4-7.3-16.4-16.4v-59.4c0-9.1%207.3-16.4%2016.4-16.4s16.4%207.3%2016.4%2016.4v59.4c0.1%209.1-7.3%2016.4-16.4%2016.4zM604.9%20754.5c-9.1%200-16.4-7.3-16.4-16.4v-67.2c0-9.1%207.3-16.4%2016.4-16.4s16.4%207.3%2016.4%2016.4V738c0%209.1-7.3%2016.5-16.4%2016.5z'%20fill='%238a8a8a'%20opacity='.4'%20p-id='3260'%3e%3c/path%3e%3cpath%20d='M604.9%20619.1c-9.1%200-16.4-7.3-16.4-16.4V389.4c0-9.1%207.3-16.4%2016.4-16.4s16.4%207.3%2016.4%2016.4v213.3c0%209.1-7.3%2016.4-16.4%2016.4z'%20fill='%238a8a8a'%20p-id='3261'%3e%3c/path%3e%3c/svg%3e",h2=["innerHTML"],u2=S({__name:"index",props:{content:{type:String,required:!0}},setup(d){const x=d,C=q(),{copy:g}=B(),m=b(),_=new r2({highlight:function(l,o){if(o&&$.getLanguage(o))try{return`<pre style="position: relative;">${`<div id="copy" data-copy='${l}' style="position: absolute; right: 10px; top: 5px; color: #fff;cursor: pointer;">\u590D\u5236</div>`}<code class="hljs">${$.highlight(o,l,!0).value}</code></pre>`}catch{}return""}}),c=z(()=>_.render(x.content));return I(async()=>{m.value.addEventListener("click",l=>{var o,h;l.target.id==="copy"&&(g((h=(o=l.target)==null?void 0:o.dataset)==null?void 0:h.copy),C.success("\u590D\u5236\u6210\u529F!"))})}),(l,o)=>(r(),v("div",{ref_key:"contentRef",ref:m,class:"markdown-view",innerHTML:i(c)},null,8,h2))}}),y=d=>(c2("data-v-365260d4"),d=d(),l2(),d),g2={key:0,class:"left-message message-item"},m2={class:"avatar"},f2={class:"message"},w2={class:"left-btns"},k2=y(()=>s("img",{class:"btn-image",src:j},null,-1)),y2=y(()=>s("img",{class:"btn-image h-17px",src:A},null,-1)),x2={key:1,class:"right-message message-item"},C2={class:"avatar"},_2={class:"message"},H2={class:"right-text-container"},M2={class:"right-text"},b2={class:"right-btns"},z2=y(()=>s("img",{class:"btn-image",src:j},null,-1)),T2=y(()=>s("img",{class:"btn-image h-17px mr-12px",src:A},null,-1)),V2=i2(S({__name:"MessageList",props:{conversation:{type:Object,required:!0},list:{type:Array,required:!0}},emits:["onDeleteSuccess","onRefresh","onEdit"],setup(d,{expose:x,emit:C}){const g=q(),{copy:m}=B(),_=F(),c=b(null),l=b(!1),o=z(()=>_.user.avatar||p2),h=z(()=>V.conversation.roleAvatar??v2),V=d,{list:N}=J(V),H=C;function U(){const a=c.value,L=a.scrollTop,f=a.scrollHeight,w=a.offsetHeight;l.value=L+w<f-100}const W=async()=>{const a=c.value;a.scrollTop=a.scrollHeight};x({scrollToBottom:async a=>{await e2(),!a&&l.value||(c.value.scrollTop=c.value.scrollHeight-c.value.offsetHeight)},handlerGoTop:async()=>{c.value.scrollTop=0}});const D=async a=>{await m(a),g.success("\u590D\u5236\u6210\u529F\uFF01")},E=async a=>{await d2.deleteChatMessage(a),g.success("\u5220\u9664\u6210\u529F\uFF01"),H("onDeleteSuccess")};return I(async()=>{c.value.addEventListener("scroll",U)}),(a,L)=>{const f=o2,w=n2,p=a2,G=t2;return r(),v(P,null,[s("div",{ref_key:"messageContainer",ref:c,class:"h-100% overflow-y-auto relative"},[(r(!0),v(P,null,K(i(N),(t,Y)=>(r(),v("div",{class:"chat-list",key:Y},[t.type!=="user"?(r(),v("div",g2,[s("div",m2,[e(f,{src:i(h)},null,8,["src"])]),s("div",f2,[s("div",null,[e(w,{class:"time"},{default:n(()=>[O(T(i(R)(t.createTime)),1)]),_:2},1024)]),s("div",{class:"left-text-container",ref_for:!0,ref:"markdownViewRef"},[e(u2,{class:"left-text",content:t.content},null,8,["content"])],512),s("div",w2,[e(p,{class:"btn-cus",link:"",onClick:u=>D(t.content)},{default:n(()=>[k2]),_:2},1032,["onClick"]),t.id>0?(r(),Q(p,{key:0,class:"btn-cus",link:"",onClick:u=>E(t.id)},{default:n(()=>[y2]),_:2},1032,["onClick"])):k("",!0)])])])):k("",!0),t.type==="user"?(r(),v("div",x2,[s("div",C2,[e(f,{src:i(o)},null,8,["src"])]),s("div",_2,[s("div",null,[e(w,{class:"time"},{default:n(()=>[O(T(i(R)(t.createTime)),1)]),_:2},1024)]),s("div",H2,[s("div",M2,T(t.content),1)]),s("div",b2,[e(p,{class:"btn-cus",link:"",onClick:u=>D(t.content)},{default:n(()=>[z2]),_:2},1032,["onClick"]),e(p,{class:"btn-cus",link:"",onClick:u=>E(t.id)},{default:n(()=>[T2]),_:2},1032,["onClick"]),e(p,{class:"btn-cus",link:"",onClick:u=>(async M=>{H("onRefresh",M)})(t)},{default:n(()=>[e(G,{size:"17"},{default:n(()=>[e(i(X))]),_:1})]),_:2},1032,["onClick"]),e(p,{class:"btn-cus",link:"",onClick:u=>(async M=>{H("onEdit",M)})(t)},{default:n(()=>[e(G,{size:"17"},{default:n(()=>[e(i(Z))]),_:1})]),_:2},1032,["onClick"])])])])):k("",!0)]))),128))],512),i(l)?(r(),v("div",{key:0,class:"to-bottom",onClick:W},[e(p,{icon:i(s2),circle:""},null,8,["icon"])])):k("",!0)],64)}}}),[["__scopeId","data-v-365260d4"]]);export{V2 as default};
