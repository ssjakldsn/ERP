import{ej as b,d as x,r as v,e as F,n as P,o as _,c as R,f as e,w as n,a as i,y as E,q as L,D as g,F as O,K as q,L as M,M as S,aE as j,ek as B}from"./index-CIfmhqRC.js";import{_ as D}from"./DictTag.vue_vue_type_script_lang-CTpVFm77.js";import{E as W}from"./el-card-DyMugU68.js";import{E as Y}from"./el-skeleton-item-Dm6LwaUQ.js";import{_ as k}from"./Echart.vue_vue_type_script_setup_true_lang-C-1NoClp.js";import{S as A}from"./customer-Y0u55tjD.js";const I=x({name:"CustomerFollowupType",__name:"CustomerFollowUpType",props:{queryParams:{}},setup(h,{expose:U}){const C=h,p=v(!1),w=v([]),s=F({title:{text:"\u5BA2\u6237\u8DDF\u8FDB\u65B9\u5F0F\u5206\u6790",left:"center"},legend:{orient:"vertical",left:"left"},tooltip:{trigger:"item",formatter:"{b} : {c}% "},toolbox:{feature:{saveAsImage:{show:!0,name:"\u5BA2\u6237\u8DDF\u8FDB\u65B9\u5F0F\u5206\u6790"}}},series:[{name:"\u8DDF\u8FDB\u65B9\u5F0F",type:"pie",radius:"50%",data:[],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]}),T=async()=>{const m=await A.getFollowUpSummaryByType(C.queryParams);s.series&&s.series[0]&&s.series[0].data&&(s.series[0].data=m.map(a=>({name:j(g.CRM_FOLLOW_UP_TYPE,a.followUpType),value:a.followUpRecordCount})));const y=(d="followUpRecordCount",(l=m)&&l.length?function(a,o){for(var t,u=-1,f=a.length;++u<f;){var r=o(a[u]);r!==void 0&&(t=t===void 0?r:t+r)}return t}(l,b(d)):0);var l,d;w.value=m.map(a=>({...a,portion:B(a.followUpRecordCount,y)}))},c=async()=>{p.value=!0;try{await T()}finally{p.value=!1}};return U({loadData:c}),P(()=>{c()}),(m,y)=>{const l=k,d=Y,a=W,o=q,t=D,u=M,f=S;return _(),R(O,null,[e(a,{shadow:"never"},{default:n(()=>[e(d,{loading:i(p),animated:""},{default:n(()=>[e(l,{height:500,options:i(s)},null,8,["options"])]),_:1},8,["loading"])]),_:1}),e(a,{shadow:"never",class:"mt-16px"},{default:n(()=>[E((_(),L(u,{data:i(w)},{default:n(()=>[e(o,{label:"\u5E8F\u53F7",align:"center",type:"index",width:"80"}),e(o,{label:"\u8DDF\u8FDB\u65B9\u5F0F",align:"center",prop:"followUpType","min-width":"200"},{default:n(r=>[e(t,{type:i(g).CRM_FOLLOW_UP_TYPE,value:r.row.followUpType},null,8,["type","value"])]),_:1}),e(o,{label:"\u4E2A\u6570",align:"center",prop:"followUpRecordCount","min-width":"200"}),e(o,{label:"\u5360\u6BD4(%)",align:"center",prop:"portion","min-width":"200"})]),_:1},8,["data"])),[[f,i(p)]])]),_:1})],64)}}});export{I as _};
