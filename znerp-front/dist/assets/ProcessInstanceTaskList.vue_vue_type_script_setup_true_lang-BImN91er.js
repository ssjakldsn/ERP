import{d as K,ai as w,r as b,as as Z,o as s,c as i,y as G,q as y,w as t,f as l,a as e,k as Q,F as P,M as W,g as c,x as p,t as n,D as B,a5 as o,p as X,ay as Y,aw as $,H as aa,I as sa,av as ea,E as ta}from"./index-CIfmhqRC.js";import{_ as la}from"./Dialog.vue_vue_type_style_index_0_lang-CtaLqQeX.js";import{E as na,a as oa}from"./el-timeline-item-r9TewDuU.js";import{E as ra}from"./el-card-DyMugU68.js";import{_ as ia}from"./DictTag.vue_vue_type_script_lang-CTpVFm77.js";import{f as v,a as ua}from"./formatTime-DFFN_xWx.js";import{_ as ma}from"./TaskSignList.vue_vue_type_script_setup_true_lang-DXj2-Asd.js";import{b as ca}from"./formCreate-ECTif2qa.js";const pa=c("span",{class:"el-icon-picture-outline"},"\u5BA1\u6279\u8BB0\u5F55",-1),fa={class:"block"},da={style:{"font-weight":"700"}},ya={style:{"font-weight":"700"}},ga={key:0,style:{"margin-right":"30px","font-weight":"normal"}},ka={key:1,style:{"font-weight":"normal"}},_a={style:{"font-weight":"normal",color:"#8a909c"}},ha={key:2,style:{"margin-left":"30px","font-weight":"normal"}},wa={key:3,style:{"font-weight":"normal",color:"#8a909c"}},ba={key:4,style:{"margin-left":"30px","font-weight":"normal"}},va={key:5,style:{"font-weight":"normal",color:"#8a909c"}},Ia={key:6},Ta={style:{"font-weight":"700"}},Sa=K({name:"BpmProcessInstanceTaskList",__name:"ProcessInstanceTaskList",props:{loading:w.bool,processInstance:w.object,tasks:w.arrayOf(w.object)},emits:["refresh"],setup(r,{emit:z}){const L=m=>[0,1,6,7].includes(m.status)?"primary":m.status===2?"success":m.status===3?"danger":m.status===4?"info":m.status===5?"warning":"",T=b(),g=b(),f=b({rule:[],option:{},value:{}}),k=b(!1),N=z,j=()=>{N("refresh")};return(m,_)=>{const S=ia,I=na,x=aa,U=sa,F=ea,C=ra,O=oa,R=ta,q=Z("form-create"),D=la,H=W;return s(),i(P,null,[G((s(),y(C,{class:"box-card"},{header:t(()=>[pa]),default:t(()=>[l(R,{offset:3,span:17},{default:t(()=>[c("div",fa,[l(O,null,{default:t(()=>{return[r.processInstance.endTime?(s(),y(I,{key:0,type:(u=r.processInstance,u.status===2?"success":u.status===3?"danger":u.status===4?"warning":"")},{default:t(()=>{var a;return[c("p",da,[p(" \u7ED3\u675F\u6D41\u7A0B\uFF1A\u5728 "+n(e(v)((a=r.processInstance)==null?void 0:a.endTime))+" \u7ED3\u675F ",1),l(S,{type:e(B).BPM_PROCESS_INSTANCE_STATUS,value:r.processInstance.status},null,8,["type","value"])])]}),_:1},8,["type"])):o("",!0),(s(!0),i(P,null,X(r.tasks,(a,h)=>(s(),y(I,{key:h,type:L(a)},{default:t(()=>[c("p",ya,[p(" \u5BA1\u6279\u4EFB\u52A1\uFF1A"+n(a.name)+" ",1),l(S,{type:e(B).BPM_TASK_STATUS,value:a.status},null,8,["type","value"]),e(Y)(a.children)?o("",!0):(s(),y(U,{key:0,class:"ml-10px",onClick:J=>(d=>{T.value.open(d)})(a),size:"small"},{default:t(()=>[l(x,{icon:"ep:memo"}),p(" \u5B50\u4EFB\u52A1 ")]),_:2},1032,["onClick"])),a.formId>0?(s(),y(U,{key:1,class:"ml-10px",size:"small",onClick:J=>(async d=>{var V,M,A,E;ca(f,d.formConf,d.formFields,d.formVariables),k.value=!0,await $(),g.value.fapi.btn.show(!1),(M=(V=g.value)==null?void 0:V.fapi)==null||M.resetBtn.show(!1),(E=(A=g.value)==null?void 0:A.fapi)==null||E.disabled(!0)})(a)},{default:t(()=>[l(x,{icon:"ep:document"}),p(" \u67E5\u770B\u8868\u5355 ")]),_:2},1032,["onClick"])):o("",!0)]),l(C,{"body-style":{padding:"10px"}},{default:t(()=>[a.assigneeUser?(s(),i("label",ga,[p(" \u5BA1\u6279\u4EBA\uFF1A"+n(a.assigneeUser.nickname)+" ",1),l(F,{size:"small",type:"info"},{default:t(()=>[p(n(a.assigneeUser.deptName),1)]),_:2},1024)])):o("",!0),a.createTime?(s(),i("label",ka,"\u521B\u5EFA\u65F6\u95F4\uFF1A")):o("",!0),c("label",_a,n(e(v)(a==null?void 0:a.createTime)),1),a.endTime?(s(),i("label",ha," \u5BA1\u6279\u65F6\u95F4\uFF1A ")):o("",!0),a.endTime?(s(),i("label",wa,n(e(v)(a==null?void 0:a.endTime)),1)):o("",!0),a.durationInMillis?(s(),i("label",ba," \u8017\u65F6\uFF1A ")):o("",!0),a.durationInMillis?(s(),i("label",va,n(e(ua)(a==null?void 0:a.durationInMillis)),1)):o("",!0),a.reason?(s(),i("p",Ia," \u5BA1\u6279\u5EFA\u8BAE\uFF1A"+n(a.reason),1)):o("",!0)]),_:2},1024)]),_:2},1032,["type"]))),128)),l(I,{type:"success"},{default:t(()=>{var a,h;return[c("p",Ta," \u53D1\u8D77\u6D41\u7A0B\uFF1A\u3010"+n((a=r.processInstance.startUser)==null?void 0:a.nickname)+"\u3011\u5728 "+n(e(v)((h=r.processInstance)==null?void 0:h.startTime))+" \u53D1\u8D77\u3010 "+n(r.processInstance.name)+" \u3011\u6D41\u7A0B ",1)]}),_:1})];var u}),_:1})])]),_:1})]),_:1})),[[H,r.loading]]),l(ma,{ref_key:"taskSignListRef",ref:T,onSuccess:j},null,512),l(D,{title:"\u8868\u5355\u8BE6\u60C5",modelValue:e(k),"onUpdate:modelValue":_[1]||(_[1]=u=>Q(k)?k.value=u:null),width:"600"},{default:t(()=>[l(q,{ref_key:"fApi",ref:g,modelValue:e(f).value,"onUpdate:modelValue":_[0]||(_[0]=u=>e(f).value=u),option:e(f).option,rule:e(f).rule},null,8,["modelValue","option","rule"])]),_:1},8,["modelValue"])],64)}}});export{Sa as _};
