import{bt as c,d as Y,h as q,z as F,r as i,e as j,o as p,q as _,w as u,f as d,a as e,x as V,y as z,c as B,F as J,p as D,a5 as G,k as $,A as H,B as P,C as W,cc as X,ce as Z,J as ee,I as ae,M as le}from"./index-CIfmhqRC.js";import{_ as te}from"./Dialog.vue_vue_type_style_index_0_lang-CtaLqQeX.js";import{E as se}from"./el-tree-select-CYFGeiEt.js";import{g as ue}from"./index-C34hh2Ad.js";import{d as oe,h as de}from"./tree-BMqZf9_I.js";import{g as ie}from"./index-QrlE36WK.js";var n=(s=>(s[s.CUSTOMER_QUANTITY_LIMIT=1]="CUSTOMER_QUANTITY_LIMIT",s[s.CUSTOMER_LOCK_LIMIT=2]="CUSTOMER_LOCK_LIMIT",s))(n||{});const re=async s=>await c.get({url:"/crm/customer-limit-config/page",params:s}),me=async s=>await c.delete({url:"/crm/customer-limit-config/delete?id="+s}),ne=Y({__name:"CustomerLimitConfigForm",emits:["success"],setup(s,{expose:w,emit:E}){const{t:C}=q(),T=F(),r=i(!1),g=i(""),m=i(!1),b=i(""),l=i({id:void 0,type:n.CUSTOMER_LOCK_LIMIT,userIds:void 0,deptIds:void 0,maxCount:void 0,dealCountEnabled:!1}),O=j({type:[{required:!0,message:"\u89C4\u5219\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],maxCount:[{required:!0,message:"\u6570\u91CF\u4E0A\u9650\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),f=i(),M=i(),U=i([]);w({open:async(o,a,v)=>{if(r.value=!0,g.value=C("action."+o),b.value=o,R(),v){m.value=!0;try{l.value=await(async y=>await c.get({url:"/crm/customer-limit-config/get?id="+y}))(v)}finally{m.value=!1}}else l.value.type=a;M.value=de(await ue()),U.value=await ie()}});const S=E,x=async()=>{if(f&&await f.value.validate()){m.value=!0;try{const o=l.value;b.value==="create"?(await(async a=>await c.post({url:"/crm/customer-limit-config/create",data:a}))(o),T.success(C("common.createSuccess"))):(await(async a=>await c.put({url:"/crm/customer-limit-config/update",data:a}))(o),T.success(C("common.updateSuccess"))),r.value=!1,S("success")}finally{m.value=!1}}},R=()=>{var o;l.value={id:void 0,type:n.CUSTOMER_LOCK_LIMIT,userIds:void 0,deptIds:void 0,maxCount:void 0,dealCountEnabled:!1},(o=f.value)==null||o.resetFields()};return(o,a)=>{const v=H,y=P,I=W,k=se,h=X,A=Z,K=ee,L=ae,N=te,Q=le;return p(),_(N,{title:e(g),modelValue:e(r),"onUpdate:modelValue":a[5]||(a[5]=t=>$(r)?r.value=t:null)},{footer:u(()=>[d(L,{onClick:x,type:"primary",disabled:e(m)},{default:u(()=>[V("\u786E \u5B9A")]),_:1},8,["disabled"]),d(L,{onClick:a[4]||(a[4]=t=>r.value=!1)},{default:u(()=>[V("\u53D6 \u6D88")]),_:1})]),default:u(()=>[z((p(),_(K,{ref_key:"formRef",ref:f,model:e(l),rules:e(O),"label-width":"200px"},{default:u(()=>[d(I,{label:"\u89C4\u5219\u9002\u7528\u4EBA\u7FA4",prop:"userIds"},{default:u(()=>[d(y,{multiple:"",filterable:"",modelValue:e(l).userIds,"onUpdate:modelValue":a[0]||(a[0]=t=>e(l).userIds=t)},{default:u(()=>[(p(!0),B(J,null,D(e(U),t=>(p(),_(v,{key:t.id,label:t.nickname,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),d(I,{label:"\u89C4\u5219\u9002\u7528\u90E8\u95E8",prop:"deptIds"},{default:u(()=>[d(k,{modelValue:e(l).deptIds,"onUpdate:modelValue":a[1]||(a[1]=t=>e(l).deptIds=t),data:e(M),props:e(oe),multiple:"",filterable:"","check-strictly":"","node-key":"id",placeholder:"\u8BF7\u9009\u62E9\u89C4\u5219\u9002\u7528\u90E8\u95E8"},null,8,["modelValue","data","props"])]),_:1}),d(I,{label:e(l).type===e(n).CUSTOMER_QUANTITY_LIMIT?"\u62E5\u6709\u5BA2\u6237\u6570\u4E0A\u9650":"\u9501\u5B9A\u5BA2\u6237\u6570\u4E0A\u9650",prop:"maxCount"},{default:u(()=>[d(h,{modelValue:e(l).maxCount,"onUpdate:modelValue":a[2]||(a[2]=t=>e(l).maxCount=t),placeholder:"\u8BF7\u8F93\u5165\u6570\u91CF\u4E0A\u9650"},null,8,["modelValue"])]),_:1},8,["label"]),e(l).type===e(n).CUSTOMER_QUANTITY_LIMIT?(p(),_(I,{key:0,label:"\u6210\u4EA4\u5BA2\u6237\u662F\u5426\u5360\u7528\u62E5\u6709\u5BA2\u6237\u6570",prop:"dealCountEnabled"},{default:u(()=>[d(A,{modelValue:e(l).dealCountEnabled,"onUpdate:modelValue":a[3]||(a[3]=t=>e(l).dealCountEnabled=t)},null,8,["modelValue"])]),_:1})):G("",!0)]),_:1},8,["model","rules"])),[[Q,e(m)]])]),_:1},8,["title","modelValue"])}}});export{n as L,ne as _,me as d,re as g};
