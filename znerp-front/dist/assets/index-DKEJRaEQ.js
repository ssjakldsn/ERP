import{d as B,r as o,u as D,N as E,n as L,o as n,c as Q,y as U,a as t,q as c,w as a,x as A,a5 as M,f as i,F as V,z as W,I as j,l as H,m as P,E as $,M as G}from"./index-CIfmhqRC.js";import{g as J,_ as K}from"./index-Bm5JfAS4.js";import{u as X}from"./tagsView-CqxiFcdS.js";import{a as Y}from"./index-B_QTmj5f.js";import{_ as Z}from"./ContactDetailsHeader.vue_vue_type_script_setup_true_lang-D3EOpyXu.js";import{_ as tt}from"./ContactDetailsInfo.vue_vue_type_script_setup_true_lang-DZ5Ewg14.js";import{_ as it}from"./BusinessList.vue_vue_type_script_setup_true_lang-K5adT8NL.js";import{_ as at}from"./PermissionList.vue_vue_type_script_setup_true_lang-BJ8SS8cZ.js";import{B as m}from"./index-8CYEcIk3.js";import{_ as rt}from"./ContactForm.vue_vue_type_script_setup_true_lang-CLRF_VIq.js";import{_ as ot}from"./TransferForm.vue_vue_type_script_setup_true_lang-BkZZyHcA.js";import{_ as et}from"./index.vue_vue_type_script_setup_true_lang-PdFImspl.js";import"./el-timeline-item-r9TewDuU.js";import"./formatTime-DFFN_xWx.js";import"./ContentWrap.vue_vue_type_script_setup_true_lang-sm5dIhPQ.js";import"./el-card-DyMugU68.js";import"./el-descriptions-item-BL6ba85F.js";import"./el-collapse-item-BgajxfOI.js";import"./DictTag.vue_vue_type_script_lang-CTpVFm77.js";import"./color-BN7ZL7BD.js";import"./index.vue_vue_type_script_setup_true_lang-DYHi04Tm.js";import"./index-CrBeVHKs.js";import"./index-B5nlbV2q.js";import"./BusinessForm.vue_vue_type_script_setup_true_lang-BT6WnAjK.js";import"./Dialog.vue_vue_type_style_index_0_lang-CtaLqQeX.js";import"./index-CwB7FJGa.js";import"./index-BZptzjxi.js";import"./index-QrlE36WK.js";import"./BusinessProductForm.vue_vue_type_script_setup_true_lang-23yRPDfu.js";import"./index-BVTl5RdT.js";import"./BusinessListModal.vue_vue_type_script_setup_true_lang-DoLUy-ZT.js";import"./PermissionForm.vue_vue_type_script_setup_true_lang-BA269V0x.js";import"./index-w2FCJT7Q.js";import"./tree-BMqZf9_I.js";import"./index-IYA49QTG.js";import"./index-jPQDaA_X.js";import"./FollowUpRecordForm.vue_vue_type_script_setup_true_lang-CX5nVT22.js";import"./FollowUpRecordBusinessForm.vue_vue_type_script_setup_true_lang-DxrArb3L.js";import"./FollowUpRecordContactForm.vue_vue_type_script_setup_true_lang-DLVeCN1i.js";import"./ContactListModal.vue_vue_type_script_setup_true_lang-KXTfVMT0.js";const lt=B({name:"CrmContactDetail",__name:"index",setup(mt){const N=W(),s=o(0),u=o(!0),r=o({}),d=o(),_=async()=>{u.value=!0;try{r.value=await Y(s.value),await g(s.value)}finally{u.value=!1}},y=o(),b=o(),O=()=>{var e;(e=b.value)==null||e.open(r.value.id)},C=o([]),g=async e=>{if(!e)return;const p=await J({bizType:m.CRM_CONTACT,bizId:e});C.value=p.list},{delView:x}=X(),{currentRoute:I}=D(),f=()=>{x(t(I))},{params:z}=E();return L(async()=>{if(!z.id)return N.warning("\u53C2\u6570\u9519\u8BEF\uFF0C\u8054\u7CFB\u4EBA\u4E0D\u80FD\u4E3A\u7A7A\uFF01"),void f();s.value=z.id,await _()}),(e,p)=>{const v=j,l=H,F=K,S=P,h=$,q=G;return n(),Q(V,null,[U((n(),c(Z,{contact:t(r)},{default:a(()=>{var T,w;return[(T=t(d))!=null&&T.validateWrite?(n(),c(v,{key:0,onClick:p[0]||(p[0]=st=>{return R="update",k=t(r).id,void y.value.open(R,k);var R,k})},{default:a(()=>[A(" \u7F16\u8F91 ")]),_:1})):M("",!0),(w=t(d))!=null&&w.validateOwnerUser?(n(),c(v,{key:1,type:"primary",onClick:O},{default:a(()=>[A(" \u8F6C\u79FB ")]),_:1})):M("",!0)]}),_:1},8,["contact"])),[[q,t(u)]]),i(h,null,{default:a(()=>[i(S,null,{default:a(()=>[i(l,{label:"\u8DDF\u8FDB\u8BB0\u5F55"},{default:a(()=>[i(et,{"biz-id":t(s),"biz-type":t(m).CRM_CONTACT},null,8,["biz-id","biz-type"])]),_:1}),i(l,{label:"\u8BE6\u7EC6\u8D44\u6599"},{default:a(()=>[i(tt,{contact:t(r)},null,8,["contact"])]),_:1}),i(l,{label:"\u64CD\u4F5C\u65E5\u5FD7"},{default:a(()=>[i(F,{"log-list":t(C)},null,8,["log-list"])]),_:1}),i(l,{label:"\u56E2\u961F\u6210\u5458"},{default:a(()=>[i(at,{ref_key:"permissionListRef",ref:d,"biz-id":t(r).id,"biz-type":t(m).CRM_CONTACT,"show-action":!0,onQuitTeam:f},null,8,["biz-id","biz-type"])]),_:1}),i(l,{label:"\u5546\u673A",lazy:""},{default:a(()=>[i(it,{"biz-id":t(r).id,"biz-type":t(m).CRM_CONTACT,"contact-id":t(r).id,"customer-id":t(r).customerId},null,8,["biz-id","biz-type","contact-id","customer-id"])]),_:1})]),_:1})]),_:1}),i(rt,{ref_key:"formRef",ref:y,onSuccess:_},null,512),i(ot,{ref_key:"transferFormRef",ref:b,"biz-type":t(m).CRM_CONTACT,onSuccess:f},null,8,["biz-type"])],64)}}});export{lt as default};
