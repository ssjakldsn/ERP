import{P as L,_ as P}from"./util-jDjqY1ok.js";import{d as R,r as t,e as T,u as q,n as B,a as e,o as c,q as k,w as u,f,c as C,p as H,F as J,k as K,a5 as j,z as Q,aJ as A,H as E,aK as G,aL as M,al as N}from"./index-CIfmhqRC.js";import{g as O,u as W}from"./template-D--TX1Cb.js";import{u as X}from"./page-C8k3MItl.js";import{u as Y}from"./tagsView-CqxiFcdS.js";import"./Dialog.vue_vue_type_style_index_0_lang-CtaLqQeX.js";import"./Qrcode-DR4gTqIE.js";import"./el-text-DMgoq9G3.js";import"./IFrame.vue_vue_type_script_setup_true_lang-CiSUdYeS.js";import"./el-card-DyMugU68.js";import"./vuedraggable.umd-CcTr7I5e.js";import"./el-collapse-item-BgajxfOI.js";const g="diy_page_index",Z=R({name:"DiyTemplateDecorate",__name:"decorate",setup(ee){const a=t(0),m=T([{name:"\u57FA\u7840\u8BBE\u7F6E",icon:"ep:iphone"},{name:"\u9996\u9875",icon:"ep:home-filled"},{name:"\u6211\u7684",icon:"ep:user-filled"}]),w=Q(),n=t(!1),l=t(),y=t(),s=t(),h=t(""),_=[],p=t(_),b=()=>{if(a.value===0)return p.value=_,void(s.value=l.value);p.value=L,s.value=l.value.pages.find(r=>r.name===m[a.value].name)},x=async()=>{if(y){n.value=!0;try{a.value===0?await W(e(l)):await X(e(s)),w.success("\u4FDD\u5B58\u6210\u529F")}finally{n.value=!1}}},I=()=>S(),S=()=>sessionStorage.setItem(g,`${a.value}`),{currentRoute:v}=q(),{delView:D}=Y();return B(async()=>{var r;if(l.value={id:void 0,name:"",used:!1,usedTime:void 0,remark:"",previewPicUrls:[],property:"",pages:[]},(r=y.value)==null||r.resetFields(),!v.value.params.id)return w.warning("\u53C2\u6570\u9519\u8BEF\uFF0C\u9875\u9762\u7F16\u53F7\u4E0D\u80FD\u4E3A\u7A7A\uFF01"),void D(e(v));await(async o=>{n.value=!0;try{l.value=await O(o),s.value=l.value;const d="http://mall.yudao.iocoder.cn";h.value=`${d}/#/pages/index/index?templateId=${l.value.id}`}finally{n.value=!1}})(v.value.params.id),(()=>{const o=A(sessionStorage.getItem(g))||0;sessionStorage.removeItem(g),o!==a.value&&(a.value=o,b())})()}),(r,o)=>{const d=E,U=G,$=M,z=N,F=P;return e(l)&&!e(n)?(c(),k(F,{key:0,modelValue:e(s).property,"onUpdate:modelValue":o[1]||(o[1]=i=>e(s).property=i),title:e(m)[e(a)].name,libs:e(p),"show-page-config":e(a)!==0,"show-tab-bar":e(a)===0,"show-navigation-bar":e(a)!==0,"preview-url":e(h),onSave:x,onReset:I},{toolBarLeft:u(()=>[f(z,{modelValue:e(a),"onUpdate:modelValue":o[0]||(o[0]=i=>K(a)?a.value=i:null),class:"h-full!",onChange:b},{default:u(()=>[(c(!0),C(J,null,H(e(m),(i,V)=>(c(),k($,{key:V,content:i.name},{default:u(()=>[f(U,{value:V},{default:u(()=>[f(d,{icon:i.icon,size:24},null,8,["icon"])]),_:2},1032,["value"])]),_:2},1032,["content"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["modelValue","title","libs","show-page-config","show-tab-bar","show-navigation-bar","preview-url"])):j("",!0)}}});export{Z as default};
