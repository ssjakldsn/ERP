import{d as R,z as j,h as D,r as s,e as G,n as Q,O as T,o as p,c as w,f as e,w as t,a as l,F as b,p as U,q as u,x as m,y as h,ep as X,A as $,B as Y,C as Z,H as ee,I as ae,J as le,K as te,L as oe,M as re}from"./index-CIfmhqRC.js";import{_ as se}from"./index.vue_vue_type_script_setup_true_lang-DYHi04Tm.js";import{_ as pe}from"./ContentWrap.vue_vue_type_script_setup_true_lang-sm5dIhPQ.js";import{_ as ie}from"./index-2RHHZ-Zv.js";import{d as ne}from"./download-D5Lb_h0f.js";import{S as F}from"./index-DsNMwdtg.js";import{P as ue}from"./index-C-VA7MOy.js";import{W as de}from"./index-DXR61XEe.js";import"./index-CrBeVHKs.js";import"./el-card-DyMugU68.js";const ce=R({name:"ErpStock",__name:"index",setup(me){const q=j();D();const f=s(!0),x=s([]),y=s(0),o=G({pageNo:1,pageSize:10,productId:void 0,warehouseId:void 0}),k=s(),g=s(!1),I=s([]),S=s([]),v=async()=>{f.value=!0;try{const i=await F.getStockPage(o);x.value=i.list,y.value=i.total}finally{f.value=!1}},N=()=>{o.pageNo=1,v()},W=()=>{k.value.resetFields(),N()},A=s(),B=async()=>{try{await q.exportConfirm(),g.value=!0;const i=await F.exportStock(o);ne.excel(i,"\u4EA7\u54C1\u5E93\u5B58.xls")}catch{}finally{g.value=!1}};return Q(async()=>{await v(),I.value=await ue.getProductSimpleList(),S.value=await de.getWarehouseSimpleList()}),(i,r)=>{const E=ie,C=$,P=Y,_=Z,d=ee,c=ae,H=le,V=pe,n=te,J=oe,K=se,z=T("hasPermi"),M=re;return p(),w(b,null,[e(E,{title:"\u3010\u5E93\u5B58\u3011\u4EA7\u54C1\u5E93\u5B58\u3001\u5E93\u5B58\u660E\u7EC6",url:"https://doc.iocoder.cn/erp/stock/"}),e(V,null,{default:t(()=>[e(H,{class:"-mb-15px",model:l(o),ref_key:"queryFormRef",ref:k,inline:!0,"label-width":"68px"},{default:t(()=>[e(_,{label:"\u4EA7\u54C1",prop:"productId"},{default:t(()=>[e(P,{modelValue:l(o).productId,"onUpdate:modelValue":r[0]||(r[0]=a=>l(o).productId=a),clearable:"",filterable:"",placeholder:"\u8BF7\u9009\u62E9\u4EA7\u54C1",class:"!w-240px"},{default:t(()=>[(p(!0),w(b,null,U(l(I),a=>(p(),u(C,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(_,{label:"\u4ED3\u5E93",prop:"warehouseId"},{default:t(()=>[e(P,{modelValue:l(o).warehouseId,"onUpdate:modelValue":r[1]||(r[1]=a=>l(o).warehouseId=a),clearable:"",filterable:"",placeholder:"\u8BF7\u9009\u62E9\u4ED3\u5E93",class:"!w-240px"},{default:t(()=>[(p(!0),w(b,null,U(l(S),a=>(p(),u(C,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(_,null,{default:t(()=>[e(c,{onClick:N},{default:t(()=>[e(d,{icon:"ep:search",class:"mr-5px"}),m(" \u641C\u7D22")]),_:1}),e(c,{onClick:W},{default:t(()=>[e(d,{icon:"ep:refresh",class:"mr-5px"}),m(" \u91CD\u7F6E")]),_:1}),h((p(),u(c,{type:"primary",plain:"",onClick:r[2]||(r[2]=a=>{return L="create",void A.value.open(L,O);var L,O})},{default:t(()=>[e(d,{icon:"ep:plus",class:"mr-5px"}),m(" \u65B0\u589E ")]),_:1})),[[z,["erp:stock:create"]]]),h((p(),u(c,{type:"success",plain:"",onClick:B,loading:l(g)},{default:t(()=>[e(d,{icon:"ep:download",class:"mr-5px"}),m(" \u5BFC\u51FA ")]),_:1},8,["loading"])),[[z,["erp:stock:export"]]])]),_:1})]),_:1},8,["model"])]),_:1}),e(V,null,{default:t(()=>[h((p(),u(J,{data:l(x),stripe:!0,"show-overflow-tooltip":!0},{default:t(()=>[e(n,{label:"\u4EA7\u54C1\u540D\u79F0",align:"center",prop:"productName"}),e(n,{label:"\u4EA7\u54C1\u5355\u4F4D",align:"center",prop:"unitName"}),e(n,{label:"\u4EA7\u54C1\u5206\u7C7B",align:"center",prop:"categoryName"}),e(n,{label:"\u5E93\u5B58\u91CF",align:"center",prop:"count",formatter:l(X)},null,8,["formatter"]),e(n,{label:"\u4ED3\u5E93",align:"center",prop:"warehouseName"})]),_:1},8,["data"])),[[M,l(f)]]),e(K,{total:l(y),page:l(o).pageNo,"onUpdate:page":r[3]||(r[3]=a=>l(o).pageNo=a),limit:l(o).pageSize,"onUpdate:limit":r[4]||(r[4]=a=>l(o).pageSize=a),onPagination:v},null,8,["total","page","limit"])]),_:1})],64)}}});export{ce as default};
