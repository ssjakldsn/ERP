import{d as j,r,e as E,u as G,O as Q,o as y,q as v,w as a,f as e,x as p,a as s,P as W,y as V,t as X,dV as Y,k as Z,z as $,U as ee,C as ae,H as le,I as se,J as te,K as oe,af as re,L as ne,M as ie}from"./index-CIfmhqRC.js";import{_ as ue}from"./Dialog.vue_vue_type_style_index_0_lang-CtaLqQeX.js";import{_ as pe}from"./index.vue_vue_type_script_setup_true_lang-DYHi04Tm.js";import{_ as me}from"./ContentWrap.vue_vue_type_script_setup_true_lang-sm5dIhPQ.js";import{g as ce}from"./index-B5nlbV2q.js";import{_ as de}from"./BusinessForm.vue_vue_type_script_setup_true_lang-BT6WnAjK.js";const fe=j({name:"BusinessListModal",__name:"BusinessListModal",props:{customerId:{}},emits:["success"],setup(I,{expose:U,emit:P}){const R=$(),b=I,n=r(!1),d=r(!0),w=r(0),k=r([]),x=r(),z=r(!1),o=E({pageNo:1,pageSize:10,name:void 0,customerId:b.customerId});U({open:async()=>{n.value=!0,o.customerId=b.customerId,await c()}});const c=async()=>{d.value=!0;try{const i=await ce(o);k.value=i.list,w.value=i.total}finally{d.value=!1}},f=()=>{o.pageNo=1,c()},B=()=>{x.value.resetFields(),f()},h=r(),L=P,_=r(),M=async()=>{const i=_.value.getSelectionRows().map(l=>l.id);if(i.length===0)return R.error("\u672A\u9009\u62E9\u5546\u673A");n.value=!1,L("success",i,_.value.getSelectionRows())},{push:q}=G();return(i,l)=>{const F=ee,C=ae,g=le,m=se,K=te,N=me,u=oe,A=re,D=ne,H=pe,J=ue,O=Q("hasPermi"),T=ie;return y(),v(J,{title:"\u5173\u8054\u5546\u673A",modelValue:s(n),"onUpdate:modelValue":l[5]||(l[5]=t=>Z(n)?n.value=t:null)},{footer:a(()=>[e(m,{onClick:M,type:"primary",disabled:s(z)},{default:a(()=>[p("\u786E \u5B9A")]),_:1},8,["disabled"]),e(m,{onClick:l[4]||(l[4]=t=>n.value=!1)},{default:a(()=>[p("\u53D6 \u6D88")]),_:1})]),default:a(()=>[e(N,null,{default:a(()=>[e(K,{class:"-mb-15px",model:s(o),ref_key:"queryFormRef",ref:x,inline:!0,"label-width":"68px"},{default:a(()=>[e(C,{label:"\u5546\u673A\u540D\u79F0",prop:"name"},{default:a(()=>[e(F,{modelValue:s(o).name,"onUpdate:modelValue":l[0]||(l[0]=t=>s(o).name=t),placeholder:"\u8BF7\u8F93\u5165\u5546\u673A\u540D\u79F0",clearable:"",onKeyup:W(f,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),e(C,null,{default:a(()=>[e(m,{onClick:f},{default:a(()=>[e(g,{icon:"ep:search",class:"mr-5px"}),p(" \u641C\u7D22")]),_:1}),e(m,{onClick:B},{default:a(()=>[e(g,{icon:"ep:refresh",class:"mr-5px"}),p(" \u91CD\u7F6E")]),_:1}),V((y(),v(m,{type:"primary",onClick:l[1]||(l[1]=t=>{h.value.open("create")})},{default:a(()=>[e(g,{icon:"ep:plus",class:"mr-5px"}),p(" \u65B0\u589E ")]),_:1})),[[O,["crm:business:create"]]])]),_:1})]),_:1},8,["model"])]),_:1}),e(N,{class:"mt-10px"},{default:a(()=>[V((y(),v(D,{ref_key:"businessRef",ref:_,data:s(k),stripe:!0,"show-overflow-tooltip":!0},{default:a(()=>[e(u,{type:"selection",width:"55"}),e(u,{label:"\u5546\u673A\u540D\u79F0",fixed:"left",align:"center",prop:"name"},{default:a(t=>[e(A,{type:"primary",underline:!1,onClick:_e=>{return S=t.row.id,void q({name:"CrmBusinessDetail",params:{id:S}});var S}},{default:a(()=>[p(X(t.row.name),1)]),_:2},1032,["onClick"])]),_:1}),e(u,{label:"\u5546\u673A\u91D1\u989D",align:"center",prop:"totalPrice",formatter:s(Y)},null,8,["formatter"]),e(u,{label:"\u5BA2\u6237\u540D\u79F0",align:"center",prop:"customerName"}),e(u,{label:"\u5546\u673A\u7EC4",align:"center",prop:"statusTypeName"}),e(u,{label:"\u5546\u673A\u9636\u6BB5",align:"center",prop:"statusName"})]),_:1},8,["data"])),[[T,s(d)]]),e(H,{total:s(w),page:s(o).pageNo,"onUpdate:page":l[2]||(l[2]=t=>s(o).pageNo=t),limit:s(o).pageSize,"onUpdate:limit":l[3]||(l[3]=t=>s(o).pageSize=t),onPagination:c},null,8,["total","page","limit"])]),_:1}),e(de,{ref_key:"formRef",ref:h,onSuccess:c},null,512)]),_:1},8,["modelValue"])}}});export{fe as _};
