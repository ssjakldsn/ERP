import{d as U,r as n,e as j,ar as z,o as m,q as c,w as t,f as p,x as b,a as s,y as B,P as I,a$ as J,c as M,p as R,F as S,k as D,h as $,z as E,A as G,B as H,C as N,J as O,I as Q,M as T}from"./index-CIfmhqRC.js";import{_ as W}from"./Dialog.vue_vue_type_style_index_0_lang-CtaLqQeX.js";import{e as X,f as Y}from"./property-DPsKsB2C.js";const Z=U({name:"ProductPropertyForm",__name:"ProductPropertyAddForm",props:{propertyList:{type:Array,default:()=>{}}},setup(k,{expose:V}){const{t:h}=$(),y=E(),u=n(!1),o=n(!1),a=n({name:""}),x=j({name:[{required:!0,message:"\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),d=n(),i=n([]),v=n([]),F=k;z(()=>F.propertyList,l=>{l&&(i.value=l)},{deep:!0,immediate:!0}),V({open:async()=>{u.value=!0,P(),await A()}});const w=async()=>{for(const e of i.value)if(e.name===a.value.name)return y.error("\u8BE5\u5C5E\u6027\u5DF2\u5B58\u5728\uFF0C\u8BF7\u52FF\u91CD\u590D\u6DFB\u52A0");if(!d||!await d.value.validate())return;const l=v.value.find(e=>e.name===a.value.name);if(l)return i.value.push({id:l.id,...a.value,values:[]}),void(u.value=!1);o.value=!0;try{const e=a.value,f=await X(e);i.value.push({id:f,...a.value,values:[]}),y.success(h("common.createSuccess")),u.value=!1}finally{o.value=!1}},P=()=>{var l;a.value={name:""},(l=d.value)==null||l.resetFields()},A=async()=>{o.value=!0;try{v.value=await Y()}finally{o.value=!1}};return(l,e)=>{const f=G,g=H,C=N,q=O,_=Q,K=W,L=T;return m(),c(K,{modelValue:s(u),"onUpdate:modelValue":e[2]||(e[2]=r=>D(u)?u.value=r:null),title:"\u6DFB\u52A0\u5546\u54C1\u5C5E\u6027"},{footer:t(()=>[p(_,{disabled:s(o),type:"primary",onClick:w},{default:t(()=>[b("\u786E \u5B9A")]),_:1},8,["disabled"]),p(_,{onClick:e[1]||(e[1]=r=>u.value=!1)},{default:t(()=>[b("\u53D6 \u6D88")]),_:1})]),default:t(()=>[B((m(),c(q,{ref_key:"formRef",ref:d,model:s(a),rules:s(x),"label-width":"80px",onKeydown:I(J(w,["prevent"]),["enter"])},{default:t(()=>[p(C,{label:"\u5C5E\u6027\u540D\u79F0",prop:"name"},{default:t(()=>[p(g,{modelValue:s(a).name,"onUpdate:modelValue":e[0]||(e[0]=r=>s(a).name=r),"reserve-keyword":!1,"allow-create":"",class:"!w-360px","default-first-option":"",filterable:"",placeholder:"\u8BF7\u9009\u62E9\u5C5E\u6027\u540D\u79F0\u3002\u5982\u679C\u4E0D\u5B58\u5728\uFF0C\u53EF\u624B\u52A8\u8F93\u5165\u9009\u62E9"},{default:t(()=>[(m(!0),M(S,null,R(s(v),r=>(m(),c(f,{key:r.id,label:r.name,value:r.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules","onKeydown"])),[[L,s(o)]])]),_:1},8,["modelValue"])}}});export{Z as _};
