import{d as J,h as T,z as B,r as i,e as G,o as c,c as v,f as s,w as u,a as e,x as U,y as K,q as I,g as L,a5 as O,k as P,F as Q,C as W,H as X,cl as Y,U as Z,ch as $,cm as ee,J as ae,I as le,M as se}from"./index-CIfmhqRC.js";import{_ as re}from"./Dialog.vue_vue_type_style_index_0_lang-CtaLqQeX.js";import{E as ue}from"./el-image-DLpquQe6.js";import{g as oe,c as de}from"./comment-Bm4YwvZQ.js";import ie from"./SpuShowcase-DQavcwpZ.js";import{_ as te}from"./SkuTableSelect.vue_vue_type_script_setup_true_lang-B1Z-oUnE.js";const ne={key:0},ce={key:1,class:"select-box"},pe=J({__name:"CommentForm",emits:["success"],setup(me,{expose:y,emit:S}){const{t:f}=T(),h=B(),t=i(!1),x=i(""),n=i(!1),b=i(""),a=i({id:void 0,userId:void 0,userNickname:void 0,userAvatar:void 0,spuId:0,skuId:void 0,descriptionScores:5,benefitScores:5,content:void 0,picUrls:[]}),q=G({spuId:[{required:!0,message:"\u5546\u54C1\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],skuId:[{required:!0,message:"\u89C4\u683C\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],userAvatar:[{required:!0,message:"\u7528\u6237\u5934\u50CF\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],userNickname:[{required:!0,message:"\u7528\u6237\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],content:[{required:!0,message:"\u8BC4\u8BBA\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],descriptionScores:[{required:!0,message:"\u63CF\u8FF0\u661F\u7EA7\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],benefitScores:[{required:!0,message:"\u670D\u52A1\u661F\u7EA7\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),p=i(),m=i({id:-1,name:"",picUrl:""});y({open:async(o,l)=>{if(t.value=!0,x.value=f("action."+o),b.value=o,C(),l){n.value=!0;try{a.value=await oe(l)}finally{n.value=!1}}}});const w=S,A=async()=>{if(p&&await p.value.validate()){n.value=!0;try{b.value==="create"&&(await de(e(a.value)),h.success(f("common.createSuccess"))),t.value=!1,w("success")}finally{n.value=!1}}},C=()=>{var o;a.value={id:void 0,userId:void 0,userNickname:void 0,userAvatar:void 0,spuId:0,skuId:void 0,descriptionScores:5,benefitScores:5,content:void 0,picUrls:[]},(o=p.value)==null||o.resetFields()},g=i(),N=()=>{g.value.open()},F=o=>{m.value=o,a.value.skuId=o.id};return(o,l)=>{const d=W,R=ue,z=X,H=Y,V=Z,k=$,M=ee,j=ae,_=le,D=re,E=se;return c(),v(Q,null,[s(D,{modelValue:e(t),"onUpdate:modelValue":l[8]||(l[8]=r=>P(t)?t.value=r:null),title:"\u6DFB\u52A0\u865A\u62DF\u8BC4\u8BBA"},{footer:u(()=>[s(_,{disabled:e(n),type:"primary",onClick:A},{default:u(()=>[U("\u786E \u5B9A")]),_:1},8,["disabled"]),s(_,{onClick:l[7]||(l[7]=r=>t.value=!1)},{default:u(()=>[U("\u53D6 \u6D88")]),_:1})]),default:u(()=>[K((c(),I(j,{ref_key:"formRef",ref:p,model:e(a),rules:e(q),"label-width":"100px"},{default:u(()=>[s(d,{label:"\u5546\u54C1",prop:"spuId"},{default:u(()=>[s(ie,{modelValue:e(a).spuId,"onUpdate:modelValue":l[0]||(l[0]=r=>e(a).spuId=r),limit:1},null,8,["modelValue"])]),_:1}),e(a).spuId?(c(),I(d,{key:0,label:"\u5546\u54C1\u89C4\u683C",prop:"skuId"},{default:u(()=>[L("div",{class:"h-60px w-60px",onClick:N},[e(m)&&e(m).picUrl?(c(),v("div",ne,[s(R,{src:e(m).picUrl},null,8,["src"])])):(c(),v("div",ce,[s(z,{icon:"ep:plus"})]))])]),_:1})):O("",!0),s(d,{label:"\u7528\u6237\u5934\u50CF",prop:"userAvatar"},{default:u(()=>[s(H,{modelValue:e(a).userAvatar,"onUpdate:modelValue":l[1]||(l[1]=r=>e(a).userAvatar=r),height:"60px",width:"60px"},null,8,["modelValue"])]),_:1}),s(d,{label:"\u7528\u6237\u540D\u79F0",prop:"userNickname"},{default:u(()=>[s(V,{modelValue:e(a).userNickname,"onUpdate:modelValue":l[2]||(l[2]=r=>e(a).userNickname=r),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D\u79F0"},null,8,["modelValue"])]),_:1}),s(d,{label:"\u8BC4\u8BBA\u5185\u5BB9",prop:"content"},{default:u(()=>[s(V,{modelValue:e(a).content,"onUpdate:modelValue":l[3]||(l[3]=r=>e(a).content=r),type:"textarea"},null,8,["modelValue"])]),_:1}),s(d,{label:"\u63CF\u8FF0\u661F\u7EA7",prop:"descriptionScores"},{default:u(()=>[s(k,{modelValue:e(a).descriptionScores,"onUpdate:modelValue":l[4]||(l[4]=r=>e(a).descriptionScores=r)},null,8,["modelValue"])]),_:1}),s(d,{label:"\u670D\u52A1\u661F\u7EA7",prop:"benefitScores"},{default:u(()=>[s(k,{modelValue:e(a).benefitScores,"onUpdate:modelValue":l[5]||(l[5]=r=>e(a).benefitScores=r)},null,8,["modelValue"])]),_:1}),s(d,{label:"\u8BC4\u8BBA\u56FE\u7247",prop:"picUrls"},{default:u(()=>[s(M,{modelValue:e(a).picUrls,"onUpdate:modelValue":l[6]||(l[6]=r=>e(a).picUrls=r),limit:9,height:"60px",width:"60px"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])),[[E,e(n)]])]),_:1},8,["modelValue"]),s(te,{ref_key:"skuTableSelectRef",ref:g,"spu-id":e(a).spuId,onChange:F},null,8,["spu-id"])],64)}}});export{pe as _};
