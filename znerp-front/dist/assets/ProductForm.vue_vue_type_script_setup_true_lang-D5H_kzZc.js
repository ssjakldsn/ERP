import{d as z,r as i,b as G,e as H,n as K,o as n,q as c,w as s,f as a,x as R,a as l,y as L,c as V,p as U,F as w,Q as T,D as P,k as W,h as X,z as Y,U as Z,C as $,E as ee,A as le,B as ae,cd as se,cc as de,j as oe,J as ue,I as re,M as te}from"./index-CIfmhqRC.js";import{_ as ie}from"./Dialog.vue_vue_type_style_index_0_lang-CtaLqQeX.js";import{a as ne,c as pe,u as me}from"./index-BVTl5RdT.js";import{g as ce}from"./index-BxLwD91R.js";import{h as ve,d as fe}from"./tree-BMqZf9_I.js";import{g as _e}from"./index-QrlE36WK.js";const be=z({name:"CrmProductForm",__name:"ProductForm",emits:["success"],setup(ge,{expose:S,emit:x}){const{t:f}=X(),y=Y(),p=i(!1),I=i(""),m=i(!1),h=i(""),D=G().getUser.id,o=i({id:void 0,name:void 0,no:void 0,unit:void 0,price:NaN,status:void 0,categoryId:void 0,description:void 0,ownerUserId:-1}),F=H({name:[{required:!0,message:"\u4EA7\u54C1\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],no:[{required:!0,message:"\u4EA7\u54C1\u7F16\u7801\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],status:[{required:!0,message:"\u72B6\u6001\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],categoryId:[{required:!0,message:"\u4EA7\u54C1\u5206\u7C7BID\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],ownerUserId:[{required:!0,message:"\u8D1F\u8D23\u4EBA\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],price:[{required:!0,message:"\u4EF7\u683C\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),v=i();S({open:async(u,d)=>{if(p.value=!0,I.value=f("action."+u),h.value=u,N(),d){m.value=!0;try{o.value=await ne(d)}finally{m.value=!1}}else o.value.ownerUserId=D}});const M=x,A=async()=>{if(v&&await v.value.validate()){m.value=!0;try{const u=o.value;h.value==="create"?(await pe(u),y.success(f("common.createSuccess"))):(await me(u),y.success(f("common.updateSuccess"))),p.value=!1,M("success")}finally{m.value=!1}}},N=()=>{var u;o.value={id:void 0,name:void 0,no:void 0,unit:void 0,price:NaN,status:void 0,categoryId:void 0,description:void 0,ownerUserId:-1},(u=v.value)==null||u.resetFields()},k=i([]),C=i([]);return K(async()=>{const u=await ce({});k.value=ve(u,"id","parentId"),C.value=await _e()}),(u,d)=>{const _=Z,r=$,t=ee,b=le,g=ae,O=se,j=de,B=oe,E=ue,q=re,J=ie,Q=te;return n(),c(J,{title:l(I),modelValue:l(p),"onUpdate:modelValue":d[9]||(d[9]=e=>W(p)?p.value=e:null)},{footer:s(()=>[a(q,{onClick:A,type:"primary",disabled:l(m)},{default:s(()=>[R("\u786E \u5B9A")]),_:1},8,["disabled"]),a(q,{onClick:d[8]||(d[8]=e=>p.value=!1)},{default:s(()=>[R("\u53D6 \u6D88")]),_:1})]),default:s(()=>[L((n(),c(E,{ref_key:"formRef",ref:v,model:l(o),rules:l(F),"label-width":"100px"},{default:s(()=>[a(B,null,{default:s(()=>[a(t,{span:12},{default:s(()=>[a(r,{label:"\u4EA7\u54C1\u540D\u79F0",prop:"name"},{default:s(()=>[a(_,{modelValue:l(o).name,"onUpdate:modelValue":d[0]||(d[0]=e=>l(o).name=e),placeholder:"\u8BF7\u8F93\u5165\u4EA7\u54C1\u540D\u79F0"},null,8,["modelValue"])]),_:1})]),_:1}),a(t,{span:12},{default:s(()=>[a(r,{label:"\u8D1F\u8D23\u4EBA",prop:"ownerUserId"},{default:s(()=>[a(g,{modelValue:l(o).ownerUserId,"onUpdate:modelValue":d[1]||(d[1]=e=>l(o).ownerUserId=e),placeholder:"\u8BF7\u9009\u62E9\u8D1F\u8D23\u4EBA",disabled:l(o).id,class:"w-1/1"},{default:s(()=>[(n(!0),V(w,null,U(l(C),e=>(n(),c(b,{key:e.id,label:e.nickname,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})]),_:1}),a(t,{span:12},{default:s(()=>[a(r,{label:"\u4EA7\u54C1\u7C7B\u578B",prop:"categoryId"},{default:s(()=>[a(O,{modelValue:l(o).categoryId,"onUpdate:modelValue":d[2]||(d[2]=e=>l(o).categoryId=e),options:l(k),props:l(fe),class:"w-1/1",clearable:"",placeholder:"\u8BF7\u9009\u62E9\u4EA7\u54C1\u7C7B\u578B",filterable:""},null,8,["modelValue","options","props"])]),_:1})]),_:1}),a(t,{span:12},{default:s(()=>[a(r,{label:"\u4EA7\u54C1\u5355\u4F4D",prop:"unit"},{default:s(()=>[a(g,{modelValue:l(o).unit,"onUpdate:modelValue":d[3]||(d[3]=e=>l(o).unit=e),class:"w-1/1",placeholder:"\u8BF7\u9009\u62E9\u5355\u4F4D"},{default:s(()=>[(n(!0),V(w,null,U(l(T)(l(P).CRM_PRODUCT_UNIT),e=>(n(),c(b,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),a(t,{span:12},{default:s(()=>[a(r,{label:"\u4EA7\u54C1\u7F16\u7801",prop:"no"},{default:s(()=>[a(_,{modelValue:l(o).no,"onUpdate:modelValue":d[4]||(d[4]=e=>l(o).no=e),placeholder:"\u8BF7\u8F93\u5165\u4EA7\u54C1\u7F16\u7801"},null,8,["modelValue"])]),_:1})]),_:1}),a(t,{span:12},{default:s(()=>[a(r,{label:"\u4EF7\u683C",prop:"price"},{default:s(()=>[a(j,{modelValue:l(o).price,"onUpdate:modelValue":d[5]||(d[5]=e=>l(o).price=e),placeholder:"\u8BF7\u8F93\u5165\u4EF7\u683C",min:0,precision:2,step:.1,class:"w-full!"},null,8,["modelValue"])]),_:1})]),_:1}),a(t,{span:12},{default:s(()=>[a(r,{label:"\u4EA7\u54C1\u63CF\u8FF0",prop:"description"},{default:s(()=>[a(_,{modelValue:l(o).description,"onUpdate:modelValue":d[6]||(d[6]=e=>l(o).description=e),placeholder:"\u8BF7\u8F93\u5165\u4EA7\u54C1\u63CF\u8FF0"},null,8,["modelValue"])]),_:1})]),_:1}),a(t,{span:12},{default:s(()=>[a(r,{label:"\u4E0A\u67B6\u72B6\u6001",prop:"status"},{default:s(()=>[a(g,{modelValue:l(o).status,"onUpdate:modelValue":d[7]||(d[7]=e=>l(o).status=e),placeholder:"\u8BF7\u9009\u62E9\u72B6\u6001",class:"w-1/1"},{default:s(()=>[(n(!0),V(w,null,U(l(T)(l(P).CRM_PRODUCT_STATUS),e=>(n(),c(b,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])),[[Q,l(m)]])]),_:1},8,["title","modelValue"])}}});export{be as _};
