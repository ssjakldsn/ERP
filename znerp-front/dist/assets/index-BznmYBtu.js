import{bt as y,d as S,z as L,r as p,e as Q,O as W,o as k,c as X,f as l,w as s,a as t,k as I,y as Y,q as Z,x as c,a5 as $,F as ee,C as ae,J as le,H as te,I as se,E as oe,j as re,l as ue,m as pe,cG as ie}from"./index-CIfmhqRC.js";import{_ as ne}from"./index-2RHHZ-Zv.js";import{_ as de}from"./ReplyForm.vue_vue_type_script_setup_true_lang-DRGLVriw.js";import{R as D}from"./TabNews-7oV1NnBl.js";import"./main-CfsIYUE7.js";import"./useUpload-Dugldi2L.js";import"./TabImage-E636bkCf.js";import"./main-D-MTREjU.js";import"./TabVoice-Dqn1wB6g.js";import"./main.vue_vue_type_script_setup_true_lang-4T-wzdRZ.js";import"./TabVideo-C4oWHYiJ.js";import"./el-image-DLpquQe6.js";import"./main-q6_374v6.js";import"./main-BKPadW1d.js";import{_ as me}from"./main.vue_vue_type_script_setup_true_lang-Ds9hfoYc.js";import{_ as F}from"./ContentWrap.vue_vue_type_script_setup_true_lang-sm5dIhPQ.js";import{_ as ce}from"./ReplyTable.vue_vue_type_script_setup_true_lang-m-NNTFeD.js";import{M as v}from"./types-CAO1T7C7.js";import"./index.vue_vue_type_script_setup_true_lang-DYHi04Tm.js";import"./index-CrBeVHKs.js";import"./index-B3YA5cCI.js";import"./index-DO3zXEBC.js";import"./formatTime-DFFN_xWx.js";import"./TabText.vue_vue_type_script_setup_true_lang-56KExiTN.js";import"./TabMusic.vue_vue_type_script_setup_true_lang-YMp3hNn3.js";import"./index-Dsi5T0R-.js";import"./el-card-DyMugU68.js";import"./DictTag.vue_vue_type_script_lang-CTpVFm77.js";import"./color-BN7ZL7BD.js";import"./main-DGKBWtix.js";const ve=S({name:"MpAutoReply",__name:"index",setup(ye){const f=L(),q=p(-1),u=p(v.Keyword),U=p(!0),A=p(0),h=p([]),w=p(null),i=Q({pageNo:1,pageSize:10,accountId:q}),b=p(!1),n=p(!1),r=p({}),o=p({type:D.Text,accountId:-1}),K=e=>{q.value=e,o.value.accountId=e,i.pageNo=1,M()},M=async()=>{U.value=!0;try{const a=await(e={...i,type:u.value},y.get({url:"/mp/auto-reply/page",params:e}));h.value=a.list,A.value=a.total}finally{U.value=!1}var e},N=e=>{u.value=e,i.pageNo=1,M()},H=()=>{T(),o.value={type:D.Text,accountId:i.accountId},b.value=!0,n.value=!0},O=async e=>{T();const a=await(m=>y.get({url:"/mp/auto-reply/get?id="+m}))(e);r.value={...a},delete r.value.responseMessageType,delete r.value.responseContent,delete r.value.responseMediaId,delete r.value.responseMediaUrl,delete r.value.responseDescription,delete r.value.responseArticles,o.value={type:a.responseMessageType,accountId:i.accountId,content:a.responseContent,mediaId:a.responseMediaId,url:a.responseMediaUrl,title:a.responseTitle,description:a.responseDescription,thumbMediaId:a.responseThumbMediaId,thumbMediaUrl:a.responseThumbMediaUrl,articles:a.responseArticles,musicUrl:a.responseMusicUrl,hqMusicUrl:a.responseHqMusicUrl},b.value=!1,n.value=!0},R=async e=>{await f.confirm("\u662F\u5426\u786E\u8BA4\u5220\u9664\u6B64\u6570\u636E?"),await(a=>y.delete({url:"/mp/auto-reply/delete?id="+a}))(e),await M(),f.success("\u5220\u9664\u6210\u529F")},z=async()=>{var m;await((m=w.value)==null?void 0:m.validate());const e={...r.value};var a;e.responseMessageType=o.value.type,e.responseContent=o.value.content,e.responseMediaId=o.value.mediaId,e.responseMediaUrl=o.value.url,e.responseTitle=o.value.title,e.responseDescription=o.value.description,e.responseThumbMediaId=o.value.thumbMediaId,e.responseThumbMediaUrl=o.value.thumbMediaUrl,e.responseArticles=o.value.articles,e.responseMusicUrl=o.value.musicUrl,e.responseHqMusicUrl=o.value.hqMusicUrl,r.value.id!==void 0?(await(a=e,y.put({url:"/mp/auto-reply/update",data:a})),f.success("\u4FEE\u6539\u6210\u529F")):(await(x=>y.post({url:"/mp/auto-reply/create",data:x}))(e),f.success("\u65B0\u589E\u6210\u529F")),n.value=!1,await M()},T=()=>{var e;r.value={id:void 0,accountId:i.accountId,type:u.value,requestKeyword:void 0,requestMatch:u.value===v.Keyword?1:void 0,requestMessageType:void 0},(e=w.value)==null||e.resetFields()},P=()=>{n.value=!1,T()};return(e,a)=>{const m=ne,x=ae,j=le,g=te,V=se,B=oe,_=re,C=ue,E=pe,G=ie,J=W("hasPermi");return k(),X(ee,null,[l(m,{title:"\u81EA\u52A8\u56DE\u590D",url:"https://doc.iocoder.cn/mp/auto-reply/"}),l(t(F),null,{default:s(()=>[l(j,{class:"-mb-15px",model:t(i),inline:!0,"label-width":"68px"},{default:s(()=>[l(x,{label:"\u516C\u4F17\u53F7",prop:"accountId"},{default:s(()=>[l(t(me),{onChange:K})]),_:1})]),_:1},8,["model"])]),_:1}),l(t(F),null,{default:s(()=>[l(E,{modelValue:t(u),"onUpdate:modelValue":a[0]||(a[0]=d=>I(u)?u.value=d:null),onTabChange:N},{default:s(()=>[l(_,{gutter:10,class:"mb8"},{default:s(()=>[l(B,{span:1.5},{default:s(()=>[t(u)!==t(v).Follow||t(h).length<=0?Y((k(),Z(V,{key:0,type:"primary",plain:"",onClick:H},{default:s(()=>[l(g,{icon:"ep:plus"}),c("\u65B0\u589E ")]),_:1})),[[J,["mp:auto-reply:create"]]]):$("",!0)]),_:1})]),_:1}),l(C,{name:t(v).Follow},{label:s(()=>[l(_,{align:"middle"},{default:s(()=>[l(g,{icon:"ep:star",class:"mr-2px"}),c(" \u5173\u6CE8\u65F6\u56DE\u590D")]),_:1})]),_:1},8,["name"]),l(C,{name:t(v).Message},{label:s(()=>[l(_,{align:"middle"},{default:s(()=>[l(g,{icon:"ep:chat-line-round",class:"mr-2px"}),c(" \u6D88\u606F\u56DE\u590D")]),_:1})]),_:1},8,["name"]),l(C,{name:t(v).Keyword},{label:s(()=>[l(_,{align:"middle"},{default:s(()=>[l(g,{icon:"fa:newspaper-o",class:"mr-2px"}),c(" \u5173\u952E\u8BCD\u56DE\u590D")]),_:1})]),_:1},8,["name"])]),_:1},8,["modelValue"]),l(ce,{loading:t(U),list:t(h),"msg-type":t(u),onOnUpdate:O,onOnDelete:R},null,8,["loading","list","msg-type"]),l(G,{title:t(b)?"\u65B0\u589E\u81EA\u52A8\u56DE\u590D":"\u4FEE\u6539\u81EA\u52A8\u56DE\u590D",modelValue:t(n),"onUpdate:modelValue":a[3]||(a[3]=d=>I(n)?n.value=d:null),width:"800px","destroy-on-close":""},{footer:s(()=>[l(V,{onClick:P},{default:s(()=>[c("\u53D6 \u6D88")]),_:1}),l(V,{type:"primary",onClick:z},{default:s(()=>[c("\u786E \u5B9A")]),_:1})]),default:s(()=>[l(de,{modelValue:t(r),"onUpdate:modelValue":a[1]||(a[1]=d=>I(r)?r.value=d:null),reply:t(o),"onUpdate:reply":a[2]||(a[2]=d=>I(o)?o.value=d:null),"msg-type":t(u),ref_key:"formRef",ref:w},null,8,["modelValue","reply","msg-type"])]),_:1},8,["title","modelValue"])]),_:1})],64)}}});export{ve as default};
