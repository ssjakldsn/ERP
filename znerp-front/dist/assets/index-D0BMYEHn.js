import{d as oe,u as te,r as i,e as re,ar as de,n as ue,O as pe,o as d,c as s,f as a,w as o,a as l,F as m,p as y,Q as C,D as h,q as u,dS as ie,a5 as T,P as se,y as g,a4 as me,x as k,g as ne,A as ce,B as ve,C as ye,G as fe,U as be,H as _e,I as ke,J as Ve,L as he,M as Ue}from"./index-CIfmhqRC.js";import{_ as we}from"./index.vue_vue_type_script_setup_true_lang-DYHi04Tm.js";import{E as Ce,a as Te,b as ge}from"./el-dropdown-item-CvgBZuG7.js";import{_ as xe}from"./ContentWrap.vue_vue_type_script_setup_true_lang-sm5dIhPQ.js";import{_ as Ee}from"./index-2RHHZ-Zv.js";import{_ as Ie}from"./OrderDeliveryForm.vue_vue_type_script_setup_true_lang-D-MWCEIO.js";import{_ as Pe}from"./OrderUpdateRemarkForm.vue_vue_type_script_setup_true_lang-CQkrnmSJ.js";import{e as Se}from"./index-DDOznnSc.js";import{a as De}from"./index-D2ap44TW.js";import{g as Re}from"./index-CqFYyUKb.js";import{D as x,T as qe}from"./constants-A8BI3pz7.js";import Ne from"./OrderTableColumn-BcRGE2Wi.js";import"./index-CrBeVHKs.js";import"./el-card-DyMugU68.js";import"./Dialog.vue_vue_type_style_index_0_lang-CtaLqQeX.js";import"./el-image-DLpquQe6.js";import"./DictTag.vue_vue_type_script_lang-CTpVFm77.js";import"./color-BN7ZL7BD.js";import"./formatTime-DFFN_xWx.js";const Ae={class:"flex items-center justify-center"},Ye=oe({name:"TradeOrder",__name:"index",setup(Oe){const{currentRoute:X,push:j}=te(),E=i(!0),D=i(2),I=i([]),R=i(),t=i({pageNo:1,pageSize:10,status:void 0,payChannelCode:void 0,createTime:void 0,terminal:void 0,type:void 0,deliveryType:void 0,logisticsId:void 0,pickUpStoreId:void 0,pickUpVerifyCode:void 0}),V=re({queryParam:""}),q=i([{value:"no",label:"\u8BA2\u5355\u53F7"},{value:"userId",label:"\u7528\u6237UID"},{value:"userNickname",label:"\u7528\u6237\u6635\u79F0"},{value:"userMobile",label:"\u7528\u6237\u7535\u8BDD"}]),B=n=>{var r;(r=q.value.filter(f=>f.value!==n))==null||r.forEach(f=>{t.value.hasOwnProperty(f.value)&&delete t.value[f.value]})},b=async()=>{E.value=!0;try{const n=await Se(l(t));I.value=n.list,D.value=n.total}finally{E.value=!1}},P=async()=>{t.value.pageNo=1,await b()},J=()=>{var n;(n=R.value)==null||n.resetFields(),t.value={pageNo:1,pageSize:10,status:void 0,payChannelCode:void 0,createTime:void 0,terminal:void 0,type:void 0,deliveryType:void 0,logisticsId:void 0,pickUpStoreId:void 0,pickUpVerifyCode:void 0},P()},N=i(),A=i();de(()=>X.value,()=>{b()});const S=i([]),Y=i([]);return ue(async()=>{await b(),S.value=await De(),Y.value=await Re()}),(n,r)=>{const f=Ee,c=ce,v=ve,p=ye,Q=fe,O=be,_=_e,U=ke,W=Ve,M=xe,z=Ce,Z=Te,$=ge,ee=he,le=we,F=pe("hasPermi"),ae=Ue;return d(),s(m,null,[a(f,{title:"\u3010\u4EA4\u6613\u3011\u4EA4\u6613\u8BA2\u5355",url:"https://doc.iocoder.cn/mall/trade-order/"}),a(f,{title:"\u3010\u4EA4\u6613\u3011\u8D2D\u7269\u8F66",url:"https://doc.iocoder.cn/mall/trade-cart/"}),a(M,null,{default:o(()=>[a(W,{ref_key:"queryFormRef",ref:R,inline:!0,model:l(t),class:"-mb-15px","label-width":"68px"},{default:o(()=>[a(p,{label:"\u8BA2\u5355\u72B6\u6001",prop:"status"},{default:o(()=>[a(v,{modelValue:l(t).status,"onUpdate:modelValue":r[0]||(r[0]=e=>l(t).status=e),class:"!w-280px",clearable:"",placeholder:"\u5168\u90E8"},{default:o(()=>[(d(!0),s(m,null,y(l(C)(l(h).TRADE_ORDER_STATUS),e=>(d(),u(c,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(p,{label:"\u652F\u4ED8\u65B9\u5F0F",prop:"payChannelCode"},{default:o(()=>[a(v,{modelValue:l(t).payChannelCode,"onUpdate:modelValue":r[1]||(r[1]=e=>l(t).payChannelCode=e),class:"!w-280px",clearable:"",placeholder:"\u5168\u90E8"},{default:o(()=>[(d(!0),s(m,null,y(l(ie)(l(h).PAY_CHANNEL_CODE),e=>(d(),u(c,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(p,{label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime"},{default:o(()=>[a(Q,{modelValue:l(t).createTime,"onUpdate:modelValue":r[2]||(r[2]=e=>l(t).createTime=e),"default-time":[new Date("1 00:00:00"),new Date("1 23:59:59")],class:"!w-280px","end-placeholder":"\u81EA\u5B9A\u4E49\u65F6\u95F4","start-placeholder":"\u81EA\u5B9A\u4E49\u65F6\u95F4",type:"daterange","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue","default-time"])]),_:1}),a(p,{label:"\u8BA2\u5355\u6765\u6E90",prop:"terminal"},{default:o(()=>[a(v,{modelValue:l(t).terminal,"onUpdate:modelValue":r[3]||(r[3]=e=>l(t).terminal=e),class:"!w-280px",clearable:"",placeholder:"\u5168\u90E8"},{default:o(()=>[(d(!0),s(m,null,y(l(C)(l(h).TERMINAL),e=>(d(),u(c,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(p,{label:"\u8BA2\u5355\u7C7B\u578B",prop:"type"},{default:o(()=>[a(v,{modelValue:l(t).type,"onUpdate:modelValue":r[4]||(r[4]=e=>l(t).type=e),class:"!w-280px",clearable:"",placeholder:"\u5168\u90E8"},{default:o(()=>[(d(!0),s(m,null,y(l(C)(l(h).TRADE_ORDER_TYPE),e=>(d(),u(c,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(p,{label:"\u914D\u9001\u65B9\u5F0F",prop:"deliveryType"},{default:o(()=>[a(v,{modelValue:l(t).deliveryType,"onUpdate:modelValue":r[5]||(r[5]=e=>l(t).deliveryType=e),class:"!w-280px",clearable:"",placeholder:"\u5168\u90E8"},{default:o(()=>[(d(!0),s(m,null,y(l(C)(l(h).TRADE_DELIVERY_TYPE),e=>(d(),u(c,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(t).deliveryType===l(x).EXPRESS.type?(d(),u(p,{key:0,label:"\u5FEB\u9012\u516C\u53F8",prop:"logisticsId"},{default:o(()=>[a(v,{modelValue:l(t).logisticsId,"onUpdate:modelValue":r[6]||(r[6]=e=>l(t).logisticsId=e),class:"!w-280px",clearable:"",placeholder:"\u5168\u90E8"},{default:o(()=>[(d(!0),s(m,null,y(l(Y),e=>(d(),u(c,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):T("",!0),l(t).deliveryType===l(x).PICK_UP.type?(d(),u(p,{key:1,label:"\u81EA\u63D0\u95E8\u5E97",prop:"pickUpStoreId"},{default:o(()=>[a(v,{modelValue:l(t).pickUpStoreId,"onUpdate:modelValue":r[7]||(r[7]=e=>l(t).pickUpStoreId=e),class:"!w-280px",clearable:"",multiple:"",placeholder:"\u5168\u90E8"},{default:o(()=>[(d(!0),s(m,null,y(l(S),e=>(d(),u(c,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):T("",!0),l(t).deliveryType===l(x).PICK_UP.type?(d(),u(p,{key:2,label:"\u6838\u9500\u7801",prop:"pickUpVerifyCode"},{default:o(()=>[a(O,{modelValue:l(t).pickUpVerifyCode,"onUpdate:modelValue":r[8]||(r[8]=e=>l(t).pickUpVerifyCode=e),class:"!w-280px",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u81EA\u63D0\u6838\u9500\u7801",onKeyup:se(P,["enter"])},null,8,["modelValue"])]),_:1})):T("",!0),a(p,{label:"\u805A\u5408\u641C\u7D22"},{default:o(()=>[g(a(O,{modelValue:l(t)[l(V).queryParam],"onUpdate:modelValue":r[10]||(r[10]=e=>l(t)[l(V).queryParam]=e),type:l(V).queryParam==="userId"?"number":"text",class:"!w-280px",clearable:"",placeholder:"\u8BF7\u8F93\u5165"},{prepend:o(()=>[a(v,{modelValue:l(V).queryParam,"onUpdate:modelValue":r[9]||(r[9]=e=>l(V).queryParam=e),class:"!w-110px",clearable:"",placeholder:"\u5168\u90E8",onChange:B},{default:o(()=>[(d(!0),s(m,null,y(l(q),e=>(d(),u(c,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["modelValue","type"]),[[me,!0]])]),_:1}),a(p,null,{default:o(()=>[a(U,{onClick:P},{default:o(()=>[a(_,{class:"mr-5px",icon:"ep:search"}),k(" \u641C\u7D22 ")]),_:1}),a(U,{onClick:J},{default:o(()=>[a(_,{class:"mr-5px",icon:"ep:refresh"}),k(" \u91CD\u7F6E ")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a(M,null,{default:o(()=>[g((d(),u(ee,{data:l(I),"row-key":"id"},{default:o(()=>[a(l(Ne),{list:l(I),"pick-up-store-list":l(S)},{default:o(({row:e})=>[ne("div",Ae,[g((d(),u(U,{link:"",type:"primary",onClick:H=>{return w=e.id,void j({name:"TradeOrderDetail",params:{id:w}});var w}},{default:o(()=>[a(_,{icon:"ep:notification"}),k(" \u8BE6\u60C5 ")]),_:2},1032,["onClick"])),[[F,["trade:order:query"]]]),g((d(),u($,{onCommand:H=>((w,L)=>{var G,K;switch(w){case"remark":(G=A.value)==null||G.open(L);break;case"delivery":(K=N.value)==null||K.open(L)}})(H,e)},{dropdown:o(()=>[a(Z,null,{default:o(()=>[e.deliveryType===l(x).EXPRESS.type&&e.status===l(qe).UNDELIVERED.status?(d(),u(z,{key:0,command:"delivery"},{default:o(()=>[a(_,{icon:"ep:takeaway-box"}),k(" \u53D1\u8D27 ")]),_:1})):T("",!0),a(z,{command:"remark"},{default:o(()=>[a(_,{icon:"ep:chat-line-square"}),k(" \u5907\u6CE8 ")]),_:1})]),_:2},1024)]),default:o(()=>[a(U,{link:"",type:"primary"},{default:o(()=>[a(_,{icon:"ep:d-arrow-right"}),k(" \u66F4\u591A ")]),_:1})]),_:2},1032,["onCommand"])),[[F,["trade:order:update"]]])])]),_:1},8,["list","pick-up-store-list"])]),_:1},8,["data"])),[[ae,l(E)]]),a(le,{limit:l(t).pageSize,"onUpdate:limit":r[11]||(r[11]=e=>l(t).pageSize=e),page:l(t).pageNo,"onUpdate:page":r[12]||(r[12]=e=>l(t).pageNo=e),total:l(D),onPagination:b},null,8,["limit","page","total"])]),_:1}),a(Ie,{ref_key:"deliveryFormRef",ref:N,onSuccess:b},null,512),a(Pe,{ref_key:"updateRemarkForm",ref:A,onSuccess:b},null,512)],64)}}});export{Ye as default};
