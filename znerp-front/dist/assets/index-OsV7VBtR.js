import{d as Q,N as U,r as e,u as V,n as W,o as s,c as j,y as G,a as t,q as f,w as o,x as I,a5 as M,f as r,F as H,z as J,I as K,l as P,m as X,E as Z,M as $}from"./index-CIfmhqRC.js";import{g as Y,_ as tt}from"./index-Bm5JfAS4.js";import{u as rt}from"./tagsView-CqxiFcdS.js";import{b as it}from"./index-jPQDaA_X.js";import{_ as at}from"./ContractDetailsInfo.vue_vue_type_script_setup_true_lang-BnDQKjZ4.js";import{_ as ot}from"./ContractDetailsHeader.vue_vue_type_script_setup_true_lang-C6cLzilr.js";import{_ as et}from"./ContractProductList.vue_vue_type_script_setup_true_lang-BLIzhPYm.js";import{B as p}from"./index-8CYEcIk3.js";import{_ as mt}from"./ContractForm.vue_vue_type_script_setup_true_lang-BKXLCfjR.js";import{_ as lt}from"./TransferForm.vue_vue_type_script_setup_true_lang-BkZZyHcA.js";import{_ as st}from"./PermissionList.vue_vue_type_script_setup_true_lang-BJ8SS8cZ.js";import{_ as pt}from"./index.vue_vue_type_script_setup_true_lang-PdFImspl.js";import{_ as nt}from"./ReceivableList.vue_vue_type_script_setup_true_lang-DO-aDM01.js";import{_ as ut}from"./ReceivablePlanList.vue_vue_type_script_setup_true_lang-GZ5KzsDO.js";import"./el-timeline-item-r9TewDuU.js";import"./formatTime-DFFN_xWx.js";import"./ContentWrap.vue_vue_type_script_setup_true_lang-sm5dIhPQ.js";import"./el-card-DyMugU68.js";import"./el-collapse-item-BgajxfOI.js";import"./el-descriptions-item-BL6ba85F.js";import"./DictTag.vue_vue_type_script_lang-CTpVFm77.js";import"./color-BN7ZL7BD.js";import"./Dialog.vue_vue_type_style_index_0_lang-CtaLqQeX.js";import"./index-BZptzjxi.js";import"./index-QrlE36WK.js";import"./index-B_QTmj5f.js";import"./index-B5nlbV2q.js";import"./ContractProductForm.vue_vue_type_script_setup_true_lang-BBuHPlBt.js";import"./index-BVTl5RdT.js";import"./index-IYA49QTG.js";import"./PermissionForm.vue_vue_type_script_setup_true_lang-BA269V0x.js";import"./index.vue_vue_type_script_setup_true_lang-DYHi04Tm.js";import"./index-CrBeVHKs.js";import"./FollowUpRecordForm.vue_vue_type_script_setup_true_lang-CX5nVT22.js";import"./FollowUpRecordBusinessForm.vue_vue_type_script_setup_true_lang-DxrArb3L.js";import"./FollowUpRecordContactForm.vue_vue_type_script_setup_true_lang-DLVeCN1i.js";import"./BusinessListModal.vue_vue_type_script_setup_true_lang-DoLUy-ZT.js";import"./BusinessForm.vue_vue_type_script_setup_true_lang-BT6WnAjK.js";import"./index-CwB7FJGa.js";import"./BusinessProductForm.vue_vue_type_script_setup_true_lang-23yRPDfu.js";import"./ContactListModal.vue_vue_type_script_setup_true_lang-KXTfVMT0.js";import"./ContactForm.vue_vue_type_script_setup_true_lang-CLRF_VIq.js";import"./index-w2FCJT7Q.js";import"./tree-BMqZf9_I.js";import"./index-CvUtKmzr.js";import"./ReceivableForm.vue_vue_type_script_setup_true_lang-Cav8NmDw.js";import"./index-DdHHUXAi.js";import"./ReceivablePlanForm.vue_vue_type_script_setup_true_lang-DhJzn0na.js";const ct=Q({name:"CrmContractDetail",__name:"index",props:{id:{}},setup(N){const O=N,g=U(),A=J(),n=e(0),u=e(!0),i=e({}),c=e(),_=e(),b=async()=>{u.value=!0;try{i.value=await it(n.value),await x(n.value)}finally{u.value=!1}},y=e([]),x=async a=>{if(!a)return;const m=await Y({bizType:p.CRM_CONTRACT,bizId:a});y.value=m.list},v=e(),F=a=>{var m;(m=v.value)==null||m.createReceivable(a)},C=e(),L=()=>{var a;(a=C.value)==null||a.open(i.value.id)},{delView:S}=rt(),{currentRoute:h}=V(),d=()=>{S(t(h))};return W(async()=>{const a=O.id||g.params.id;if(!a)return A.warning("\u53C2\u6570\u9519\u8BEF\uFF0C\u5408\u540C\u4E0D\u80FD\u4E3A\u7A7A\uFF01"),void d();n.value=a,await b()}),(a,m)=>{const R=K,l=P,q=tt,B=X,D=Z,E=$;return s(),j(H,null,[G((s(),f(ot,{contract:t(i)},{default:o(()=>{var z,T;return[(z=t(c))!=null&&z.validateWrite?(s(),f(R,{key:0,onClick:m[0]||(m[0]=dt=>{return w="update",k=t(i).id,void _.value.open(w,k);var w,k})},{default:o(()=>[I(" \u7F16\u8F91 ")]),_:1})):M("",!0),(T=t(c))!=null&&T.validateOwnerUser?(s(),f(R,{key:1,type:"primary",onClick:L},{default:o(()=>[I(" \u8F6C\u79FB ")]),_:1})):M("",!0)]}),_:1},8,["contract"])),[[E,t(u)]]),r(D,null,{default:o(()=>[r(B,null,{default:o(()=>[r(l,{label:"\u8DDF\u8FDB\u8BB0\u5F55"},{default:o(()=>[r(pt,{"biz-id":t(i).id,"biz-type":t(p).CRM_CONTRACT},null,8,["biz-id","biz-type"])]),_:1}),r(l,{label:"\u57FA\u672C\u4FE1\u606F"},{default:o(()=>[r(at,{contract:t(i)},null,8,["contract"])]),_:1}),r(l,{label:"\u4EA7\u54C1"},{default:o(()=>[r(et,{contract:t(i)},null,8,["contract"])]),_:1}),r(l,{label:"\u56DE\u6B3E"},{default:o(()=>[r(ut,{"contract-id":t(i).id,"customer-id":t(i).customerId,onCreateReceivable:F},null,8,["contract-id","customer-id"]),r(nt,{ref_key:"receivableListRef",ref:v,"contract-id":t(i).id,"customer-id":t(i).customerId},null,8,["contract-id","customer-id"])]),_:1}),r(l,{label:"\u56E2\u961F\u6210\u5458"},{default:o(()=>[r(st,{ref_key:"permissionListRef",ref:c,"biz-id":t(i).id,"biz-type":t(p).CRM_CONTRACT,"show-action":!0,onQuitTeam:d},null,8,["biz-id","biz-type"])]),_:1}),r(l,{label:"\u64CD\u4F5C\u65E5\u5FD7"},{default:o(()=>[r(q,{"log-list":t(y)},null,8,["log-list"])]),_:1})]),_:1})]),_:1}),r(mt,{ref_key:"formRef",ref:_,onSuccess:b},null,512),r(lt,{ref_key:"transferFormRef",ref:C,"biz-type":t(p).CRM_CONTRACT,onSuccess:d},null,8,["biz-type"])],64)}}});export{ct as default};
