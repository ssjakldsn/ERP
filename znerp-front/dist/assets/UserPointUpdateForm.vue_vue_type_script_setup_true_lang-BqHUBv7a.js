import{d as J,h as M,z as R,r as m,e as j,a3 as D,o as y,q as _,w as u,f as l,a as o,x as r,y as S,k as b,U as A,C as B,cc as E,ak as G,al as H,J as K,I as L,M as N}from"./index-CIfmhqRC.js";import{_ as O}from"./Dialog.vue_vue_type_style_index_0_lang-CtaLqQeX.js";import{g as Q,b as W}from"./index-B-I20sFy.js";const X=J({name:"UpdatePointForm",__name:"UserPointUpdateForm",emits:["success"],setup(Y,{expose:P,emit:w}){const{t:U}=M(),v=R(),d=m(!1),s=m(!1),e=m({id:void 0,nickname:void 0,point:0,changePoint:0,changeType:1}),k=j({changePoint:[{required:!0,message:"\u53D8\u52A8\u79EF\u5206\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),p=m();P({open:async t=>{if(d.value=!0,C(),t){s.value=!0;try{e.value=await Q(t),e.value.changeType=1,e.value.changePoint=0}finally{s.value=!1}}}});const x=w,T=async()=>{if(p&&await p.value.validate())if(e.value.changePoint<1)v.error("\u53D8\u52A8\u79EF\u5206\u4E0D\u80FD\u5C0F\u4E8E 1");else if(c.value<0)v.error("\u53D8\u52A8\u540E\u7684\u79EF\u5206\u4E0D\u80FD\u5C0F\u4E8E 0");else{s.value=!0;try{await W({id:e.value.id,point:e.value.changePoint*e.value.changeType}),v.success(U("common.updateSuccess")),d.value=!1,x("success")}finally{s.value=!1}}},C=()=>{var t;e.value={id:void 0,nickname:void 0,point:0,changePoint:0,changeType:1},(t=p.value)==null||t.resetFields()},c=D(()=>e.value.point+e.value.changePoint*e.value.changeType);return(t,a)=>{const g=A,i=B,f=E,h=G,F=H,q=K,V=L,z=O,I=N;return y(),_(z,{modelValue:o(d),"onUpdate:modelValue":a[7]||(a[7]=n=>b(d)?d.value=n:null),title:"\u4FEE\u6539\u7528\u6237\u79EF\u5206",width:"600"},{footer:u(()=>[l(V,{disabled:o(s),type:"primary",onClick:T},{default:u(()=>[r("\u786E \u5B9A")]),_:1},8,["disabled"]),l(V,{onClick:a[6]||(a[6]=n=>d.value=!1)},{default:u(()=>[r("\u53D6 \u6D88")]),_:1})]),default:u(()=>[S((y(),_(q,{ref_key:"formRef",ref:p,model:o(e),rules:o(k),"label-width":"100px"},{default:u(()=>[l(i,{label:"\u7528\u6237\u7F16\u53F7",prop:"id"},{default:u(()=>[l(g,{modelValue:o(e).id,"onUpdate:modelValue":a[0]||(a[0]=n=>o(e).id=n),class:"!w-240px",disabled:""},null,8,["modelValue"])]),_:1}),l(i,{label:"\u7528\u6237\u6635\u79F0",prop:"nickname"},{default:u(()=>[l(g,{modelValue:o(e).nickname,"onUpdate:modelValue":a[1]||(a[1]=n=>o(e).nickname=n),class:"!w-240px",disabled:""},null,8,["modelValue"])]),_:1}),l(i,{label:"\u53D8\u52A8\u524D\u79EF\u5206",prop:"point"},{default:u(()=>[l(f,{modelValue:o(e).point,"onUpdate:modelValue":a[2]||(a[2]=n=>o(e).point=n),class:"!w-240px",disabled:""},null,8,["modelValue"])]),_:1}),l(i,{label:"\u53D8\u52A8\u7C7B\u578B",prop:"changeType"},{default:u(()=>[l(F,{modelValue:o(e).changeType,"onUpdate:modelValue":a[3]||(a[3]=n=>o(e).changeType=n)},{default:u(()=>[l(h,{value:1},{default:u(()=>[r("\u589E\u52A0")]),_:1}),l(h,{value:-1},{default:u(()=>[r("\u51CF\u5C11")]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(i,{label:"\u53D8\u52A8\u79EF\u5206",prop:"changePoint"},{default:u(()=>[l(f,{modelValue:o(e).changePoint,"onUpdate:modelValue":a[4]||(a[4]=n=>o(e).changePoint=n),min:0,precision:0,class:"!w-240px"},null,8,["modelValue"])]),_:1}),l(i,{label:"\u53D8\u52A8\u540E\u79EF\u5206"},{default:u(()=>[l(f,{modelValue:o(c),"onUpdate:modelValue":a[5]||(a[5]=n=>b(c)?c.value=n:null),class:"!w-240px",disabled:""},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])),[[I,o(s)]])]),_:1},8,["modelValue"])}}});export{X as _};
