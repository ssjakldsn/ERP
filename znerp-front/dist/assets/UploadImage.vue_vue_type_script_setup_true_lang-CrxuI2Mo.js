import{_ as k}from"./Dialog.vue_vue_type_style_index_0_lang-CtaLqQeX.js";import{d as h,r as u,z as C,e as j,o as q,q as J,w as r,f as i,a,x as c,k as z,U as L,C as N,cm as O,J as R,I as S}from"./index-CIfmhqRC.js";import{Z}from"./index-H3f_2XHj.js";const $=h({name:"CheckList",__name:"UploadImage",emits:["success"],setup(A,{expose:I,emit:U}){const m=u(!1),t=u(!1),f=u("\u4E0A\u4F20\u8BBE\u8BA1\u56FE"),l=u({id:void 0,fileUrl:[],orderId:void 0,productId:void 0,itemId:void 0}),_=C(),b=j({fileUrl:[{required:!0,message:"\u8BF7\u4E0A\u4F20\u8BBE\u8BA1\u56FE",trigger:"blur"}]}),p=u();I({open:async(o,e)=>{if(t.value=!0,f.value=o==="draw"?"\u8BBE\u8BA1\u56FE\u4E0A\u4F20":"\u5236\u7248\u56FE\u4E0A\u4F20",e){let d=o==="draw"?e.draftsmans[0]:e.printers[0];l.value={fileUrl:d.imgUrl?d.imgUrl.split(","):[],id:d.id,orderId:d.orderId,productId:d.productId,itemId:d.itemId}}}});const w=U,V=async()=>{if(p&&await p.value.validate()){m.value=!0;try{let o=JSON.stringify({id:l.value.id,orderId:l.value.orderId,productId:l.value.productId,itemId:l.value.itemId,imgUrl:l.value.fileUrl.join(",")});await Z.draftsmanUpdate(o),_.success(`${f.value}\u6210\u529F\uFF01`),t.value=!1,w("success")}finally{m.value=!1}}};return(o,e)=>{const d=L,n=N,g=O,y=R,v=S,x=k;return q(),J(x,{title:a(f),modelValue:a(t),"onUpdate:modelValue":e[3]||(e[3]=s=>z(t)?t.value=s:null),width:"540"},{footer:r(()=>[i(v,{type:"primary",onClick:V,disabled:a(m)},{default:r(()=>[c(" \u786E\u5B9A ")]),_:1},8,["disabled"]),i(v,{onClick:e[2]||(e[2]=s=>t.value=!1)},{default:r(()=>[c("\u53D6 \u6D88")]),_:1})]),default:r(()=>[i(y,{class:"-mb-15px",ref_key:"formRef",ref:p,model:a(l),rules:a(b),"label-width":"100px"},{default:r(()=>[i(n,{label:"\u8BA2\u5355\u53F7"},{default:r(()=>[i(d,{modelValue:a(l).orderId,"onUpdate:modelValue":e[0]||(e[0]=s=>a(l).orderId=s),placeholder:"\u8BF7\u8F93\u5165\u8BA2\u5355\u5355\u53F7",clearable:"",disabled:"",class:"!w-160px"},null,8,["modelValue"])]),_:1}),i(n,{label:"\u4E0A\u4F20\u56FE\u7247",prop:"fileUrl"},{default:r(()=>[i(g,{modelValue:a(l).fileUrl,"onUpdate:modelValue":e[1]||(e[1]=s=>a(l).fileUrl=s),limit:9},{tip:r(()=>[c("\u4E0D\u80FD\u8D85\u8FC79\u5F20")]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])}}});export{$ as _};
