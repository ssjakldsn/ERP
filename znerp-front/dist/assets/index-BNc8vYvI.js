import{d as X,z as Y,h as $,r as h,e as ee,n as ae,o,c as n,f as e,w as a,a as t,P as re,F as g,p as A,q as _,x as i,y as E,g as w,D as le,t as c,a5 as S,U as te,C as oe,A as se,B as ie,H as pe,I as de,J as ue,K as ne,L as ce,i as me,av as fe,M as we}from"./index-CIfmhqRC.js";import{_ as ye}from"./index.vue_vue_type_script_setup_true_lang-DYHi04Tm.js";import{E as he}from"./el-image-DLpquQe6.js";import{_ as ge}from"./DictTag.vue_vue_type_script_lang-CTpVFm77.js";import{_ as _e}from"./ContentWrap.vue_vue_type_script_setup_true_lang-sm5dIhPQ.js";import{_ as ke}from"./PurchaseOrderForm.vue_vue_type_script_setup_true_lang-eg3s4DM-.js";import{_ as ve}from"./UploadImage.vue_vue_type_script_setup_true_lang-CrxuI2Mo.js";import{_ as be}from"./CheckForm.vue_vue_type_script_setup_true_lang-Cf0grHjr.js";import{Z as N}from"./index-H3f_2XHj.js";import{n as xe}from"./PurchaseOrderItemForm.vue_vue_type_script_setup_true_lang-Wwp1t-rc.js";import"./index-CrBeVHKs.js";import"./color-BN7ZL7BD.js";import"./el-card-DyMugU68.js";import"./Dialog.vue_vue_type_style_index_0_lang-CtaLqQeX.js";import"./el-descriptions-item-BL6ba85F.js";import"./formatTime-DFFN_xWx.js";const Se={class:"flex bg-blue-50 py-1 px-3 dark:bg-blue-900"},Ne={class:"flex-1 text-blue-500 ml-4"},Ce={class:"pl-4"},Ie={class:"flex gap-5"},Ue={class:"flex-1"},qe={key:1,class:"bg-gray-100 text-gray-600 px-2 dark:bg-blue-100"},ze={class:"text-gray-400"},Pe={class:"flex flex-row-reverse"},Ve=X({__name:"index",setup(Re){const k=Y();$();const v=h(!0),q=h(0),z=h([]),p=ee({pageNo:1,pageSize:10,orderNumber:"",status:"21,32",shopName:void 0}),P=h(),V=h([]),G=h([{info:"\u5546\u54C1\u4FE1\u606F",price:"\u5355\u4EF7\uFF08USD\uFF09",num:"\u6570\u91CF",requiresShipping:"\u914D\u9001\u65B9\u5F0F"}]),m=async()=>{v.value=!0;try{const d=await N.getOrderPage(p);z.value=d.list,q.value=d.total}finally{v.value=!1}},C=()=>{p.pageNo=1,m()},Z=()=>{P.value.resetFields(),C()},R=h(),D=async d=>{try{await k.confirm("\u786E\u5B9A\u9886\u53D6\u751F\u4EA7\u4EFB\u52A1\u5417\uFF1F");let s={orderId:d.orderId,itemId:d.id,productId:d.productId,type:3};await N.updateDraftsPage(s),k.success("\u9886\u53D6\u6210\u529F\uFF01"),await m()}catch{}},K=async d=>{try{await k.confirm("\u8BE5\u8BA2\u5355\u662F\u5426\u5DF2\u5B8C\u6210\u751F\u4EA7\uFF1F");let s={id:d.id,productStatus:1};await N.orderItemUpdate(s),k.success("\u5BA1\u6838\u901A\u8FC7\uFF01"),await m()}catch{}};return ae(async()=>{await m(),await(async()=>{var s;const d=await N.shopPage({pageNo:1,pageSize:10});V.value=(s=d.list)==null?void 0:s.map(b=>({label:b.name,value:b.enName}))})()}),(d,s)=>{const b=te,I=oe,B=se,H=ie,O=pe,y=de,L=ue,T=_e,u=ne,U=ce,M=ge,F=me,j=he,Q=fe,W=ye,J=we;return o(),n(g,null,[e(T,null,{default:a(()=>[e(L,{ref_key:"queryFormRef",ref:P,inline:!0,model:t(p),class:"-mb-15px","label-width":"88px"},{default:a(()=>[e(I,{label:"\u8BA2\u5355\u53F7",prop:"orderNumber"},{default:a(()=>[e(b,{modelValue:t(p).orderNumber,"onUpdate:modelValue":s[0]||(s[0]=r=>t(p).orderNumber=r),placeholder:"\u8BF7\u8F93\u5165\u8BA2\u5355\u53F7",clearable:"",onKeyup:re(C,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),e(I,{label:"\u5E97\u94FA",prop:"shopName"},{default:a(()=>[e(H,{modelValue:t(p).shopName,"onUpdate:modelValue":s[1]||(s[1]=r=>t(p).shopName=r),placeholder:"\u8BF7\u9009\u62E9\u5E97\u94FA",clearable:"",class:"!w-240px"},{default:a(()=>[(o(!0),n(g,null,A(t(V),r=>(o(),_(B,{key:r.value,label:r.label,value:r.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(I,null,{default:a(()=>[e(y,{onClick:C},{default:a(()=>[e(O,{class:"mr-5px",icon:"ep:search"}),i(" \u641C\u7D22 ")]),_:1}),e(y,{onClick:Z},{default:a(()=>[e(O,{class:"mr-5px",icon:"ep:refresh"}),i(" \u91CD\u7F6E ")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(T,null,{default:a(()=>[E((o(),_(U,{data:t(z)},{default:a(()=>[e(u,null,{header:a(()=>[e(U,{data:t(G),"show-header":!1},{default:a(()=>[e(u,{prop:"info",width:"500"}),e(u,{prop:"price",width:"200"}),e(u,{prop:"num",width:"100"}),e(u,{prop:"requiresShipping",width:"200"}),e(u,{prop:"option",align:"right"})]),_:1},8,["data"])]),default:a(r=>[w("div",Se,[e(M,{type:t(le).ZN_ORDER_STATUS,value:r.row.status},null,8,["type","value"]),w("div",Ne,"#"+c(r.row.orderNumber),1),w("div",Ce,[e(y,{link:"",onClick:l=>{return f="detail",x=r.row,void R.value.open(f,x);var f,x}},{default:a(()=>[i(" \u67E5\u770B\u8BE6\u60C5 ")]),_:2},1032,["onClick"]),r.row.type==1&&r.row.orderItems[0].producers.length===0?(o(),n(g,{key:0},[e(F,{direction:"vertical"}),e(y,{link:"",onClick:l=>D(r.row.orderItems[0])},{default:a(()=>[i(" \u9886\u53D6\u4EFB\u52A1 ")]),_:2},1032,["onClick"])],64)):S("",!0),r.row.type==1&&r.row.orderItems[0].producers.length>0?(o(),n(g,{key:1},[e(F,{direction:"vertical"}),e(y,{link:"",onClick:l=>K(r.row.orderItems[0])},{default:a(()=>[i(" \u5BA1\u6838 ")]),_:2},1032,["onClick"])],64)):S("",!0)])]),E((o(),_(U,{data:r.row.orderItems,"show-header":!1},{default:a(()=>[e(u,{width:"500"},{default:a(l=>[w("div",Ie,[e(j,{style:{width:"64px",height:"64px"},src:l.row.src?l.row.src:t(xe),fit:"cover"},null,8,["src"]),w("div",Ue,[w("h4",null,c(l.row.title),1),JSON.parse(l.row.properties).length>0?(o(!0),n(g,{key:0},A(JSON.parse(l.row.properties),(f,x)=>(o(),n("p",{key:"prop_"+x},[f.value.includes("https://")?S("",!0):(o(),n(g,{key:0},[i(c(f.name)+": "+c(f.value),1)],64))]))),128)):(o(),n("span",qe,"Variants: "+c(l.row.variantTitle?l.row.variantTitle:"\u6682\u65E0"),1)),w("p",ze,"SKU\uFF1A"+c(l.row.zhProductSku?l.row.zhProductSku:"\u6682\u65E0"),1)])])]),_:1}),e(u,{width:"200"},{default:a(l=>[i(c(l.row.price),1)]),_:1}),e(u,{width:"100"},{default:a(l=>[i(c(l.row.quantity),1)]),_:1}),e(u,{prop:"requiresShipping"},{default:a(l=>[i(c(l.row.requiresShipping==1?"\u8FD0\u8F93":"\u65E0\u9700\u53D1\u8D27"),1)]),_:1}),r.row.type==2?(o(),_(u,{key:0},{default:a(l=>[w("div",Pe,[l.row.producers.length==0?(o(),_(y,{key:0,type:"primary",link:"",onClick:f=>D(l.row)},{default:a(()=>[i(" \u9886\u53D6\u4EFB\u52A1 ")]),_:2},1032,["onClick"])):(o(),n(g,{key:1},[l.row.productStatus===1?(o(),_(Q,{key:0,type:"success"},{default:a(()=>[i("\u5BA1\u6838\u5B8C\u6210")]),_:1})):(o(),_(y,{key:1,link:"",type:"primary",onClick:f=>K(l.row)},{default:a(()=>[i(" \u5BA1\u6838 ")]),_:2},1032,["onClick"]))],64))])]),_:1})):S("",!0)]),_:2},1032,["data"])),[[J,t(v)]])]),_:1})]),_:1},8,["data"])),[[J,t(v)]]),e(W,{limit:t(p).pageSize,"onUpdate:limit":s[2]||(s[2]=r=>t(p).pageSize=r),page:t(p).pageNo,"onUpdate:page":s[3]||(s[3]=r=>t(p).pageNo=r),total:t(q),onPagination:m},null,8,["limit","page","total"])]),_:1}),e(ke,{ref_key:"detailRef",ref:R,onSuccess:m},null,512),e(ve,{ref:"uploadImgRef",onSuccess:m},null,512),e(be,{ref:"checkRef",onSuccess:m},null,512)],64)}}});export{Ve as default};
