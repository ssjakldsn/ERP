import{d as I,r as f,e as S,n as D,o as h,c as q,f as a,w as o,a as r,y as L,q as j,x as m,t as d,ek as u,dV as w,F as B,K as E,L as U,M as k}from"./index-CIfmhqRC.js";import{E as F}from"./el-card-DyMugU68.js";import{E as K}from"./el-skeleton-item-Dm6LwaUQ.js";import{_ as M}from"./Echart.vue_vue_type_script_setup_true_lang-C-1NoClp.js";import{S as b}from"./customer-Y0u55tjD.js";const N=I({name:"CustomerSummary",__name:"CustomerSummary",props:{queryParams:{}},setup(v,{expose:C}){const p=v,n=f(!1),c=f([]),e=S({grid:{left:20,right:30,bottom:20,containLabel:!0},legend:{},series:[{name:"\u65B0\u589E\u5BA2\u6237\u6570",type:"bar",yAxisIndex:0,data:[]},{name:"\u6210\u4EA4\u5BA2\u6237\u6570",type:"bar",yAxisIndex:1,data:[]}],toolbox:{feature:{dataZoom:{xAxisIndex:!1},brush:{type:["lineX","clear"]},saveAsImage:{show:!0,name:"\u5BA2\u6237\u603B\u91CF\u5206\u6790"}}},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},yAxis:[{type:"value",name:"\u65B0\u589E\u5BA2\u6237\u6570",min:0,minInterval:1},{type:"value",name:"\u6210\u4EA4\u5BA2\u6237\u6570",min:0,minInterval:1,splitLine:{lineStyle:{type:"dotted",opacity:.7}}}],xAxis:{type:"category",name:"\u65E5\u671F",data:[]}}),y=async()=>{n.value=!0;try{await(async()=>{const l=await b.getCustomerSummaryByDate(p.queryParams),g=await b.getCustomerSummaryByUser(p.queryParams);e.xAxis&&e.xAxis.data&&(e.xAxis.data=l.map(s=>s.time)),e.series&&e.series[0]&&e.series[0].data&&(e.series[0].data=l.map(s=>s.customerCreateCount)),e.series&&e.series[1]&&e.series[1].data&&(e.series[1].data=l.map(s=>s.customerDealCount)),c.value=g})()}finally{n.value=!1}};return C({loadData:y}),D(()=>{y()}),(l,g)=>{const s=M,P=K,x=F,t=E,_=U,A=k;return h(),q(B,null,[a(x,{shadow:"never"},{default:o(()=>[a(P,{loading:r(n),animated:""},{default:o(()=>[a(s,{height:500,options:r(e)},null,8,["options"])]),_:1},8,["loading"])]),_:1}),a(x,{shadow:"never",class:"mt-16px"},{default:o(()=>[L((h(),j(_,{data:r(c)},{default:o(()=>[a(t,{label:"\u5E8F\u53F7",align:"center",type:"index",width:"80",fixed:"left"}),a(t,{label:"\u5458\u5DE5\u59D3\u540D",prop:"ownerUserName","min-width":"100",fixed:"left"}),a(t,{label:"\u65B0\u589E\u5BA2\u6237\u6570",align:"right",prop:"customerCreateCount","min-width":"200"}),a(t,{label:"\u6210\u4EA4\u5BA2\u6237\u6570",align:"right",prop:"customerDealCount","min-width":"200"}),a(t,{label:"\u5BA2\u6237\u6210\u4EA4\u7387(%)",align:"right","min-width":"200"},{default:o(i=>[m(d(r(u)(i.row.customerDealCount,i.row.customerCreateCount)),1)]),_:1}),a(t,{label:"\u5408\u540C\u603B\u91D1\u989D",align:"right",prop:"contractPrice","min-width":"200",formatter:r(w)},null,8,["formatter"]),a(t,{label:"\u56DE\u6B3E\u91D1\u989D",align:"right",prop:"receivablePrice","min-width":"200",formatter:r(w)},null,8,["formatter"]),a(t,{label:"\u672A\u56DE\u6B3E\u91D1\u989D",align:"right","min-width":"200"},{default:o(i=>[m(d(r(u)(i.row.receivablePrice,i.row.contractPrice)),1)]),_:1}),a(t,{label:"\u56DE\u6B3E\u5B8C\u6210\u7387(%)",align:"right","min-width":"200",fixed:"right"},{default:o(i=>[m(d(r(u)(i.row.receivablePrice,i.row.contractPrice)),1)]),_:1})]),_:1},8,["data"])),[[A,r(n)]])]),_:1})],64)}}});export{N as _};
