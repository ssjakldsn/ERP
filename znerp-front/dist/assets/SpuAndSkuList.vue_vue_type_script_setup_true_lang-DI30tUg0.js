import{d as D,z as A,r as c,ar as y,o as h,q as v,w as r,f as a,a as o,aT as E,x as g,t as z,aA as T,a5 as U,aH as q,K as B,I as H,L as K}from"./index-CIfmhqRC.js";import{E as R}from"./el-image-DLpquQe6.js";import{_ as $}from"./SkuList.vue_vue_type_script_setup_true_lang-DYztw255.js";const j=D({name:"PromotionSpuAndSkuList",__name:"SpuAndSkuList",props:{spuList:{},ruleConfig:{},spuPropertyListP:{},isDelete:{type:Boolean}},emits:["delete"],setup(_,{expose:x,emit:L}){const C=A(),f=_,l=c([]),w=c(),d=c([]),k=c();x({getSkuConfigs:e=>{w.value.validateSku();const p=[];return d.value.forEach(t=>{t.spuDetail.skus.forEach(m=>{p.push(m[e])})}),p}});const b=L;return y(()=>f.spuList,e=>{e&&(l.value=e)},{deep:!0,immediate:!0}),y(()=>f.spuPropertyListP,e=>{e&&(d.value=e,setTimeout(()=>{k.value=e.map(p=>p.spuId)},200))},{deep:!0,immediate:!0}),(e,p)=>{const t=B,m=R,I=H,S=K;return h(),v(S,{data:o(l),"expand-row-keys":o(k),"row-key":"id"},{default:r(()=>[a(t,{type:"expand",width:"30"},{default:r(({row:i})=>{var u,s;return[a(o($),{ref_key:"skuListRef",ref:w,"is-activity-component":!0,"prop-form-data":(u=o(d).find(n=>n.spuId===i.id))==null?void 0:u.spuDetail,"property-list":(s=o(d).find(n=>n.spuId===i.id))==null?void 0:s.propertyList,"rule-config":e.ruleConfig},{extension:r(()=>[E(e.$slots,"default")]),_:2},1032,["prop-form-data","property-list","rule-config"])]}),_:3}),a(t,{key:"id",align:"center",label:"\u5546\u54C1\u7F16\u53F7",prop:"id"}),a(t,{label:"\u5546\u54C1\u56FE","min-width":"80"},{default:r(({row:i})=>[a(m,{src:i.picUrl,class:"h-30px w-30px",onClick:u=>{return s=i.picUrl,void q({zIndex:99999999,urlList:[s]});var s}},null,8,["src","onClick"])]),_:1}),a(t,{"show-overflow-tooltip":!0,label:"\u5546\u54C1\u540D\u79F0","min-width":"300",prop:"name"}),a(t,{align:"center",label:"\u5546\u54C1\u552E\u4EF7","min-width":"90",prop:"price"},{default:r(({row:i})=>[g(z(o(T)(i.price)),1)]),_:1}),a(t,{align:"center",label:"\u9500\u91CF","min-width":"90",prop:"salesCount"}),a(t,{align:"center",label:"\u5E93\u5B58","min-width":"90",prop:"stock"}),o(l).length>1&&e.isDelete?(h(),v(t,{key:0,align:"center",label:"\u64CD\u4F5C","min-width":"90"},{default:r(i=>[a(I,{type:"primary",link:"",onClick:u=>(async s=>{await C.confirm("\u662F\u5426\u5220\u9664\u5546\u54C1\u7F16\u53F7\u4E3A"+s+"\u7684\u6570\u636E\uFF1F");const n=l.value.findIndex(P=>P.id==s);l.value.splice(n,1),b("delete",s)})(i.row.id)},{default:r(()=>[g(" \u5220\u9664 ")]),_:2},1032,["onClick"])]),_:1})):U("",!0)]),_:3},8,["data","expand-row-keys"])}}});export{j as _};
