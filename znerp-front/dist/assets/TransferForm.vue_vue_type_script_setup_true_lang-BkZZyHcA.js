import{d as W,r as i,e as G,n as H,o as d,q as f,w as l,f as u,x as n,a as e,y as K,c as T,p as E,F as y,k,t as X,a5 as M,Q as Y,D as Z,z as $,A as ee,B as ae,C as le,ak as re,al as se,ae as ue,ca as te,J as oe,I as de,M as ne}from"./index-CIfmhqRC.js";import{_ as ie}from"./Dialog.vue_vue_type_style_index_0_lang-CtaLqQeX.js";import{g as me}from"./index-QrlE36WK.js";import{t as fe}from"./index-B5nlbV2q.js";import{a as _e}from"./index-IYA49QTG.js";import{t as ve}from"./index-B_QTmj5f.js";import{t as Ce}from"./index-BZptzjxi.js";import{t as pe}from"./index-jPQDaA_X.js";import{P as ce,B as s}from"./index-8CYEcIk3.js";const we=W({name:"CrmTransferForm",__name:"TransferForm",props:{bizType:{}},emits:["success"],setup(N,{expose:I,emit:g}){const O=N,U=$(),m=i(!1),c=i(""),_=i(!1),b=i([]),v=i(!1),o=i({}),z=G({newOwnerUserId:[{required:!0,message:"\u65B0\u8D1F\u8D23\u4EBA\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],oldOwnerPermissionLevel:[{required:!0,message:"\u8001\u8D1F\u8D23\u4EBA\u52A0\u5165\u56E2\u961F\u540E\u7684\u6743\u9650\u7EA7\u522B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),C=i();I({open:async r=>{m.value=!0,c.value=h(),x(),o.value.id=r}});const L=r=>{r||(o.value.oldOwnerPermissionLevel=void 0)},B=g,A=async()=>{if(C&&await C.value.validate()){_.value=!0;try{const r=o.value;await P(e(r)),U.success(c.value+"\u6210\u529F"),m.value=!1,B("success")}finally{_.value=!1}}},P=async r=>{switch(O.bizType){case s.CRM_CLUE:return await _e(r);case s.CRM_CUSTOMER:return await Ce(r);case s.CRM_CONTACT:return await ve(r);case s.CRM_BUSINESS:return await fe(r);case s.CRM_CONTRACT:return await pe(r);default:throw U.error("\u3010\u8F6C\u79FB\u5931\u8D25\u3011\u6CA1\u6709\u8F6C\u79FB\u63A5\u53E3"),new Error("\u3010\u8F6C\u79FB\u5931\u8D25\u3011\u6CA1\u6709\u8F6C\u79FB\u63A5\u53E3")}},h=()=>{switch(O.bizType){case s.CRM_CLUE:return"\u7EBF\u7D22\u8F6C\u79FB";case s.CRM_CUSTOMER:return"\u5BA2\u6237\u8F6C\u79FB";case s.CRM_CONTACT:return"\u8054\u7CFB\u4EBA\u8F6C\u79FB";case s.CRM_BUSINESS:return"\u5546\u673A\u8F6C\u79FB";case s.CRM_CONTRACT:return"\u5408\u540C\u8F6C\u79FB";default:return"\u8F6C\u79FB"}},x=()=>{var r;(r=C.value)==null||r.resetFields(),o.value={}};return H(async()=>{b.value=await me()}),(r,t)=>{const F=ee,q=ae,p=le,w=re,V=se,R=ue,j=te,D=oe,S=de,J=ie,Q=ne;return d(),f(J,{modelValue:e(m),"onUpdate:modelValue":t[5]||(t[5]=a=>k(m)?m.value=a:null),title:e(c),width:"30%"},{footer:l(()=>[u(S,{disabled:e(_),type:"primary",onClick:A},{default:l(()=>[n("\u786E \u5B9A")]),_:1},8,["disabled"]),u(S,{onClick:t[4]||(t[4]=a=>m.value=!1)},{default:l(()=>[n("\u53D6 \u6D88")]),_:1})]),default:l(()=>[K((d(),f(D,{ref_key:"formRef",ref:C,model:e(o),rules:e(z),"label-width":"150px"},{default:l(()=>[u(p,{label:"\u9009\u62E9\u65B0\u8D1F\u8D23\u4EBA",prop:"newOwnerUserId"},{default:l(()=>[u(q,{modelValue:e(o).newOwnerUserId,"onUpdate:modelValue":t[0]||(t[0]=a=>e(o).newOwnerUserId=a)},{default:l(()=>[(d(!0),T(y,null,E(e(b),a=>(d(),f(F,{key:a.id,label:a.nickname,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),u(p,{label:"\u8001\u8D1F\u8D23\u4EBA"},{default:l(()=>[u(V,{modelValue:e(v),"onUpdate:modelValue":t[1]||(t[1]=a=>k(v)?v.value=a:null),onChange:L},{default:l(()=>[u(w,{value:!1,size:"large"},{default:l(()=>[n("\u79FB\u9664")]),_:1}),u(w,{value:!0,size:"large"},{default:l(()=>[n("\u52A0\u5165\u56E2\u961F")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(v)?(d(),f(p,{key:0,label:"\u8001\u8D1F\u8D23\u4EBA\u6743\u9650\u7EA7\u522B",prop:"oldOwnerPermissionLevel"},{default:l(()=>[u(V,{modelValue:e(o).oldOwnerPermissionLevel,"onUpdate:modelValue":t[2]||(t[2]=a=>e(o).oldOwnerPermissionLevel=a)},{default:l(()=>[(d(!0),T(y,null,E(e(Y)(e(Z).CRM_PERMISSION_LEVEL),a=>(d(),T(y,{key:a.value},[a.value!=e(ce).OWNER?(d(),f(w,{key:0,value:a.value},{default:l(()=>[n(X(a.label),1)]),_:2},1032,["value"])):M("",!0)],64))),128))]),_:1},8,["modelValue"])]),_:1})):M("",!0),r.bizType===e(s).CRM_CUSTOMER?(d(),f(p,{key:1,label:"\u540C\u65F6\u8F6C\u79FB"},{default:l(()=>[u(j,{modelValue:e(o).toBizTypes,"onUpdate:modelValue":t[3]||(t[3]=a=>e(o).toBizTypes=a)},{default:l(()=>[u(R,{value:e(s).CRM_CONTACT},{default:l(()=>[n("\u8054\u7CFB\u4EBA")]),_:1},8,["value"]),u(R,{value:e(s).CRM_BUSINESS},{default:l(()=>[n("\u5546\u673A")]),_:1},8,["value"]),u(R,{value:e(s).CRM_CONTRACT},{default:l(()=>[n("\u5408\u540C")]),_:1},8,["value"])]),_:1},8,["modelValue"])]),_:1})):M("",!0)]),_:1},8,["model","rules"])),[[Q,e(_)]])]),_:1},8,["modelValue","title"])}}});export{we as _};
