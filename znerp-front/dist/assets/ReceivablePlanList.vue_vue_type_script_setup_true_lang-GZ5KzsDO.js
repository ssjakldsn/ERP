import{d as D,r as u,e as F,ar as H,O as K,o as s,c as M,f as e,w as c,x as f,y as g,a as o,q as v,dV as A,F as B,z as O,h as V,H as E,I as G,j as J,K as Q,L as W,M as X}from"./index-CIfmhqRC.js";import{_ as Y}from"./ContentWrap.vue_vue_type_script_setup_true_lang-sm5dIhPQ.js";import{_ as Z}from"./index.vue_vue_type_script_setup_true_lang-DYHi04Tm.js";import{g as $,d as ee}from"./index-DdHHUXAi.js";import{_ as ae}from"./ReceivablePlanForm.vue_vue_type_script_setup_true_lang-DhJzn0na.js";import{b as C}from"./formatTime-DFFN_xWx.js";const te=D({name:"CrmReceivablePlanList",__name:"ReceivablePlanList",props:{customerId:{},contractId:{}},emits:["createReceivable"],setup(N,{emit:S}){const a=N,w=O(),{t:P}=V(),I=u(!0),_=u(0),y=u([]),t=F({pageNo:1,pageSize:10,customerId:void 0,contractId:void 0}),d=async()=>{I.value=!0;try{a.customerId&&!a.contractId?t.customerId=a.customerId:a.customerId&&a.contractId&&(t.customerId=a.customerId,t.contractId=a.contractId);const n=await $(t);y.value=n.list,_.value=n.total}finally{I.value=!1}},h=u(),k=(n,i)=>{h.value.open(n,i,a.customerId,a.contractId)},R=S;return H(()=>[a.customerId,a.contractId],n=>{n[0]&&(t.pageNo=1,t.customerId=void 0,t.contractId=void 0,d())},{immediate:!0,deep:!0}),(n,i)=>{const z=E,p=G,L=J,r=Q,U=W,j=Z,T=Y,b=K("hasPermi"),q=X;return s(),M(B,null,[e(L,{justify:"end"},{default:c(()=>[e(p,{onClick:i[0]||(i[0]=l=>k("create",void 0))},{default:c(()=>[e(z,{class:"mr-5px",icon:"icon-park:income"}),f(" \u521B\u5EFA\u56DE\u6B3E\u8BA1\u5212 ")]),_:1})]),_:1}),e(T,{class:"mt-10px"},{default:c(()=>[g((s(),v(U,{data:o(y),"show-overflow-tooltip":!0,stripe:!0},{default:c(()=>[e(r,{align:"center",label:"\u5BA2\u6237\u540D\u79F0",prop:"customerName",width:"150px"}),e(r,{align:"center",label:"\u5408\u540C\u7F16\u53F7",prop:"contractNo",width:"200px"}),e(r,{align:"center",label:"\u671F\u6570",prop:"period"}),e(r,{align:"center",label:"\u8BA1\u5212\u56DE\u6B3E(\u5143)",prop:"price",width:"120",formatter:o(A)},null,8,["formatter"]),e(r,{formatter:o(C),align:"center",label:"\u8BA1\u5212\u56DE\u6B3E\u65E5\u671F",prop:"returnTime",width:"180px"},null,8,["formatter"]),e(r,{align:"center",label:"\u63D0\u524D\u51E0\u5929\u63D0\u9192",prop:"remindDays",width:"150"}),e(r,{formatter:o(C),align:"center",label:"\u63D0\u9192\u65E5\u671F",prop:"remindTime",width:"180px"},null,8,["formatter"]),e(r,{label:"\u8D1F\u8D23\u4EBA",prop:"ownerUserName",width:"120"}),e(r,{align:"center",label:"\u5907\u6CE8",prop:"remark"}),e(r,{align:"center",fixed:"right",label:"\u64CD\u4F5C",width:"200px"},{default:c(l=>[g((s(),v(p,{link:"",type:"primary",onClick:x=>{return m=l.row,void R("createReceivable",m);var m},disabled:l.row.receivableId},{default:c(()=>[f(" \u521B\u5EFA\u56DE\u6B3E ")]),_:2},1032,["onClick","disabled"])),[[b,["crm:receivable:create"]]]),g((s(),v(p,{link:"",type:"primary",onClick:x=>k("update",l.row.id)},{default:c(()=>[f(" \u7F16\u8F91 ")]),_:2},1032,["onClick"])),[[b,["crm:receivable-plan:update"]]]),g((s(),v(p,{link:"",type:"danger",onClick:x=>(async m=>{try{await w.delConfirm(),await ee(m),w.success(P("common.delSuccess")),await d()}catch{}})(l.row.id)},{default:c(()=>[f(" \u5220\u9664 ")]),_:2},1032,["onClick"])),[[b,["crm:receivable-plan:delete"]]])]),_:1})]),_:1},8,["data"])),[[q,o(I)]]),e(j,{limit:o(t).pageSize,"onUpdate:limit":i[1]||(i[1]=l=>o(t).pageSize=l),page:o(t).pageNo,"onUpdate:page":i[2]||(i[2]=l=>o(t).pageNo=l),total:o(_),onPagination:d},null,8,["limit","page","total"])]),_:1}),e(ae,{ref_key:"formRef",ref:h,onSuccess:d},null,512)],64)}}});export{te as _};
