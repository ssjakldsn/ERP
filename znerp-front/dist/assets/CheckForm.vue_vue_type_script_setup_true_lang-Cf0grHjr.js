import{_ as j}from"./Dialog.vue_vue_type_style_index_0_lang-CtaLqQeX.js";import{d as D,r as i,z as J,e as L,o as b,q as g,c9 as Z,a as l,w as s,f as t,x as v,c as $,F as A,p as B,k as G,U as H,C as K,E as M,j as N,ak as O,al as P,J as Q,I as T}from"./index-CIfmhqRC.js";import{E as W}from"./el-image-DLpquQe6.js";import{Z as X}from"./index-H3f_2XHj.js";const Y=D({name:"CheckList",__name:"CheckForm",emits:["success"],setup(aa,{expose:V,emit:y}){const c=i(!1),u=i(!1),o=i("\u4E0A\u4F20\u8BBE\u8BA1\u56FE"),e=i({id:void 0,status:0,reasion:"",draftsmans_id:void 0}),n=i(0),p=i([]),k=J(),x=L({fileUrl:[{required:!0,message:"\u8BF7\u4E0A\u4F20\u8BBE\u8BA1\u56FE",trigger:"blur"}]}),_=i();V({open:async(r,a)=>{if(u.value=!0,o.value=r==="draw"?"\u5BA1\u6838\u8BBE\u8BA1\u56FE":r==="plate"?"\u5BA1\u6838\u5236\u7248\u56FE":"",a){const m="reasons"in a;r==="draw"?(e.value.status=a.draStatus?a.draStatus:0,n.value=a.draStatus?a.draStatus:0,e.value.id=a.imgUrl?a.itemId:a.draftsmans[0].itemId,e.value.draftsmans_id=a.imgUrl?a.id:a.draftsmans[0].id,e.value.reasion=m?a.reasons:a.draftsmans[0].reasons):r==="plate"&&(e.value.status=a.printStatus?a.printStatus:0,n.value=a.printStatus?a.printStatus:0,e.value.id=a.imgUrl?a.itemId:a.printers[0].itemId,e.value.draftsmans_id=a.imgUrl?a.id:a.printers[0].id,e.value.reasion=m?a.reasons:a.printers[0].reasons),a.imgUrl?p.value=a.imgUrl.split(","):p.value=r==="draw"?a.draftsmans[0].imgUrl.split(","):a.printers[0].imgUrl.split(",")}}});const S=y,h=async()=>{if(_&&await _.value.validate()){c.value=!0;try{let r={};const a={id:e.value.id,reasion:e.value.reasion,draftsmans_id:e.value.draftsmans_id};o.value=="\u5BA1\u6838\u8BBE\u8BA1\u56FE"?r={...a,draStatus:e.value.status}:o.value=="\u5BA1\u6838\u5236\u7248\u56FE"&&(r={...a,printStatus:e.value.status}),await X.orderItemUpdate(r),k.success(`${o.value}\u6210\u529F\uFF01`),u.value=!1,S("success")}finally{c.value=!1}}};return(r,a)=>{const m=H,f=K,I=W,C=M,q=N,w=O,z=P,E=Q,U=T,F=j;return b(),g(F,{title:l(o),modelValue:l(u),"onUpdate:modelValue":a[4]||(a[4]=d=>G(u)?u.value=d:null),width:"540"},Z({default:s(()=>[t(E,{class:"-mb-15px",ref_key:"formRef",ref:_,model:l(e),rules:l(x),"label-width":"100px"},{default:s(()=>[t(f,{label:"\u8BA2\u5355\u53F7"},{default:s(()=>[t(m,{modelValue:l(e).id,"onUpdate:modelValue":a[0]||(a[0]=d=>l(e).id=d),placeholder:"\u8BF7\u8F93\u5165\u8BA2\u5355\u5355\u53F7",clearable:"",disabled:"",class:"!w-160px"},null,8,["modelValue"])]),_:1}),t(f,{label:"\u56FE\u7247"},{default:s(()=>[t(q,{gutter:20,class:"w-full"},{default:s(()=>[(b(!0),$(A,null,B(l(p),(d,R)=>(b(),g(C,{lg:8,sm:12,xs:24,key:"img"+R},{default:s(()=>[t(I,{class:"h-80px w-100px",lazy:"",src:d,"preview-src-list":l(p),"preview-teleported":"",fit:"cover"},null,8,["src","preview-src-list"])]),_:2},1024))),128))]),_:1})]),_:1}),t(f,{label:"\u662F\u5426\u901A\u8FC7"},{default:s(()=>[t(z,{modelValue:l(e).status,"onUpdate:modelValue":a[1]||(a[1]=d=>l(e).status=d),disabled:l(n)===1},{default:s(()=>[t(w,{value:1},{default:s(()=>[v("\u901A\u8FC7")]),_:1}),t(w,{value:2},{default:s(()=>[v("\u4E0D\u901A\u8FC7")]),_:1})]),_:1},8,["modelValue","disabled"])]),_:1}),t(f,{label:"\u539F\u56E0",prop:"reasion"},{default:s(()=>[t(m,{type:"textarea",disabled:l(n)===1,modelValue:l(e).reasion,"onUpdate:modelValue":a[2]||(a[2]=d=>l(e).reasion=d),rows:5,placeholder:"\u8BF7\u8F93\u5165\u539F\u56E0"},null,8,["disabled","modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:2},[l(n)!==1?{name:"footer",fn:s(()=>[t(U,{type:"primary",onClick:h,disabled:l(c)},{default:s(()=>[v(" \u786E\u5B9A ")]),_:1},8,["disabled"]),t(U,{onClick:a[3]||(a[3]=d=>u.value=!1)},{default:s(()=>[v("\u53D6 \u6D88")]),_:1})]),key:"0"}:void 0]),1032,["title","modelValue"])}}});export{Y as _};
