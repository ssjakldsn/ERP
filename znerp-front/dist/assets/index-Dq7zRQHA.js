import{d as $,z as j,h as W,r as f,e as X,n as Z,O as ee,o as n,c as N,f as e,w as t,a as l,F as x,p as R,Q as Y,D as _,q as i,x as y,y as T,g as ae,t as le,U as te,C as oe,A as re,B as pe,G as ue,H as ne,I as se,J as ie,K as me,ce as de,L as ce,M as fe}from"./index-CIfmhqRC.js";import{_ as _e}from"./index.vue_vue_type_script_setup_true_lang-DYHi04Tm.js";import{_ as ye}from"./DictTag.vue_vue_type_script_lang-CTpVFm77.js";import{_ as we}from"./ContentWrap.vue_vue_type_script_setup_true_lang-sm5dIhPQ.js";import{_ as ve}from"./index-2RHHZ-Zv.js";import{g as be,b as Te,d as ge}from"./couponTemplate-CdzguE4M.js";import{C as g}from"./constants-A8BI3pz7.js";import{d as he}from"./formatTime-DFFN_xWx.js";import{_ as Ce}from"./CouponTemplateForm.vue_vue_type_script_setup_true_lang-UglpN2io.js";import{d as Oe,v as ke,r as Ve,t as Ne}from"./formatter-DiQ-12RX.js";import"./index-CrBeVHKs.js";import"./color-BN7ZL7BD.js";import"./el-card-DyMugU68.js";import"./Dialog.vue_vue_type_style_index_0_lang-CtaLqQeX.js";import"./SpuShowcase-DQavcwpZ.js";import"./el-image-DLpquQe6.js";import"./spu-BTu6kAbO.js";import"./SpuTableSelect.vue_vue_type_script_setup_true_lang-CZO4f0fm.js";import"./el-tree-select-CYFGeiEt.js";import"./tree-BMqZf9_I.js";import"./category-CKOb63Br.js";import"./ProductCategorySelect.vue_vue_type_script_setup_true_lang-Dn8UypNC.js";const xe=$({name:"PromotionCouponTemplate",__name:"index",setup(Ue){const w=j(),{t:L}=W(),h=f(!0),U=f(0),P=f([]),r=X({pageNo:1,pageSize:10,name:null,status:null,discountType:null,type:null,createTime:[]}),v=f(),m=async()=>{h.value=!0;try{const s=await be(r);P.value=s.list,U.value=s.total}finally{h.value=!1}},C=()=>{r.pageNo=1,m()},B=()=>{var s;(s=v==null?void 0:v.value)==null||s.resetFields(),C()},S=f(),E=(s,o)=>{S.value.open(s,o)};return Z(()=>{m()}),(s,o)=>{const z=ve,F=te,d=oe,D=re,M=pe,H=ue,O=ne,c=se,K=ie,A=we,p=me,k=ye,q=de,G=ce,J=_e,V=ee("hasPermi"),Q=fe;return n(),N(x,null,[e(z,{title:"\u3010\u8425\u9500\u3011\u4F18\u60E0\u52B5",url:"https://doc.iocoder.cn/mall/promotion-coupon/"}),e(A,null,{default:t(()=>[e(K,{ref_key:"queryFormRef",ref:v,inline:!0,model:l(r),class:"-mb-15px","label-width":"82px"},{default:t(()=>[e(d,{label:"\u4F18\u60E0\u5238\u540D\u79F0",prop:"name"},{default:t(()=>[e(F,{modelValue:l(r).name,"onUpdate:modelValue":o[0]||(o[0]=a=>l(r).name=a),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u4F18\u60E0\u52B5\u540D",onKeyup:C},null,8,["modelValue"])]),_:1}),e(d,{label:"\u4F18\u60E0\u7C7B\u578B",prop:"discountType"},{default:t(()=>[e(M,{modelValue:l(r).discountType,"onUpdate:modelValue":o[1]||(o[1]=a=>l(r).discountType=a),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u9009\u62E9\u4F18\u60E0\u5238\u7C7B\u578B"},{default:t(()=>[(n(!0),N(x,null,R(l(Y)(l(_).PROMOTION_DISCOUNT_TYPE),a=>(n(),i(D,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(d,{label:"\u4F18\u60E0\u5238\u72B6\u6001",prop:"status"},{default:t(()=>[e(M,{modelValue:l(r).status,"onUpdate:modelValue":o[2]||(o[2]=a=>l(r).status=a),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u9009\u62E9\u4F18\u60E0\u5238\u72B6\u6001"},{default:t(()=>[(n(!0),N(x,null,R(l(Y)(l(_).COMMON_STATUS),a=>(n(),i(D,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(d,{label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime"},{default:t(()=>[e(H,{modelValue:l(r).createTime,"onUpdate:modelValue":o[3]||(o[3]=a=>l(r).createTime=a),"default-time":[new Date("1 00:00:00"),new Date("1 23:59:59")],class:"!w-240px","end-placeholder":"\u7ED3\u675F\u65E5\u671F","start-placeholder":"\u5F00\u59CB\u65E5\u671F",type:"daterange","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue","default-time"])]),_:1}),e(d,null,{default:t(()=>[e(c,{onClick:C},{default:t(()=>[e(O,{class:"mr-5px",icon:"ep:search"}),y(" \u641C\u7D22 ")]),_:1}),e(c,{onClick:B},{default:t(()=>[e(O,{class:"mr-5px",icon:"ep:refresh"}),y(" \u91CD\u7F6E ")]),_:1}),T((n(),i(c,{plain:"",type:"primary",onClick:o[4]||(o[4]=a=>E("create"))},{default:t(()=>[e(O,{class:"mr-5px",icon:"ep:plus"}),y(" \u65B0\u589E ")]),_:1})),[[V,["promotion:coupon-template:create"]]])]),_:1})]),_:1},8,["model"])]),_:1}),e(A,null,{default:t(()=>[T((n(),i(G,{data:l(P)},{default:t(()=>[e(p,{label:"\u4F18\u60E0\u5238\u540D\u79F0","min-width":"140",prop:"name"}),e(p,{label:"\u7C7B\u578B","min-width":"130",prop:"productScope"},{default:t(a=>[e(k,{type:l(_).PROMOTION_PRODUCT_SCOPE,value:a.row.productScope},null,8,["type","value"])]),_:1}),e(p,{label:"\u4F18\u60E0","min-width":"110",prop:"discount"},{default:t(a=>[e(k,{type:l(_).PROMOTION_DISCOUNT_TYPE,value:a.row.discountType},null,8,["type","value"]),ae("div",null,le(l(Oe)(a.row)),1)]),_:1}),e(p,{label:"\u9886\u53D6\u65B9\u5F0F","min-width":"100",prop:"takeType"},{default:t(a=>[e(k,{type:l(_).PROMOTION_COUPON_TAKE_TYPE,value:a.row.takeType},null,8,["type","value"])]),_:1}),e(p,{formatter:l(ke),align:"center",label:"\u4F7F\u7528\u65F6\u95F4",prop:"validityType",width:"185"},null,8,["formatter"]),e(p,{align:"center",label:"\u53D1\u653E\u6570\u91CF",prop:"totalCount"}),e(p,{formatter:l(Ve),align:"center",label:"\u5269\u4F59\u6570\u91CF",prop:"totalCount"},null,8,["formatter"]),e(p,{formatter:l(Ne),align:"center",label:"\u9886\u53D6\u4E0A\u9650",prop:"takeLimitCount"},null,8,["formatter"]),e(p,{align:"center",label:"\u72B6\u6001",prop:"status"},{default:t(a=>[e(q,{modelValue:a.row.status,"onUpdate:modelValue":b=>a.row.status=b,"active-value":0,"inactive-value":1,onChange:b=>(async u=>{let I=u.status===g.ENABLE?"\u542F\u7528":"\u505C\u7528";try{await w.confirm('\u786E\u8BA4\u8981"'+I+'""'+u.name+'"\u4F18\u60E0\u52B5\u5417?'),await Te(u.id,u.status),w.success(I+"\u6210\u529F")}catch{u.status=u.status===g.ENABLE?g.DISABLE:g.ENABLE}})(a.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(p,{formatter:l(he),align:"center",label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime",width:"180"},null,8,["formatter"]),e(p,{align:"center","class-name":"small-padding fixed-width",fixed:"right",label:"\u64CD\u4F5C",width:"120"},{default:t(a=>[T((n(),i(c,{link:"",type:"primary",onClick:b=>E("update",a.row.id)},{default:t(()=>[y(" \u4FEE\u6539 ")]),_:2},1032,["onClick"])),[[V,["promotion:coupon-template:update"]]]),T((n(),i(c,{link:"",type:"danger",onClick:b=>(async u=>{try{await w.confirm('\u662F\u5426\u786E\u8BA4\u5220\u9664\u4F18\u60E0\u52B5\u7F16\u53F7\u4E3A"'+u+'"\u7684\u6570\u636E\u9879?'),await ge(u),w.success(L("common.delSuccess")),await m()}catch{}})(a.row.id)},{default:t(()=>[y(" \u5220\u9664 ")]),_:2},1032,["onClick"])),[[V,["promotion:coupon-template:delete"]]])]),_:1})]),_:1},8,["data"])),[[Q,l(h)]]),e(J,{limit:l(r).pageSize,"onUpdate:limit":o[5]||(o[5]=a=>l(r).pageSize=a),page:l(r).pageNo,"onUpdate:page":o[6]||(o[6]=a=>l(r).pageNo=a),total:l(U),onPagination:m},null,8,["limit","page","total"])]),_:1}),e(Ce,{ref_key:"formRef",ref:S,onSuccess:m},null,512)],64)}}});export{xe as default};
