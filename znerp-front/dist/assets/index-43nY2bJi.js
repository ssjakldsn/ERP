import{d as X,z as Z,h as $,r as i,e as ee,u as le,n as ae,O as te,o as d,c as re,f as e,w as t,a,P as T,x as s,y as w,q as b,k as oe,t as ne,D as N,F as pe,U as ie,C as se,A as ue,B as me,H as de,I as ce,J as fe,l as we,m as be,af as _e,K as he,L as ge,M as ye}from"./index-CIfmhqRC.js";import{_ as xe}from"./index.vue_vue_type_script_setup_true_lang-DYHi04Tm.js";import{_ as Ce}from"./DictTag.vue_vue_type_script_lang-CTpVFm77.js";import{_ as ve}from"./ContentWrap.vue_vue_type_script_setup_true_lang-sm5dIhPQ.js";import{_ as ke}from"./index-2RHHZ-Zv.js";import{d as y}from"./formatTime-DFFN_xWx.js";import{d as Ve}from"./download-D5Lb_h0f.js";import{b as Ue,e as Se,f as Te}from"./index-IYA49QTG.js";import{_ as Ne}from"./ClueForm.vue_vue_type_script_setup_true_lang-Cbem2EMC.js";import"./index-CrBeVHKs.js";import"./color-BN7ZL7BD.js";import"./el-card-DyMugU68.js";import"./Dialog.vue_vue_type_style_index_0_lang-CtaLqQeX.js";import"./index-w2FCJT7Q.js";import"./tree-BMqZf9_I.js";import"./index-QrlE36WK.js";const Re=X({name:"CrmClue",__name:"index",setup(Me){const x=Z(),{t:q}=$(),C=i(!0),R=i(0),M=i([]),n=ee({pageNo:1,pageSize:10,sceneType:"1",name:null,telephone:null,mobile:null,transformStatus:!1}),E=i(),v=i(!1),k=i("1"),c=async()=>{C.value=!0;try{const p=await Ue(n);M.value=p.list,R.value=p.total}finally{C.value=!1}},u=()=>{n.pageNo=1,c()},F=()=>{E.value.resetFields(),u()},P=p=>{n.sceneType=p.paneName,u()},{push:A}=le(),I=i(),K=(p,r)=>{I.value.open(p,r)},B=async()=>{try{await x.exportConfirm(),v.value=!0;const p=await Te(n);Ve.excel(p,"\u7EBF\u7D22.xls")}catch{}finally{v.value=!1}};return ae(()=>{c()}),(p,r)=>{const L=ke,V=ie,f=se,O=ue,H=me,_=de,m=ce,J=fe,z=ve,U=we,Y=be,j=_e,o=he,S=Ce,G=ge,Q=xe,h=te("hasPermi"),W=ye;return d(),re(pe,null,[e(L,{title:"\u3010\u7EBF\u7D22\u3011\u7EBF\u7D22\u7BA1\u7406",url:"https://doc.iocoder.cn/crm/clue/"}),e(L,{title:"\u3010\u901A\u7528\u3011\u6570\u636E\u6743\u9650",url:"https://doc.iocoder.cn/crm/permission/"}),e(z,null,{default:t(()=>[e(J,{class:"-mb-15px",model:a(n),ref_key:"queryFormRef",ref:E,inline:!0,"label-width":"68px"},{default:t(()=>[e(f,{label:"\u7EBF\u7D22\u540D\u79F0",prop:"name"},{default:t(()=>[e(V,{modelValue:a(n).name,"onUpdate:modelValue":r[0]||(r[0]=l=>a(n).name=l),placeholder:"\u8BF7\u8F93\u5165\u7EBF\u7D22\u540D\u79F0",clearable:"",onKeyup:T(u,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),e(f,{label:"\u8F6C\u5316\u72B6\u6001",prop:"transformStatus"},{default:t(()=>[e(H,{modelValue:a(n).transformStatus,"onUpdate:modelValue":r[1]||(r[1]=l=>a(n).transformStatus=l),class:"!w-240px"},{default:t(()=>[e(O,{value:!1,label:"\u672A\u8F6C\u5316"}),e(O,{value:!0,label:"\u5DF2\u8F6C\u5316"})]),_:1},8,["modelValue"])]),_:1}),e(f,{label:"\u624B\u673A\u53F7",prop:"mobile"},{default:t(()=>[e(V,{modelValue:a(n).mobile,"onUpdate:modelValue":r[2]||(r[2]=l=>a(n).mobile=l),placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7",clearable:"",onKeyup:T(u,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),e(f,{label:"\u7535\u8BDD",prop:"telephone"},{default:t(()=>[e(V,{modelValue:a(n).telephone,"onUpdate:modelValue":r[3]||(r[3]=l=>a(n).telephone=l),placeholder:"\u8BF7\u8F93\u5165\u7535\u8BDD",clearable:"",onKeyup:T(u,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),e(f,null,{default:t(()=>[e(m,{onClick:u},{default:t(()=>[e(_,{icon:"ep:search",class:"mr-5px"}),s(" \u641C\u7D22")]),_:1}),e(m,{onClick:F},{default:t(()=>[e(_,{icon:"ep:refresh",class:"mr-5px"}),s(" \u91CD\u7F6E")]),_:1}),w((d(),b(m,{type:"primary",onClick:r[4]||(r[4]=l=>K("create"))},{default:t(()=>[e(_,{icon:"ep:plus",class:"mr-5px"}),s(" \u65B0\u589E ")]),_:1})),[[h,["crm:clue:create"]]]),w((d(),b(m,{type:"success",plain:"",onClick:B,loading:a(v)},{default:t(()=>[e(_,{icon:"ep:download",class:"mr-5px"}),s(" \u5BFC\u51FA ")]),_:1},8,["loading"])),[[h,["crm:clue:export"]]])]),_:1})]),_:1},8,["model"])]),_:1}),e(z,null,{default:t(()=>[e(Y,{modelValue:a(k),"onUpdate:modelValue":r[5]||(r[5]=l=>oe(k)?k.value=l:null),onTabClick:P},{default:t(()=>[e(U,{label:"\u6211\u8D1F\u8D23\u7684",name:"1"}),e(U,{label:"\u6211\u53C2\u4E0E\u7684",name:"2"}),e(U,{label:"\u4E0B\u5C5E\u8D1F\u8D23\u7684",name:"3"})]),_:1},8,["modelValue"]),w((d(),b(G,{data:a(M),stripe:!0,"show-overflow-tooltip":!0},{default:t(()=>[e(o,{label:"\u7EBF\u7D22\u540D\u79F0",align:"center",prop:"name",fixed:"left",width:"160"},{default:t(l=>[e(j,{underline:!1,type:"primary",onClick:D=>{return g=l.row.id,void A({name:"CrmClueDetail",params:{id:g}});var g}},{default:t(()=>[s(ne(l.row.name),1)]),_:2},1032,["onClick"])]),_:1}),e(o,{label:"\u7EBF\u7D22\u6765\u6E90",align:"center",prop:"source",width:"100"},{default:t(l=>[e(S,{type:a(N).CRM_CUSTOMER_SOURCE,value:l.row.source},null,8,["type","value"])]),_:1}),e(o,{label:"\u624B\u673A",align:"center",prop:"mobile",width:"120"}),e(o,{label:"\u7535\u8BDD",align:"center",prop:"telephone",width:"130"}),e(o,{label:"\u90AE\u7BB1",align:"center",prop:"email",width:"180"}),e(o,{label:"\u5730\u5740",align:"center",prop:"detailAddress",width:"180"}),e(o,{align:"center",label:"\u5BA2\u6237\u884C\u4E1A",prop:"industryId",width:"100"},{default:t(l=>[e(S,{type:a(N).CRM_CUSTOMER_INDUSTRY,value:l.row.industryId},null,8,["type","value"])]),_:1}),e(o,{align:"center",label:"\u5BA2\u6237\u7EA7\u522B",prop:"level",width:"135"},{default:t(l=>[e(S,{type:a(N).CRM_CUSTOMER_LEVEL,value:l.row.level},null,8,["type","value"])]),_:1}),e(o,{formatter:a(y),align:"center",label:"\u4E0B\u6B21\u8054\u7CFB\u65F6\u95F4",prop:"contactNextTime",width:"180px"},null,8,["formatter"]),e(o,{align:"center",label:"\u5907\u6CE8",prop:"remark",width:"200"}),e(o,{label:"\u6700\u540E\u8DDF\u8FDB\u65F6\u95F4",align:"center",prop:"contactLastTime",formatter:a(y),width:"180px"},null,8,["formatter"]),e(o,{align:"center",label:"\u6700\u540E\u8DDF\u8FDB\u8BB0\u5F55",prop:"contactLastContent",width:"200"}),e(o,{align:"center",label:"\u8D1F\u8D23\u4EBA",prop:"ownerUserName",width:"100px"}),e(o,{align:"center",label:"\u6240\u5C5E\u90E8\u95E8",prop:"ownerUserDeptName",width:"100"}),e(o,{label:"\u66F4\u65B0\u65F6\u95F4",align:"center",prop:"updateTime",formatter:a(y),width:"180px"},null,8,["formatter"]),e(o,{label:"\u521B\u5EFA\u65F6\u95F4",align:"center",prop:"createTime",formatter:a(y),width:"180px"},null,8,["formatter"]),e(o,{align:"center",label:"\u521B\u5EFA\u4EBA",prop:"creatorName",width:"100px"}),e(o,{label:"\u64CD\u4F5C",align:"center","min-width":"110",fixed:"right"},{default:t(l=>[w((d(),b(m,{link:"",type:"primary",onClick:D=>K("update",l.row.id)},{default:t(()=>[s(" \u7F16\u8F91 ")]),_:2},1032,["onClick"])),[[h,["crm:clue:update"]]]),w((d(),b(m,{link:"",type:"danger",onClick:D=>(async g=>{try{await x.delConfirm(),await Se(g),x.success(q("common.delSuccess")),await c()}catch{}})(l.row.id)},{default:t(()=>[s(" \u5220\u9664 ")]),_:2},1032,["onClick"])),[[h,["crm:clue:delete"]]])]),_:1})]),_:1},8,["data"])),[[W,a(C)]]),e(Q,{total:a(R),page:a(n).pageNo,"onUpdate:page":r[6]||(r[6]=l=>a(n).pageNo=l),limit:a(n).pageSize,"onUpdate:limit":r[7]||(r[7]=l=>a(n).pageSize=l),onPagination:c},null,8,["total","page","limit"])]),_:1}),e(Ne,{ref_key:"formRef",ref:I,onSuccess:c},null,512)],64)}}});export{Re as default};
