import{d as S,eH as b,r as f,n as P,aw as U,o as r,c,f as u,w as x,x as s,F as y,p as D,g as i,t as g,a as n,D as _,ay as m,I as E,U as N,_ as j}from"./index-CIfmhqRC.js";import{_ as M}from"./DictTag.vue_vue_type_script_lang-CTpVFm77.js";import"./Dialog.vue_vue_type_style_index_0_lang-CtaLqQeX.js";import"./index.vue_vue_type_script_setup_true_lang-DYHi04Tm.js";import{e as A}from"./couponTemplate-CdzguE4M.js";import{d as F}from"./formatter-DiQ-12RX.js";import{g as G}from"./constants-A8BI3pz7.js";import{_ as H}from"./CouponSelect.vue_vue_type_script_setup_true_lang-CHN-Tide.js";import"./color-BN7ZL7BD.js";import"./index-CrBeVHKs.js";import"./formatTime-DFFN_xWx.js";import"./ContentWrap.vue_vue_type_script_setup_true_lang-sm5dIhPQ.js";import"./el-card-DyMugU68.js";const L={class:"coupon-list-item-left flex items-center flex-wrap"},Y={class:"mr-10px"},q={class:"mr-10px"},z={class:"flex items-center"},B={class:"coupon-list-item-right"},J=j(S({name:"RewardRuleCouponSelect",__name:"RewardRuleCouponSelect",props:{modelValue:{}},emits:["update:modelValue"],setup(T,{expose:w,emit:O}){const t=b(T,"modelValue",O),o=f([]),v=f(),k=()=>{var e;(e=v.value)==null||e.open()},R=e=>{for(const p of e)o.value.some(a=>a.id===p.id)||o.value.push(p)};return w({setGiveCouponList:()=>{m(t.value)||m(o.value)||o.value.forEach(e=>{t.value.giveCouponTemplateCounts||(t.value.giveCouponTemplateCounts={}),t.value.giveCouponTemplateCounts[e.id]=e.giveCount})}}),P(async()=>{await U(),await(async()=>{if(m(t.value)||m(t.value.giveCouponTemplateCounts))return;const e=Object.keys(t.value.giveCouponTemplateCounts).map(a=>parseInt(a)),p=await A(e);p&&p.forEach(a=>{o.value.push({...a,giveCount:t.value.giveCouponTemplateCounts[a.id]})})})()}),(e,p)=>{const a=E,d=M,h=N;return r(),c(y,null,[u(a,{class:"ml-10px",type:"text",onClick:k},{default:x(()=>[s("\u6DFB\u52A0\u4F18\u60E0\u5377")]),_:1}),(r(!0),c(y,null,D(n(o),(l,I)=>(r(),c("div",{key:l.id,class:"coupon-list-item p-x-10px mb-10px flex justify-between"},[i("div",L,[i("div",Y," \u4F18\u60E0\u5238\u540D\u79F0\uFF1A"+g(l.name),1),i("div",q,[s(" \u8303\u56F4\uFF1A "),u(d,{type:n(_).PROMOTION_PRODUCT_SCOPE,value:l.productScope},null,8,["type","value"])]),i("div",z,[s(" \u4F18\u60E0\uFF1A "),u(d,{type:n(_).PROMOTION_DISCOUNT_TYPE,value:l.discountType},null,8,["type","value"]),s(" "+g(n(F)(l)),1)])]),i("div",B,[s(" \u9001 "),u(h,{modelValue:l.giveCount,"onUpdate:modelValue":C=>l.giveCount=C,class:"w-150px! p-x-20px!",placeholder:"",type:"number"},null,8,["modelValue","onUpdate:modelValue"]),s(" \u5F20 "),u(a,{class:"ml-20px",link:"",type:"danger",onClick:C=>(V=>{o.value.splice(V,1)})(I)},{default:x(()=>[s("\u5220\u9664")]),_:2},1032,["onClick"])])]))),128)),u(n(H),{ref_key:"couponSelectRef",ref:v,"take-type":n(G).ADMIN.type,onChange:R},null,8,["take-type"])],64)}}}),[["__scopeId","data-v-3ab8d927"]]);export{J as default};
