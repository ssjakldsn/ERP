import{d as B,z as D,r as u,e as E,n as G,O as Q,o as s,c as h,f as e,w as a,a as t,P as M,x as i,y as I,q as m,F as P,p as W,t as X,C as Y,U as Z,H as $,I as ee,J as ae,K as le,av as te,L as ne,M as oe}from"./index-CIfmhqRC.js";import{_ as re}from"./index.vue_vue_type_script_setup_true_lang-DYHi04Tm.js";import{_ as se}from"./ContentWrap.vue_vue_type_script_setup_true_lang-sm5dIhPQ.js";import{_ as ie}from"./index-2RHHZ-Zv.js";import{d as pe}from"./formatTime-DFFN_xWx.js";import{a as ue,s as ce}from"./index-CPdF_MJz.js";import{b as de}from"./index-C0ch1YxQ.js";import{_ as me}from"./main.vue_vue_type_script_setup_true_lang-Ds9hfoYc.js";import{_ as fe}from"./UserForm.vue_vue_type_script_setup_true_lang-D8SLSBWO.js";import"./index-CrBeVHKs.js";import"./el-card-DyMugU68.js";import"./index-Dsi5T0R-.js";import"./Dialog.vue_vue_type_style_index_0_lang-CtaLqQeX.js";const _e=B({name:"MpUser",__name:"index",setup(ge){const v=D(),y=u(!0),x=u(0),C=u([]),l=E({pageNo:1,pageSize:10,accountId:-1,openid:"",nickname:""}),S=u(null),U=u([]),q=p=>{l.accountId=p,l.pageNo=1,c()},c=async()=>{try{y.value=!0;const p=await ue(l);C.value=p.list,x.value=p.total}finally{y.value=!1}},f=()=>{l.pageNo=1,c()},R=()=>{var o;const p=l.accountId;(o=S.value)==null||o.resetFields(),l.accountId=p,f()},V=u(null),H=async()=>{try{await v.confirm("\u662F\u5426\u786E\u8BA4\u540C\u6B65\u7C89\u4E1D\uFF1F"),await ce(l.accountId),v.success("\u5F00\u59CB\u4ECE\u5FAE\u4FE1\u516C\u4F17\u53F7\u540C\u6B65\u7C89\u4E1D\u4FE1\u606F\uFF0C\u540C\u6B65\u9700\u8981\u4E00\u6BB5\u65F6\u95F4\uFF0C\u5EFA\u8BAE\u7A0D\u540E\u518D\u67E5\u8BE2"),await c()}catch{}};return G(async()=>{U.value=await de()}),(p,o)=>{const J=ie,_=Y,z=Z,k=$,g=ee,L=ae,N=se,r=le,w=te,O=ne,T=re,F=Q("hasPermi"),j=oe;return s(),h(P,null,[e(J,{title:"\u516C\u4F17\u53F7\u7C89\u4E1D",url:"https://doc.iocoder.cn/mp/user/"}),e(N,null,{default:a(()=>[e(L,{class:"-mb-15px",model:t(l),ref_key:"queryFormRef",ref:S,inline:!0,"label-width":"68px"},{default:a(()=>[e(_,{label:"\u516C\u4F17\u53F7",prop:"accountId"},{default:a(()=>[e(t(me),{onChange:q})]),_:1}),e(_,{label:"\u7528\u6237\u6807\u8BC6",prop:"openid"},{default:a(()=>[e(z,{modelValue:t(l).openid,"onUpdate:modelValue":o[0]||(o[0]=n=>t(l).openid=n),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u6807\u8BC6",clearable:"",onKeyup:M(f,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),e(_,{label:"\u6635\u79F0",prop:"nickname"},{default:a(()=>[e(z,{modelValue:t(l).nickname,"onUpdate:modelValue":o[1]||(o[1]=n=>t(l).nickname=n),placeholder:"\u8BF7\u8F93\u5165\u6635\u79F0",clearable:"",onKeyup:M(f,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),e(_,null,{default:a(()=>[e(g,{onClick:f},{default:a(()=>[e(k,{icon:"ep:search"}),i("\u641C\u7D22 ")]),_:1}),e(g,{onClick:R},{default:a(()=>[e(k,{icon:"ep:refresh"}),i("\u91CD\u7F6E ")]),_:1}),I((s(),m(g,{type:"success",plain:"",onClick:H,disabled:t(l).accountId===0},{default:a(()=>[e(k,{icon:"ep:refresh",class:"mr-5px"}),i(" \u540C\u6B65 ")]),_:1},8,["disabled"])),[[F,["mp:user:sync"]]])]),_:1})]),_:1},8,["model"])]),_:1}),e(N,null,{default:a(()=>[I((s(),m(O,{data:t(C)},{default:a(()=>[e(r,{label:"\u7F16\u53F7",align:"center",prop:"id"}),e(r,{label:"\u7528\u6237\u6807\u8BC6",align:"center",prop:"openid",width:"260"}),e(r,{label:"\u6635\u79F0",align:"center",prop:"nickname"}),e(r,{label:"\u5907\u6CE8",align:"center",prop:"remark"}),e(r,{label:"\u6807\u7B7E",align:"center",prop:"tagIds",width:"200"},{default:a(n=>[(s(!0),h(P,null,W(n.row.tagIds,(K,b)=>(s(),h("span",{key:b},[e(w,null,{default:a(()=>{var d;return[i(X((d=t(U).find(A=>A.tagId===K))==null?void 0:d.name),1)]}),_:2},1024),i("\xA0 ")]))),128))]),_:1}),e(r,{label:"\u8BA2\u9605\u72B6\u6001",align:"center",prop:"subscribeStatus"},{default:a(n=>[n.row.subscribeStatus===0?(s(),m(w,{key:0,type:"success"},{default:a(()=>[i("\u5DF2\u8BA2\u9605")]),_:1})):(s(),m(w,{key:1,type:"danger"},{default:a(()=>[i("\u672A\u8BA2\u9605")]),_:1}))]),_:1}),e(r,{label:"\u8BA2\u9605\u65F6\u95F4",align:"center",prop:"subscribeTime",width:"180",formatter:t(pe)},null,8,["formatter"]),e(r,{label:"\u64CD\u4F5C",align:"center"},{default:a(n=>[I((s(),m(g,{type:"primary",link:"",onClick:K=>{var d;return b=n.row.id,void((d=V.value)==null?void 0:d.open(b));var b}},{default:a(()=>[i(" \u4FEE\u6539 ")]),_:2},1032,["onClick"])),[[F,["mp:user:update"]]])]),_:1})]),_:1},8,["data"])),[[j,t(y)]]),e(T,{total:t(x),page:t(l).pageNo,"onUpdate:page":o[2]||(o[2]=n=>t(l).pageNo=n),limit:t(l).pageSize,"onUpdate:limit":o[3]||(o[3]=n=>t(l).pageSize=n),onPagination:c},null,8,["total","page","limit"])]),_:1}),e(fe,{ref_key:"formRef",ref:V,onSuccess:c},null,512)],64)}}});export{_e as default};
