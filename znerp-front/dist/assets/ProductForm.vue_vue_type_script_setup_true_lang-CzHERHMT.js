import{d as J,h as Q,z as R,r as i,e as Z,o as c,q as v,w as d,f as e,a,x as g,y as H,c as I,F as C,p as x,Q as K,D as W,t as X,k as Y,U as $,C as ee,E as ae,A as le,B as de,ak as oe,al as ue,cc as re,j as te,J as se,I as ie,M as pe}from"./index-CIfmhqRC.js";import{_ as me}from"./Dialog.vue_vue_type_style_index_0_lang-CtaLqQeX.js";import{E as ne}from"./el-tree-select-CYFGeiEt.js";import{P as y}from"./index-C-VA7MOy.js";import{P as ce}from"./index-C8586r3L.js";import{P as fe}from"./index-DKjClyJm.js";import{C as ve}from"./constants-A8BI3pz7.js";import{d as Ve,h as _e}from"./tree-BMqZf9_I.js";const ge=J({name:"ProductForm",__name:"ProductForm",emits:["success"],setup(ye,{expose:q,emit:D}){const{t:V}=Q(),b=R(),p=i(!1),h=i(""),m=i(!1),P=i(""),u=i({id:void 0,name:void 0,barCode:void 0,categoryId:void 0,unitId:void 0,status:void 0,standard:void 0,remark:void 0,expiryDay:void 0,weight:void 0,purchasePrice:void 0,salePrice:void 0,minPrice:void 0}),S=Z({name:[{required:!0,message:"\u4EA7\u54C1\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],barCode:[{required:!0,message:"\u4EA7\u54C1\u6761\u7801\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],categoryId:[{required:!0,message:"\u4EA7\u54C1\u5206\u7C7B\u7F16\u53F7\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],unitId:[{required:!0,message:"\u5355\u4F4D\u7F16\u53F7\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],status:[{required:!0,message:"\u4EA7\u54C1\u72B6\u6001\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),_=i(),w=i([]),U=i([]);q({open:async(s,o)=>{if(p.value=!0,h.value=V("action."+s),P.value=s,A(),o){m.value=!0;try{u.value=await y.getProduct(o)}finally{m.value=!1}}const n=await ce.getProductCategorySimpleList();w.value=_e(n,"id","parentId"),U.value=await fe.getProductUnitSimpleList()}});const E=D,F=async()=>{await _.value.validate(),m.value=!0;try{const s=u.value;P.value==="create"?(await y.createProduct(s),b.success(V("common.createSuccess"))):(await y.updateProduct(s),b.success(V("common.updateSuccess"))),p.value=!1,E("success")}finally{m.value=!1}},A=()=>{var s;u.value={id:void 0,name:void 0,barCode:void 0,categoryId:void 0,unitId:void 0,status:ve.ENABLE,standard:void 0,remark:void 0,expiryDay:void 0,weight:void 0,purchasePrice:void 0,salePrice:void 0,minPrice:void 0},(s=_.value)==null||s.resetFields()};return(s,o)=>{const n=$,r=ee,t=ae,M=ne,B=le,L=de,O=oe,T=ue,f=re,z=te,N=se,k=ie,j=me,G=pe;return c(),v(j,{title:a(h),modelValue:a(p),"onUpdate:modelValue":o[13]||(o[13]=l=>Y(p)?p.value=l:null)},{footer:d(()=>[e(k,{onClick:F,type:"primary",disabled:a(m)},{default:d(()=>[g("\u786E \u5B9A")]),_:1},8,["disabled"]),e(k,{onClick:o[12]||(o[12]=l=>p.value=!1)},{default:d(()=>[g("\u53D6 \u6D88")]),_:1})]),default:d(()=>[H((c(),v(N,{ref_key:"formRef",ref:_,model:a(u),rules:a(S),"label-width":"100px"},{default:d(()=>[e(z,{gutter:20},{default:d(()=>[e(t,{span:12},{default:d(()=>[e(r,{label:"\u540D\u79F0",prop:"name"},{default:d(()=>[e(n,{modelValue:a(u).name,"onUpdate:modelValue":o[0]||(o[0]=l=>a(u).name=l),placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0"},null,8,["modelValue"])]),_:1})]),_:1}),e(t,{span:12},{default:d(()=>[e(r,{label:"\u6761\u7801",prop:"barCode"},{default:d(()=>[e(n,{modelValue:a(u).barCode,"onUpdate:modelValue":o[1]||(o[1]=l=>a(u).barCode=l),placeholder:"\u8BF7\u8F93\u5165\u6761\u7801"},null,8,["modelValue"])]),_:1})]),_:1}),e(t,{span:12},{default:d(()=>[e(r,{label:"\u5206\u7C7B",prop:"categoryId"},{default:d(()=>[e(M,{modelValue:a(u).categoryId,"onUpdate:modelValue":o[2]||(o[2]=l=>a(u).categoryId=l),data:a(w),props:a(Ve),"check-strictly":"","default-expand-all":"",placeholder:"\u8BF7\u9009\u62E9\u5206\u7C7B",class:"w-1/1"},null,8,["modelValue","data","props"])]),_:1})]),_:1}),e(t,{span:12},{default:d(()=>[e(r,{label:"\u5355\u4F4D",prop:"unitId"},{default:d(()=>[e(L,{modelValue:a(u).unitId,"onUpdate:modelValue":o[3]||(o[3]=l=>a(u).unitId=l),clearable:"",placeholder:"\u8BF7\u9009\u62E9\u5355\u4F4D",class:"w-1/1"},{default:d(()=>[(c(!0),I(C,null,x(a(U),l=>(c(),v(B,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(t,{span:12},{default:d(()=>[e(r,{label:"\u72B6\u6001",prop:"status"},{default:d(()=>[e(T,{modelValue:a(u).status,"onUpdate:modelValue":o[4]||(o[4]=l=>a(u).status=l)},{default:d(()=>[(c(!0),I(C,null,x(a(K)(a(W).COMMON_STATUS),l=>(c(),v(O,{key:l.value,value:l.value},{default:d(()=>[g(X(l.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(t,{span:12},{default:d(()=>[e(r,{label:"\u89C4\u683C",prop:"standard"},{default:d(()=>[e(n,{modelValue:a(u).standard,"onUpdate:modelValue":o[5]||(o[5]=l=>a(u).standard=l),placeholder:"\u8BF7\u8F93\u5165\u89C4\u683C"},null,8,["modelValue"])]),_:1})]),_:1}),e(t,{span:12},{default:d(()=>[e(r,{label:"\u4FDD\u8D28\u671F\u5929\u6570",prop:"expiryDay"},{default:d(()=>[e(f,{modelValue:a(u).expiryDay,"onUpdate:modelValue":o[6]||(o[6]=l=>a(u).expiryDay=l),placeholder:"\u8BF7\u8F93\u5165\u4FDD\u8D28\u671F\u5929\u6570",min:0,precision:0,class:"!w-1/1"},null,8,["modelValue"])]),_:1})]),_:1}),e(t,{span:12},{default:d(()=>[e(r,{label:"\u91CD\u91CF\uFF08kg\uFF09",prop:"weight"},{default:d(()=>[e(f,{modelValue:a(u).weight,"onUpdate:modelValue":o[7]||(o[7]=l=>a(u).weight=l),placeholder:"\u8BF7\u8F93\u5165\u91CD\u91CF\uFF08kg\uFF09",min:0,class:"!w-1/1"},null,8,["modelValue"])]),_:1})]),_:1}),e(t,{span:12},{default:d(()=>[e(r,{label:"\u91C7\u8D2D\u4EF7\u683C",prop:"purchasePrice"},{default:d(()=>[e(f,{modelValue:a(u).purchasePrice,"onUpdate:modelValue":o[8]||(o[8]=l=>a(u).purchasePrice=l),placeholder:"\u8BF7\u8F93\u5165\u91C7\u8D2D\u4EF7\u683C\uFF0C\u5355\u4F4D\uFF1A\u5143",min:0,precision:2,class:"!w-1/1"},null,8,["modelValue"])]),_:1})]),_:1}),e(t,{span:12},{default:d(()=>[e(r,{label:"\u9500\u552E\u4EF7\u683C",prop:"salePrice"},{default:d(()=>[e(f,{modelValue:a(u).salePrice,"onUpdate:modelValue":o[9]||(o[9]=l=>a(u).salePrice=l),placeholder:"\u8BF7\u8F93\u5165\u9500\u552E\u4EF7\u683C\uFF0C\u5355\u4F4D\uFF1A\u5143",min:0,precision:2,class:"!w-1/1"},null,8,["modelValue"])]),_:1})]),_:1}),e(t,{span:12},{default:d(()=>[e(r,{label:"\u6700\u4F4E\u4EF7\u683C",prop:"minPrice"},{default:d(()=>[e(f,{modelValue:a(u).minPrice,"onUpdate:modelValue":o[10]||(o[10]=l=>a(u).minPrice=l),placeholder:"\u8BF7\u8F93\u5165\u6700\u4F4E\u4EF7\u683C\uFF0C\u5355\u4F4D\uFF1A\u5143",min:0,precision:2,class:"!w-1/1"},null,8,["modelValue"])]),_:1})]),_:1}),e(t,{span:24},{default:d(()=>[e(r,{label:"\u5907\u6CE8",prop:"remark"},{default:d(()=>[e(n,{type:"textarea",modelValue:a(u).remark,"onUpdate:modelValue":o[11]||(o[11]=l=>a(u).remark=l),placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])),[[G,a(m)]])]),_:1},8,["title","modelValue"])}}});export{ge as _};
