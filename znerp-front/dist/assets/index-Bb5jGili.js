import{d as re,z as ne,h as pe,r as d,e as ue,u as ie,ar as se,n as de,O as ce,o as p,c as C,f as e,w as t,a,P as q,F as x,p as I,Q as M,D as c,q as i,x as s,y as b,k as me,t as H,U as fe,C as _e,A as be,B as we,H as ye,I as ve,J as ge,l as he,m as Ce,af as xe,K as ke,L as Re,M as Se}from"./index-CIfmhqRC.js";import{_ as Ue}from"./index.vue_vue_type_script_setup_true_lang-DYHi04Tm.js";import{_ as Ve}from"./DictTag.vue_vue_type_script_lang-CTpVFm77.js";import{_ as Ne}from"./ContentWrap.vue_vue_type_script_setup_true_lang-sm5dIhPQ.js";import{_ as Te}from"./index-2RHHZ-Zv.js";import{d as k}from"./formatTime-DFFN_xWx.js";import{d as Ee}from"./download-D5Lb_h0f.js";import{e as Ie,n as Me,o as Oe}from"./index-BZptzjxi.js";import{_ as Le}from"./CustomerForm.vue_vue_type_script_setup_true_lang-DwPSj-v0.js";import{_ as De}from"./CustomerImportForm.vue_vue_type_script_setup_true_lang-Bs_R85iC.js";import"./index-CrBeVHKs.js";import"./color-BN7ZL7BD.js";import"./el-card-DyMugU68.js";import"./Dialog.vue_vue_type_style_index_0_lang-CtaLqQeX.js";import"./index-w2FCJT7Q.js";import"./tree-BMqZf9_I.js";import"./index-QrlE36WK.js";const Ae=re({name:"CrmCustomer",__name:"index",setup(Fe){const R=ne(),{t:Y}=pe(),S=d(!0),O=d(0),L=d([]),n=ue({pageNo:1,pageSize:10,sceneType:"1",name:"",mobile:"",industryId:void 0,level:void 0,source:void 0,pool:void 0}),D=d(),U=d(!1),V=d("1"),J=u=>{n.sceneType=u.paneName,w()},m=async()=>{S.value=!0;try{const u=await Ie(n);L.value=u.list,O.value=u.total}finally{S.value=!1}},w=()=>{n.pageNo=1,m()},Q=()=>{D.value.resetFields(),w()},{currentRoute:j,push:W}=ie(),A=d(),F=(u,r)=>{A.value.open(u,r)},z=d(),X=()=>{var u;(u=z.value)==null||u.open()},Z=async()=>{try{await R.exportConfirm(),U.value=!0;const u=await Oe(n);Ee.excel(u,"\u5BA2\u6237.xls")}catch{}finally{U.value=!1}};return se(()=>j.value,()=>{m()}),de(()=>{m()}),(u,r)=>{const K=Te,P=fe,_=_e,N=be,T=we,y=ye,f=ve,$=ge,B=Ne,E=he,ee=Ce,le=xe,o=ke,v=Ve,ae=Re,te=Ue,g=ce("hasPermi"),oe=Se;return p(),C(x,null,[e(K,{title:"\u3010\u5BA2\u6237\u3011\u5BA2\u6237\u7BA1\u7406\u3001\u516C\u6D77\u5BA2\u6237",url:"https://doc.iocoder.cn/crm/customer/"}),e(K,{title:"\u3010\u901A\u7528\u3011\u6570\u636E\u6743\u9650",url:"https://doc.iocoder.cn/crm/permission/"}),e(B,null,{default:t(()=>[e($,{ref_key:"queryFormRef",ref:D,inline:!0,model:a(n),class:"-mb-15px","label-width":"68px"},{default:t(()=>[e(_,{label:"\u5BA2\u6237\u540D\u79F0",prop:"name"},{default:t(()=>[e(P,{modelValue:a(n).name,"onUpdate:modelValue":r[0]||(r[0]=l=>a(n).name=l),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u5BA2\u6237\u540D\u79F0",onKeyup:q(w,["enter"])},null,8,["modelValue"])]),_:1}),e(_,{label:"\u624B\u673A",prop:"mobile"},{default:t(()=>[e(P,{modelValue:a(n).mobile,"onUpdate:modelValue":r[1]||(r[1]=l=>a(n).mobile=l),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u624B\u673A",onKeyup:q(w,["enter"])},null,8,["modelValue"])]),_:1}),e(_,{label:"\u6240\u5C5E\u884C\u4E1A",prop:"industryId"},{default:t(()=>[e(T,{modelValue:a(n).industryId,"onUpdate:modelValue":r[2]||(r[2]=l=>a(n).industryId=l),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u9009\u62E9\u6240\u5C5E\u884C\u4E1A"},{default:t(()=>[(p(!0),C(x,null,I(a(M)(a(c).CRM_CUSTOMER_INDUSTRY),l=>(p(),i(N,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(_,{label:"\u5BA2\u6237\u7EA7\u522B",prop:"level"},{default:t(()=>[e(T,{modelValue:a(n).level,"onUpdate:modelValue":r[3]||(r[3]=l=>a(n).level=l),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u9009\u62E9\u5BA2\u6237\u7EA7\u522B"},{default:t(()=>[(p(!0),C(x,null,I(a(M)(a(c).CRM_CUSTOMER_LEVEL),l=>(p(),i(N,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(_,{label:"\u5BA2\u6237\u6765\u6E90",prop:"source"},{default:t(()=>[e(T,{modelValue:a(n).source,"onUpdate:modelValue":r[4]||(r[4]=l=>a(n).source=l),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u9009\u62E9\u5BA2\u6237\u6765\u6E90"},{default:t(()=>[(p(!0),C(x,null,I(a(M)(a(c).CRM_CUSTOMER_SOURCE),l=>(p(),i(N,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(_,null,{default:t(()=>[e(f,{onClick:w},{default:t(()=>[e(y,{class:"mr-5px",icon:"ep:search"}),s(" \u641C\u7D22 ")]),_:1}),e(f,{onClick:Q},{default:t(()=>[e(y,{class:"mr-5px",icon:"ep:refresh"}),s(" \u91CD\u7F6E ")]),_:1}),b((p(),i(f,{type:"primary",onClick:r[5]||(r[5]=l=>F("create"))},{default:t(()=>[e(y,{class:"mr-5px",icon:"ep:plus"}),s(" \u65B0\u589E ")]),_:1})),[[g,["crm:customer:create"]]]),b((p(),i(f,{plain:"",type:"warning",onClick:X},{default:t(()=>[e(y,{icon:"ep:upload"}),s(" \u5BFC\u5165 ")]),_:1})),[[g,["crm:customer:import"]]]),b((p(),i(f,{loading:a(U),plain:"",type:"success",onClick:Z},{default:t(()=>[e(y,{class:"mr-5px",icon:"ep:download"}),s(" \u5BFC\u51FA ")]),_:1},8,["loading"])),[[g,["crm:customer:export"]]])]),_:1})]),_:1},8,["model"])]),_:1}),e(B,null,{default:t(()=>[e(ee,{modelValue:a(V),"onUpdate:modelValue":r[6]||(r[6]=l=>me(V)?V.value=l:null),onTabClick:J},{default:t(()=>[e(E,{label:"\u6211\u8D1F\u8D23\u7684",name:"1"}),e(E,{label:"\u6211\u53C2\u4E0E\u7684",name:"2"}),e(E,{label:"\u4E0B\u5C5E\u8D1F\u8D23\u7684",name:"3"})]),_:1},8,["modelValue"]),b((p(),i(ae,{data:a(L),"show-overflow-tooltip":!0,stripe:!0},{default:t(()=>[e(o,{align:"center",fixed:"left",label:"\u5BA2\u6237\u540D\u79F0",prop:"name",width:"160"},{default:t(l=>[e(le,{underline:!1,type:"primary",onClick:G=>{return h=l.row.id,void W({name:"CrmCustomerDetail",params:{id:h}});var h}},{default:t(()=>[s(H(l.row.name),1)]),_:2},1032,["onClick"])]),_:1}),e(o,{align:"center",label:"\u5BA2\u6237\u6765\u6E90",prop:"source",width:"100"},{default:t(l=>[e(v,{type:a(c).CRM_CUSTOMER_SOURCE,value:l.row.source},null,8,["type","value"])]),_:1}),e(o,{align:"center",label:"\u624B\u673A",prop:"mobile",width:"120"}),e(o,{align:"center",label:"\u7535\u8BDD",prop:"telephone",width:"130"}),e(o,{align:"center",label:"\u90AE\u7BB1",prop:"email",width:"180"}),e(o,{align:"center",label:"\u5BA2\u6237\u7EA7\u522B",prop:"level",width:"135"},{default:t(l=>[e(v,{type:a(c).CRM_CUSTOMER_LEVEL,value:l.row.level},null,8,["type","value"])]),_:1}),e(o,{align:"center",label:"\u5BA2\u6237\u884C\u4E1A",prop:"industryId",width:"100"},{default:t(l=>[e(v,{type:a(c).CRM_CUSTOMER_INDUSTRY,value:l.row.industryId},null,8,["type","value"])]),_:1}),e(o,{formatter:a(k),align:"center",label:"\u4E0B\u6B21\u8054\u7CFB\u65F6\u95F4",prop:"contactNextTime",width:"180px"},null,8,["formatter"]),e(o,{align:"center",label:"\u5907\u6CE8",prop:"remark",width:"200"}),e(o,{align:"center",label:"\u9501\u5B9A\u72B6\u6001",prop:"lockStatus"},{default:t(l=>[e(v,{type:a(c).INFRA_BOOLEAN_STRING,value:l.row.lockStatus},null,8,["type","value"])]),_:1}),e(o,{align:"center",label:"\u6210\u4EA4\u72B6\u6001",prop:"dealStatus"},{default:t(l=>[e(v,{type:a(c).INFRA_BOOLEAN_STRING,value:l.row.dealStatus},null,8,["type","value"])]),_:1}),e(o,{formatter:a(k),align:"center",label:"\u6700\u540E\u8DDF\u8FDB\u65F6\u95F4",prop:"contactLastTime",width:"180px"},null,8,["formatter"]),e(o,{align:"center",label:"\u6700\u540E\u8DDF\u8FDB\u8BB0\u5F55",prop:"contactLastContent",width:"200"}),e(o,{align:"center",label:"\u5730\u5740",prop:"detailAddress",width:"180"}),e(o,{align:"center",label:"\u8DDD\u79BB\u8FDB\u5165\u516C\u6D77\u5929\u6570",prop:"poolDay",width:"140"},{default:t(l=>[s(H(l.row.poolDay)+" \u5929",1)]),_:1}),e(o,{align:"center",label:"\u8D1F\u8D23\u4EBA",prop:"ownerUserName",width:"100px"}),e(o,{align:"center",label:"\u6240\u5C5E\u90E8\u95E8",prop:"ownerUserDeptName",width:"100px"}),e(o,{formatter:a(k),align:"center",label:"\u66F4\u65B0\u65F6\u95F4",prop:"updateTime",width:"180px"},null,8,["formatter"]),e(o,{formatter:a(k),align:"center",label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime",width:"180px"},null,8,["formatter"]),e(o,{align:"center",label:"\u521B\u5EFA\u4EBA",prop:"creatorName",width:"100px"}),e(o,{align:"center",fixed:"right",label:"\u64CD\u4F5C","min-width":"150"},{default:t(l=>[b((p(),i(f,{link:"",type:"primary",onClick:G=>F("update",l.row.id)},{default:t(()=>[s(" \u7F16\u8F91 ")]),_:2},1032,["onClick"])),[[g,["crm:customer:update"]]]),b((p(),i(f,{link:"",type:"danger",onClick:G=>(async h=>{try{await R.delConfirm(),await Me(h),R.success(Y("common.delSuccess")),await m()}catch{}})(l.row.id)},{default:t(()=>[s(" \u5220\u9664 ")]),_:2},1032,["onClick"])),[[g,["crm:customer:delete"]]])]),_:1})]),_:1},8,["data"])),[[oe,a(S)]]),e(te,{limit:a(n).pageSize,"onUpdate:limit":r[7]||(r[7]=l=>a(n).pageSize=l),page:a(n).pageNo,"onUpdate:page":r[8]||(r[8]=l=>a(n).pageNo=l),total:a(O),onPagination:m},null,8,["limit","page","total"])]),_:1}),e(Le,{ref_key:"formRef",ref:A,onSuccess:m},null,512),e(De,{ref_key:"importFormRef",ref:z,onSuccess:m},null,512)],64)}}});export{Ae as default};
