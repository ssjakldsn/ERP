import{d as aa,b as ea,z as ra,h as ta,r as w,e as la,n as oa,o as l,c as m,f as a,w as t,a as o,P as sa,F as y,p as B,q as g,x as d,y as G,g as h,D as ia,t as p,a5 as k,U as da,C as pa,A as ua,B as na,H as ma,I as ca,J as fa,K as wa,L as ya,i as ka,M as ga}from"./index-CIfmhqRC.js";import{_ as ha}from"./index.vue_vue_type_script_setup_true_lang-DYHi04Tm.js";import{E as _a}from"./el-image-DLpquQe6.js";import{_ as va}from"./DictTag.vue_vue_type_script_lang-CTpVFm77.js";import{_ as Sa}from"./ContentWrap.vue_vue_type_script_setup_true_lang-sm5dIhPQ.js";import{_ as ba}from"./PurchaseOrderForm.vue_vue_type_script_setup_true_lang-eg3s4DM-.js";import{_ as xa}from"./UploadImage.vue_vue_type_script_setup_true_lang-CrxuI2Mo.js";import{_ as Ia}from"./CheckForm.vue_vue_type_script_setup_true_lang-Cf0grHjr.js";import{Z as z}from"./index-H3f_2XHj.js";import{n as Na}from"./PurchaseOrderItemForm.vue_vue_type_script_setup_true_lang-Wwp1t-rc.js";import"./index-CrBeVHKs.js";import"./color-BN7ZL7BD.js";import"./el-card-DyMugU68.js";import"./Dialog.vue_vue_type_style_index_0_lang-CtaLqQeX.js";import"./el-descriptions-item-BL6ba85F.js";import"./formatTime-DFFN_xWx.js";const Ca={class:"flex bg-blue-50 py-1 px-3 dark:bg-blue-900"},Ua={class:"flex-1 text-blue-500 ml-4"},qa={class:"pl-4"},za={class:"flex gap-5"},Pa={class:"flex-1"},Va={key:1,class:"bg-gray-100 text-gray-600 px-2 dark:bg-blue-100"},Ra={class:"text-gray-400"},Da={class:"flex flex-row-reverse"},Ka=aa({__name:"index",setup(Oa){const P=ea().getUser.id,V=ra();ta();const v=w(!0),I=w(0),N=w([]),u=la({pageNo:1,pageSize:10,orderNumber:"",status:"1,12",shopName:void 0}),R=w(),D=w([]),H=w([{info:"\u5546\u54C1\u4FE1\u606F",price:"\u5355\u4EF7\uFF08USD\uFF09",num:"\u6570\u91CF",requiresShipping:"\u914D\u9001\u65B9\u5F0F",option:""}]),_=async()=>{v.value=!0;try{const i=await z.getOrderPage(u);i?(N.value=i.list,I.value=i.total):(N.value=[],I.value=0)}finally{v.value=!1}},C=()=>{u.pageNo=1,_()},L=()=>{R.value.resetFields(),C()},K=w(),O=w(),T=(i,s)=>{O.value.open(i,s)},F=w(),J=(i,s)=>{F.value.open(i,s)},A=async i=>{try{await V.confirm("\u786E\u5B9A\u9886\u53D6\u753B\u56FE\u4EFB\u52A1\u5417\uFF1F");let s={orderId:i.orderId,itemId:i.id,productId:i.productId,type:1};await z.updateDraftsPage(s),V.success("\u9886\u53D6\u6210\u529F\uFF01"),await _()}catch{}};return oa(async()=>{await _(),await(async()=>{var s;const i=await z.shopPage({pageNo:1,pageSize:10});D.value=(s=i.list)==null?void 0:s.map(S=>({label:S.name,value:S.enName}))})()}),(i,s)=>{const S=da,U=pa,Q=ua,j=na,E=ma,c=ca,W=fa,M=Sa,n=wa,q=ya,X=va,b=ka,Y=_a,$=ha,Z=ga;return l(),m(y,null,[a(M,null,{default:t(()=>[a(W,{ref_key:"queryFormRef",ref:R,inline:!0,model:o(u),class:"-mb-15px","label-width":"88px"},{default:t(()=>[a(U,{label:"\u8BA2\u5355\u53F7",prop:"orderNumber"},{default:t(()=>[a(S,{modelValue:o(u).orderNumber,"onUpdate:modelValue":s[0]||(s[0]=r=>o(u).orderNumber=r),modelModifiers:{number:!0},placeholder:"\u8BF7\u8F93\u5165\u8BA2\u5355\u53F7",clearable:"",onKeyup:sa(C,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),a(U,{label:"\u5E97\u94FA",prop:"shopName"},{default:t(()=>[a(j,{modelValue:o(u).shopName,"onUpdate:modelValue":s[1]||(s[1]=r=>o(u).shopName=r),placeholder:"\u8BF7\u9009\u62E9\u5E97\u94FA",clearable:"",class:"!w-240px"},{default:t(()=>[(l(!0),m(y,null,B(o(D),r=>(l(),g(Q,{key:r.value,label:r.label,value:r.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(U,null,{default:t(()=>[a(c,{onClick:C},{default:t(()=>[a(E,{class:"mr-5px",icon:"ep:search"}),d(" \u641C\u7D22 ")]),_:1}),a(c,{onClick:L},{default:t(()=>[a(E,{class:"mr-5px",icon:"ep:refresh"}),d(" \u91CD\u7F6E ")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a(M,null,{default:t(()=>[G((l(),g(q,{data:o(N)},{default:t(()=>[a(n,null,{header:t(()=>[a(q,{data:o(H),"show-header":!1},{default:t(()=>[a(n,{prop:"info",width:"500"}),a(n,{prop:"price",width:"200"}),a(n,{prop:"num",width:"100"}),a(n,{prop:"requiresShipping",width:"200"}),a(n,{prop:"option",align:"right"})]),_:1},8,["data"])]),default:t(r=>[h("div",Ca,[a(X,{type:o(ia).ZN_ORDER_STATUS,value:r.row.status},null,8,["type","value"]),h("div",Ua,"#"+p(r.row.orderNumber),1),h("div",qa,[a(c,{link:"",onClick:e=>{return f="detail",x=r.row,void K.value.open(f,x);var f,x}},{default:t(()=>[d(" \u67E5\u770B\u8BE6\u60C5 ")]),_:2},1032,["onClick"]),r.row.type==1&&r.row.orderItems[0].draftsmans.length===0?(l(),m(y,{key:0},[a(b,{direction:"vertical"}),a(c,{link:"",onClick:e=>A(r.row.orderItems[0])},{default:t(()=>[d(" \u9886\u53D6\u4EFB\u52A1 ")]),_:2},1032,["onClick"])],64)):k("",!0),r.row.type==1&&r.row.orderItems[0].draftsmans.length>0?(l(),m(y,{key:1},[a(b,{direction:"vertical"}),r.row.orderItems[0].draftsmans[0].userId===o(P)?(l(),g(c,{key:0,onClick:e=>T("draw",r.row.orderItems[0]),link:""},{default:t(()=>[d(p(r.row.orderItems[0].draftsmans[0].imgUrl?"\u4FEE\u6539":"\u4E0A\u4F20")+"\u56FE\u7247 ",1)]),_:2},1032,["onClick"])):k("",!0),r.row.orderItems[0].draftsmans[0].imgUrl?(l(),m(y,{key:1},[a(b,{direction:"vertical"}),a(c,{type:r.row.orderItems[0].draStatus==1?"success":r.row.orderItems[0].draStatus==2?"danger":"primary",onClick:e=>J("draw",r.row.orderItems[0].draftsmans[0]),link:""},{default:t(()=>[d(" \u5BA1\u6838"+p(r.row.orderItems[0].draStatus==1?"\u901A\u8FC7":r.row.orderItems[0].draStatus==2?"\u4E0D\u901A\u8FC7":""),1)]),_:2},1032,["type","onClick"])],64)):k("",!0)],64)):k("",!0)])]),G((l(),g(q,{data:r.row.orderItems,"show-header":!1},{default:t(()=>[a(n,{width:"500"},{default:t(e=>[h("div",za,[a(Y,{style:{width:"64px",height:"64px"},src:e.row.src?e.row.src:o(Na),fit:"cover"},null,8,["src"]),h("div",Pa,[h("h4",null,p(e.row.title),1),JSON.parse(e.row.properties).length>0?(l(!0),m(y,{key:0},B(JSON.parse(e.row.properties),(f,x)=>(l(),m("p",{key:"prop_"+x},[f.value.includes("https://")?k("",!0):(l(),m(y,{key:0},[d(p(f.name)+": "+p(f.value),1)],64))]))),128)):(l(),m("span",Va,"Variants: "+p(e.row.variantTitle?e.row.variantTitle:"\u6682\u65E0"),1)),h("p",Ra,"SKU\uFF1A"+p(e.row.zhProductSku?e.row.zhProductSku:"\u6682\u65E0"),1)])])]),_:1}),a(n,{width:"200"},{default:t(e=>[d(p(e.row.price),1)]),_:1}),a(n,{width:"100"},{default:t(e=>[d(p(e.row.quantity),1)]),_:1}),a(n,{prop:"requiresShipping"},{default:t(e=>[d(p(e.row.requiresShipping==1?"\u8FD0\u8F93":"\u65E0\u9700\u53D1\u8D27"),1)]),_:1}),r.row.type==2?(l(),g(n,{key:0,width:"200"},{default:t(e=>[h("div",Da,[e.row.draftsmans.length===0?(l(),g(c,{key:0,type:"primary",link:"",onClick:f=>A(e.row)},{default:t(()=>[d(" \u9886\u53D6\u4EFB\u52A1 ")]),_:2},1032,["onClick"])):(l(),m(y,{key:1},[e.row.draftsmans[0].imgUrl?(l(),m(y,{key:0},[a(c,{type:e.row.draStatus==1?"success":e.row.draStatus==2?"danger":"primary",onClick:f=>J("draw",e.row),link:""},{default:t(()=>[d(" \u5BA1\u6838"+p(e.row.draStatus==1?"\u901A\u8FC7":e.row.draStatus==2?"\u4E0D\u901A\u8FC7":""),1)]),_:2},1032,["type","onClick"]),e.row.draStatus==2||e.row.draStatus==0?(l(),g(b,{key:0,direction:"vertical"})):k("",!0)],64)):k("",!0),e.row.draStatus!==1&&e.row.draftsmans[0].userId===o(P)?(l(),g(c,{key:1,type:"primary",link:"",onClick:f=>T("draw",e.row)},{default:t(()=>[d(p(e.row.draftsmans[0].imgUrl?"\u4FEE\u6539":"\u4E0A\u4F20")+"\u56FE\u7247 ",1)]),_:2},1032,["onClick"])):k("",!0)],64))])]),_:1})):k("",!0)]),_:2},1032,["data"])),[[Z,o(v)]])]),_:1})]),_:1},8,["data"])),[[Z,o(v)]]),a($,{limit:o(u).pageSize,"onUpdate:limit":s[2]||(s[2]=r=>o(u).pageSize=r),page:o(u).pageNo,"onUpdate:page":s[3]||(s[3]=r=>o(u).pageNo=r),total:o(I),onPagination:_},null,8,["limit","page","total"])]),_:1}),a(ba,{ref_key:"detailRef",ref:K,onSuccess:_},null,512),a(xa,{ref_key:"uploadImgRef",ref:O,onSuccess:_},null,512),a(Ia,{ref_key:"checkRef",ref:F,onSuccess:_},null,512)],64)}}});export{Ka as default};
