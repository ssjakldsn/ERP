import{d as $,r as l,u as q,N as B,n as D,O as N,o as s,c as P,f as e,w as t,a,y as Q,q as n,x as f,a5 as E,F as V,z as W,I as j,l as A,m as G,E as H}from"./index-CIfmhqRC.js";import{g as Z,_ as J}from"./index-Bm5JfAS4.js";import{u as K}from"./tagsView-CqxiFcdS.js";import{g as X,t as Y}from"./index-IYA49QTG.js";import{_ as aa}from"./ClueForm.vue_vue_type_script_setup_true_lang-Cbem2EMC.js";import{_ as ea}from"./ClueDetailsHeader.vue_vue_type_script_setup_true_lang-DJ8yoUx9.js";import{_ as ta}from"./ClueDetailsInfo.vue_vue_type_script_setup_true_lang-D66vyJht.js";import{_ as ia}from"./PermissionList.vue_vue_type_script_setup_true_lang-BJ8SS8cZ.js";import{_ as ra}from"./TransferForm.vue_vue_type_script_setup_true_lang-BkZZyHcA.js";import{_ as oa}from"./index.vue_vue_type_script_setup_true_lang-PdFImspl.js";import{B as d}from"./index-8CYEcIk3.js";import"./el-timeline-item-r9TewDuU.js";import"./formatTime-DFFN_xWx.js";import"./Dialog.vue_vue_type_style_index_0_lang-CtaLqQeX.js";import"./index-w2FCJT7Q.js";import"./tree-BMqZf9_I.js";import"./index-QrlE36WK.js";import"./ContentWrap.vue_vue_type_script_setup_true_lang-sm5dIhPQ.js";import"./el-card-DyMugU68.js";import"./el-descriptions-item-BL6ba85F.js";import"./DictTag.vue_vue_type_script_lang-CTpVFm77.js";import"./color-BN7ZL7BD.js";import"./el-collapse-item-BgajxfOI.js";import"./PermissionForm.vue_vue_type_script_setup_true_lang-BA269V0x.js";import"./index-B5nlbV2q.js";import"./index-B_QTmj5f.js";import"./index-BZptzjxi.js";import"./index-jPQDaA_X.js";import"./index.vue_vue_type_script_setup_true_lang-DYHi04Tm.js";import"./index-CrBeVHKs.js";import"./FollowUpRecordForm.vue_vue_type_script_setup_true_lang-CX5nVT22.js";import"./FollowUpRecordBusinessForm.vue_vue_type_script_setup_true_lang-DxrArb3L.js";import"./FollowUpRecordContactForm.vue_vue_type_script_setup_true_lang-DLVeCN1i.js";import"./BusinessListModal.vue_vue_type_script_setup_true_lang-DoLUy-ZT.js";import"./BusinessForm.vue_vue_type_script_setup_true_lang-BT6WnAjK.js";import"./index-CwB7FJGa.js";import"./BusinessProductForm.vue_vue_type_script_setup_true_lang-23yRPDfu.js";import"./index-BVTl5RdT.js";import"./ContactListModal.vue_vue_type_script_setup_true_lang-KXTfVMT0.js";import"./ContactForm.vue_vue_type_script_setup_true_lang-CLRF_VIq.js";const la=$({name:"CrmClueDetail",__name:"index",setup(sa){const r=l(0),c=l(!0),y=W(),{delView:U}=K(),{currentRoute:L}=q(),m=l(),o=l({}),_=async()=>{c.value=!0;try{o.value=await X(r.value),await S()}finally{c.value=!1}},b=l(),x=()=>{var i;(i=b.value)==null||i.open("update",r.value)},w=l(),M=()=>{var i;(i=w.value)==null||i.open(r.value)},O=async()=>{await y.confirm(`\u786E\u5B9A\u5C06\u3010${o.value.name}\u3011\u8F6C\u5316\u4E3A\u5BA2\u6237\u5417\uFF1F`),await Y(r.value),y.success(`\u8F6C\u5316\u5BA2\u6237\u3010${o.value.name}\u3011\u6210\u529F`),await _()},z=l([]),S=async()=>{const i=await Z({bizType:d.CRM_CLUE,bizId:r.value});z.value=i.list},v=()=>{U(a(L))},{params:C}=B();return D(()=>{if(!C.id)return y.warning("\u53C2\u6570\u9519\u8BEF\uFF0C\u7EBF\u7D22\u4E0D\u80FD\u4E3A\u7A7A\uFF01"),void v();r.value=C.id,_()}),(i,ma)=>{const p=j,u=A,h=J,F=G,I=H,T=N("hasPermi");return s(),P(V,null,[e(ea,{clue:a(o),loading:a(c)},{default:t(()=>{var k,R,g;return[(k=a(m))!=null&&k.validateWrite?Q((s(),n(p,{key:0,type:"primary",onClick:x},{default:t(()=>[f(" \u7F16\u8F91 ")]),_:1})),[[T,["crm:clue:update"]]]):E("",!0),(R=a(m))!=null&&R.validateOwnerUser?(s(),n(p,{key:1,type:"primary",onClick:M},{default:t(()=>[f(" \u8F6C\u79FB ")]),_:1})):E("",!0),(g=a(m))!=null&&g.validateOwnerUser&&!a(o).transformStatus?(s(),n(p,{key:2,type:"success",onClick:O},{default:t(()=>[f(" \u8F6C\u5316\u4E3A\u5BA2\u6237 ")]),_:1})):(s(),n(p,{key:3,disabled:"",type:"success"},{default:t(()=>[f("\u5DF2\u8F6C\u5316\u5BA2\u6237")]),_:1}))]}),_:1},8,["clue","loading"]),e(I,null,{default:t(()=>[e(F,null,{default:t(()=>[e(u,{label:"\u8DDF\u8FDB\u8BB0\u5F55"},{default:t(()=>[e(oa,{"biz-id":a(r),"biz-type":a(d).CRM_CLUE},null,8,["biz-id","biz-type"])]),_:1}),e(u,{label:"\u57FA\u672C\u4FE1\u606F"},{default:t(()=>[e(ta,{clue:a(o)},null,8,["clue"])]),_:1}),e(u,{label:"\u56E2\u961F\u6210\u5458"},{default:t(()=>[e(ia,{ref_key:"permissionListRef",ref:m,"biz-id":a(o).id,"biz-type":a(d).CRM_CLUE,"show-action":!0,onQuitTeam:v},null,8,["biz-id","biz-type"])]),_:1}),e(u,{label:"\u64CD\u4F5C\u65E5\u5FD7"},{default:t(()=>[e(h,{"log-list":a(z)},null,8,["log-list"])]),_:1})]),_:1})]),_:1}),e(aa,{ref_key:"formRef",ref:b,onSuccess:_},null,512),e(ra,{ref_key:"transferFormRef",ref:w,"biz-type":a(d).CRM_CLUE,onSuccess:v},null,8,["biz-type"])],64)}}});export{la as default};
