import{d as z,ai as A,r as u,e as P,ar as I,o as p,c as h,y as J,a as e,q as n,w as t,f as r,F as D,J as K,M,x as m,a5 as y,z as E,dK as G,ak as H,al as Q,C as W,I as X}from"./index-CIfmhqRC.js";import{g as Y}from"./index-BRD6A8QB.js";import{_ as Z}from"./ProductAttributes.vue_vue_type_script_setup_true_lang-C5FB3-Uq.js";import{_ as $}from"./ProductPropertyAddForm.vue_vue_type_script_setup_true_lang-BQhgUkqc.js";import{r as w}from"./formRules-C3y0LKNH.js";import{_ as b}from"./SkuList.vue_vue_type_script_setup_true_lang-DYztw255.js";const ee=z({name:"ProductSpuSkuForm",__name:"SkuForm",props:{propFormData:{type:Object,default:()=>{}},isDetail:A.bool.def(!1)},emits:["update:activeName"],setup(i,{expose:F,emit:x}){const g=[{name:"stock",rule:a=>a>=0,message:"\u5546\u54C1\u5E93\u5B58\u5FC5\u987B\u5927\u4E8E\u7B49\u4E8E 1 \uFF01\uFF01\uFF01"},{name:"price",rule:a=>a>=.01,message:"\u5546\u54C1\u9500\u552E\u4EF7\u683C\u5FC5\u987B\u5927\u4E8E\u7B49\u4E8E 0.01 \u5143\uFF01\uFF01\uFF01"},{name:"marketPrice",rule:a=>a>=.01,message:"\u5546\u54C1\u5E02\u573A\u4EF7\u683C\u5FC5\u987B\u5927\u4E8E\u7B49\u4E8E 0.01 \u5143\uFF01\uFF01\uFF01"},{name:"costPrice",rule:a=>a>=.01,message:"\u5546\u54C1\u6210\u672C\u4EF7\u683C\u5FC5\u987B\u5927\u4E8E\u7B49\u4E8E 0.00 \u5143\uFF01\uFF01\uFF01"}],V=E(),S=u(!1),v=i,T=u(),k=u(),l=u([]),d=u(),s=P({specType:!1,subCommissionType:!1,skus:[]}),B=P({specType:[w],subCommissionType:[w]});I(()=>v.propFormData,a=>{a&&(G(s,a),l.value=Y(a))},{immediate:!0});const L=x;F({validate:async()=>{if(k)try{d.value.validateSku(),await e(k).validate(),Object.assign(v.propFormData,s)}catch(a){throw V.error("\u3010\u5E93\u5B58\u4EF7\u683C\u3011\u4E0D\u5B8C\u5584\uFF0C\u8BF7\u586B\u5199\u76F8\u5173\u4FE1\u606F"),L("update:activeName","sku"),a}}});const R=()=>{for(const a of s.skus)a.firstBrokeragePrice=0,a.secondBrokeragePrice=0},U=()=>{l.value=[],s.skus=[{price:0,marketPrice:0,costPrice:0,barCode:"",picUrl:"",stock:0,weight:0,volume:0,firstBrokeragePrice:0,secondBrokeragePrice:0}]},j=a=>{d.value.generateTableData(a)};return(a,c)=>{const f=H,C=Q,o=W,N=X,O=K,q=M;return p(),h(D,null,[J((p(),n(O,{ref_key:"formRef",ref:k,disabled:i.isDetail,model:e(s),rules:e(B),"label-width":"120px"},{default:t(()=>[r(o,{label:"\u5206\u9500\u7C7B\u578B",props:"subCommissionType"},{default:t(()=>[r(C,{modelValue:e(s).subCommissionType,"onUpdate:modelValue":c[0]||(c[0]=_=>e(s).subCommissionType=_),class:"w-80",onChange:R},{default:t(()=>[r(f,{value:!1},{default:t(()=>[m("\u9ED8\u8BA4\u8BBE\u7F6E")]),_:1}),r(f,{value:!0,class:"radio"},{default:t(()=>[m("\u5355\u72EC\u8BBE\u7F6E")]),_:1})]),_:1},8,["modelValue"])]),_:1}),r(o,{label:"\u5546\u54C1\u89C4\u683C",props:"specType"},{default:t(()=>[r(C,{modelValue:e(s).specType,"onUpdate:modelValue":c[1]||(c[1]=_=>e(s).specType=_),class:"w-80",onChange:U},{default:t(()=>[r(f,{value:!1,class:"radio"},{default:t(()=>[m("\u5355\u89C4\u683C")]),_:1}),r(f,{value:!0},{default:t(()=>[m("\u591A\u89C4\u683C")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(s).specType?y("",!0):(p(),n(o,{key:0},{default:t(()=>[r(e(b),{ref_key:"skuListRef",ref:d,"prop-form-data":e(s),"property-list":e(l),"rule-config":g},null,8,["prop-form-data","property-list"])]),_:1})),e(s).specType?(p(),n(o,{key:1,label:"\u5546\u54C1\u5C5E\u6027"},{default:t(()=>[r(N,{class:"mb-10px mr-15px",onClick:e(T).open},{default:t(()=>[m("\u6DFB\u52A0\u5C5E\u6027")]),_:1},8,["onClick"]),r(Z,{"is-detail":i.isDetail,"property-list":e(l),onSuccess:j},null,8,["is-detail","property-list"])]),_:1})):y("",!0),e(s).specType&&e(l).length>0?(p(),h(D,{key:2},[i.isDetail?y("",!0):(p(),n(o,{key:0,label:"\u6279\u91CF\u8BBE\u7F6E"},{default:t(()=>[r(e(b),{"is-batch":!0,"prop-form-data":e(s),"property-list":e(l)},null,8,["prop-form-data","property-list"])]),_:1})),r(o,{label:"\u89C4\u683C\u5217\u8868"},{default:t(()=>[r(e(b),{ref_key:"skuListRef",ref:d,"is-detail":i.isDetail,"prop-form-data":e(s),"property-list":e(l),"rule-config":g},null,8,["is-detail","prop-form-data","property-list"])]),_:1})],64)):y("",!0)]),_:1},8,["disabled","model","rules"])),[[q,e(S)]]),r($,{ref_key:"attributesAddFormRef",ref:T,propertyList:e(l)},null,8,["propertyList"])],64)}}});export{ee as _};
