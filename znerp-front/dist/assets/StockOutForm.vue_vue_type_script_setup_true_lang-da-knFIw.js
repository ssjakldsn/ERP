import{bt as i,d as H,h as K,z as N,r,e as Q,a3 as W,o as f,q as v,w as l,a as e,x as T,a5 as X,f as a,y as Z,c as ee,F as ae,p as le,k as C,U as te,C as ue,E as oe,G as se,A as de,B as re,cn as ie,j as me,J as ce,l as pe,m as ne,I as fe,M as ve}from"./index-CIfmhqRC.js";import{_ as ke}from"./Dialog.vue_vue_type_style_index_0_lang-CtaLqQeX.js";import{_ as _e}from"./ContentWrap.vue_vue_type_script_setup_true_lang-sm5dIhPQ.js";import{_ as ye}from"./StockOutItemForm.vue_vue_type_script_setup_true_lang-C4XFfgAq.js";import{C as be}from"./index-CIRABDoG.js";const k={getStockOutPage:async s=>await i.get({url:"/erp/stock-out/page",params:s}),getStockOut:async s=>await i.get({url:"/erp/stock-out/get?id="+s}),createStockOut:async s=>await i.post({url:"/erp/stock-out/create",data:s}),updateStockOut:async s=>await i.put({url:"/erp/stock-out/update",data:s}),updateStockOutStatus:async(s,_)=>await i.put({url:"/erp/stock-out/update-status",params:{id:s,status:_}}),deleteStockOut:async s=>await i.delete({url:"/erp/stock-out/delete",params:{ids:s.join(",")}}),exportStockOut:async s=>await i.download({url:"/erp/stock-out/export-excel",params:s})},we=H({name:"StockOutForm",__name:"StockOutForm",emits:["success"],setup(s,{expose:_,emit:F}){const{t:y}=K(),g=N(),m=r(!1),U=r(""),c=r(!1),b=r(""),o=r({id:void 0,customerId:void 0,outTime:void 0,remark:void 0,fileUrl:"",items:[]}),j=Q({outTime:[{required:!0,message:"\u51FA\u5E93\u65F6\u95F4\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),w=W(()=>b.value==="detail"),V=r(),O=r([]),S=r("item"),x=r();_({open:async(d,t)=>{if(m.value=!0,U.value=y("action."+d),b.value=d,A(),t){c.value=!0;try{o.value=await k.getStockOut(t)}finally{c.value=!1}}O.value=await be.getCustomerSimpleList()}});const q=F,z=async()=>{await V.value.validate(),await x.value.validate(),c.value=!0;try{const d=o.value;b.value==="create"?(await k.createStockOut(d),g.success(y("common.createSuccess"))):(await k.updateStockOut(d),g.success(y("common.updateSuccess"))),m.value=!1,q("success")}finally{c.value=!1}},A=()=>{var d;o.value={id:void 0,customerId:void 0,outTime:void 0,remark:void 0,fileUrl:void 0,items:[]},(d=V.value)==null||d.resetFields()};return(d,t)=>{const h=te,p=ue,n=oe,B=se,E=de,M=re,R=ie,D=me,G=ce,J=pe,L=ne,P=_e,I=fe,Y=ke,$=ve;return f(),v(Y,{title:e(U),modelValue:e(m),"onUpdate:modelValue":t[7]||(t[7]=u=>C(m)?m.value=u:null),width:"1080"},{footer:l(()=>[e(w)?X("",!0):(f(),v(I,{key:0,onClick:z,type:"primary",disabled:e(c)},{default:l(()=>[T(" \u786E \u5B9A ")]),_:1},8,["disabled"])),a(I,{onClick:t[6]||(t[6]=u=>m.value=!1)},{default:l(()=>[T("\u53D6 \u6D88")]),_:1})]),default:l(()=>[Z((f(),v(G,{ref_key:"formRef",ref:V,model:e(o),rules:e(j),"label-width":"100px",disabled:e(w)},{default:l(()=>[a(D,{gutter:20},{default:l(()=>[a(n,{span:8},{default:l(()=>[a(p,{label:"\u51FA\u5E93\u5355\u53F7",prop:"no"},{default:l(()=>[a(h,{disabled:"",modelValue:e(o).no,"onUpdate:modelValue":t[0]||(t[0]=u=>e(o).no=u),placeholder:"\u4FDD\u5B58\u65F6\u81EA\u52A8\u751F\u6210"},null,8,["modelValue"])]),_:1})]),_:1}),a(n,{span:8},{default:l(()=>[a(p,{label:"\u51FA\u5E93\u65F6\u95F4",prop:"outTime"},{default:l(()=>[a(B,{modelValue:e(o).outTime,"onUpdate:modelValue":t[1]||(t[1]=u=>e(o).outTime=u),type:"date","value-format":"x",placeholder:"\u9009\u62E9\u51FA\u5E93\u65F6\u95F4",class:"!w-1/1"},null,8,["modelValue"])]),_:1})]),_:1}),a(n,{span:8},{default:l(()=>[a(p,{label:"\u5BA2\u6237",prop:"customerId"},{default:l(()=>[a(M,{modelValue:e(o).customerId,"onUpdate:modelValue":t[2]||(t[2]=u=>e(o).customerId=u),clearable:"",filterable:"",placeholder:"\u8BF7\u9009\u62E9\u5BA2\u6237",class:"!w-1/1"},{default:l(()=>[(f(!0),ee(ae,null,le(e(O),u=>(f(),v(E,{key:u.id,label:u.name,value:u.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),a(n,{span:16},{default:l(()=>[a(p,{label:"\u5907\u6CE8",prop:"remark"},{default:l(()=>[a(h,{type:"textarea",modelValue:e(o).remark,"onUpdate:modelValue":t[3]||(t[3]=u=>e(o).remark=u),rows:1,placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8"},null,8,["modelValue"])]),_:1})]),_:1}),a(n,{span:8},{default:l(()=>[a(p,{label:"\u9644\u4EF6",prop:"fileUrl"},{default:l(()=>[a(R,{"is-show-tip":!1,modelValue:e(o).fileUrl,"onUpdate:modelValue":t[4]||(t[4]=u=>e(o).fileUrl=u),limit:1},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules","disabled"])),[[$,e(c)]]),a(P,null,{default:l(()=>[a(L,{modelValue:e(S),"onUpdate:modelValue":t[5]||(t[5]=u=>C(S)?S.value=u:null),class:"-mt-15px -mb-10px"},{default:l(()=>[a(J,{label:"\u51FA\u5E93\u4EA7\u54C1\u6E05\u5355",name:"item"},{default:l(()=>[a(ye,{ref_key:"itemFormRef",ref:x,items:e(o).items,disabled:e(w)},null,8,["items","disabled"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["title","modelValue"])}}});export{k as S,we as _};
