import{bt as r,d as D,h as K,z as N,r as u,e as W,a3 as O,o as V,q as b,w as t,a as e,x as T,a5 as Q,f as a,y as X,k as F,U as Y,C as Z,E as $,G as ee,cn as ae,j as le,J as te,l as se,m as oe,I as ce,M as de}from"./index-CIfmhqRC.js";import{_ as ue}from"./Dialog.vue_vue_type_style_index_0_lang-CtaLqQeX.js";import{_ as re}from"./ContentWrap.vue_vue_type_script_setup_true_lang-sm5dIhPQ.js";import{_ as ie}from"./StockCheckItemForm.vue_vue_type_script_setup_true_lang-BphY0lYL.js";const n={getStockCheckPage:async s=>await r.get({url:"/erp/stock-check/page",params:s}),getStockCheck:async s=>await r.get({url:"/erp/stock-check/get?id="+s}),createStockCheck:async s=>await r.post({url:"/erp/stock-check/create",data:s}),updateStockCheck:async s=>await r.put({url:"/erp/stock-check/update",data:s}),updateStockCheckStatus:async(s,f)=>await r.put({url:"/erp/stock-check/update-status",params:{id:s,status:f}}),deleteStockCheck:async s=>await r.delete({url:"/erp/stock-check/delete",params:{ids:s.join(",")}}),exportStockCheck:async s=>await r.download({url:"/erp/stock-check/export-excel",params:s})},me=D({name:"StockCheckForm",__name:"StockCheckForm",emits:["success"],setup(s,{expose:f,emit:I}){const{t:h}=K(),S=N(),i=u(!1),C=u(""),m=u(!1),v=u(""),o=u({id:void 0,customerId:void 0,checkTime:void 0,remark:void 0,fileUrl:"",items:[]}),q=W({checkTime:[{required:!0,message:"\u76D8\u70B9\u65F6\u95F4\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),_=O(()=>v.value==="detail"),y=u(),w=u("item"),g=u();f({open:async(d,l)=>{if(i.value=!0,C.value=h("action."+d),v.value=d,G(),l){m.value=!0;try{o.value=await n.getStockCheck(l)}finally{m.value=!1}}}});const R=I,j=async()=>{await y.value.validate(),await g.value.validate(),m.value=!0;try{const d=o.value;v.value==="create"?(await n.createStockCheck(d),S.success(h("common.createSuccess"))):(await n.updateStockCheck(d),S.success(h("common.updateSuccess"))),i.value=!1,R("success")}finally{m.value=!1}},G=()=>{var d;o.value={id:void 0,customerId:void 0,checkTime:void 0,remark:void 0,fileUrl:void 0,items:[]},(d=y.value)==null||d.resetFields()};return(d,l)=>{const U=Y,p=Z,k=$,z=ee,E=ae,H=le,J=te,L=se,M=oe,P=re,x=ce,A=ue,B=de;return V(),b(A,{title:e(C),modelValue:e(i),"onUpdate:modelValue":l[6]||(l[6]=c=>F(i)?i.value=c:null),width:"1080"},{footer:t(()=>[e(_)?Q("",!0):(V(),b(x,{key:0,onClick:j,type:"primary",disabled:e(m)},{default:t(()=>[T(" \u786E \u5B9A ")]),_:1},8,["disabled"])),a(x,{onClick:l[5]||(l[5]=c=>i.value=!1)},{default:t(()=>[T("\u53D6 \u6D88")]),_:1})]),default:t(()=>[X((V(),b(J,{ref_key:"formRef",ref:y,model:e(o),rules:e(q),"label-width":"100px",disabled:e(_)},{default:t(()=>[a(H,{gutter:20},{default:t(()=>[a(k,{span:8},{default:t(()=>[a(p,{label:"\u76D8\u70B9\u5355\u53F7",prop:"no"},{default:t(()=>[a(U,{disabled:"",modelValue:e(o).no,"onUpdate:modelValue":l[0]||(l[0]=c=>e(o).no=c),placeholder:"\u4FDD\u5B58\u65F6\u81EA\u52A8\u751F\u6210"},null,8,["modelValue"])]),_:1})]),_:1}),a(k,{span:8},{default:t(()=>[a(p,{label:"\u76D8\u70B9\u65F6\u95F4",prop:"checkTime"},{default:t(()=>[a(z,{modelValue:e(o).checkTime,"onUpdate:modelValue":l[1]||(l[1]=c=>e(o).checkTime=c),type:"date","value-format":"x",placeholder:"\u9009\u62E9\u76D8\u70B9\u65F6\u95F4",class:"!w-1/1"},null,8,["modelValue"])]),_:1})]),_:1}),a(k,{span:16},{default:t(()=>[a(p,{label:"\u5907\u6CE8",prop:"remark"},{default:t(()=>[a(U,{type:"textarea",modelValue:e(o).remark,"onUpdate:modelValue":l[2]||(l[2]=c=>e(o).remark=c),rows:1,placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8"},null,8,["modelValue"])]),_:1})]),_:1}),a(k,{span:8},{default:t(()=>[a(p,{label:"\u9644\u4EF6",prop:"fileUrl"},{default:t(()=>[a(E,{"is-show-tip":!1,modelValue:e(o).fileUrl,"onUpdate:modelValue":l[3]||(l[3]=c=>e(o).fileUrl=c),limit:1},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules","disabled"])),[[B,e(m)]]),a(P,null,{default:t(()=>[a(M,{modelValue:e(w),"onUpdate:modelValue":l[4]||(l[4]=c=>F(w)?w.value=c:null),class:"-mt-15px -mb-10px"},{default:t(()=>[a(L,{label:"\u76D8\u70B9\u4EA7\u54C1\u6E05\u5355",name:"item"},{default:t(()=>[a(ie,{ref_key:"itemFormRef",ref:g,items:e(o).items,disabled:e(_)},null,8,["items","disabled"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["title","modelValue"])}}});export{n as S,me as _};
