import{d as L,r,u as O,N as Q,n as V,o as u,c as j,y as A,a as i,q as d,w as t,x as c,a5 as z,f as e,F as G,z as H,I as J,l as K,m as P,E as Z,M as $}from"./index-CIfmhqRC.js";import{g as X,_ as Y}from"./index-Bm5JfAS4.js";import{u as ii}from"./tagsView-CqxiFcdS.js";import{a as ei}from"./index-B5nlbV2q.js";import{_ as ai}from"./BusinessDetailsHeader.vue_vue_type_script_setup_true_lang-CA2FjQms.js";import{_ as ti}from"./BusinessDetailsInfo.vue_vue_type_script_setup_true_lang-DenGg9QM.js";import{_ as ri}from"./PermissionList.vue_vue_type_script_setup_true_lang-BJ8SS8cZ.js";import{B as m}from"./index-8CYEcIk3.js";import{_ as si}from"./BusinessForm.vue_vue_type_script_setup_true_lang-BT6WnAjK.js";import{_ as oi}from"./TransferForm.vue_vue_type_script_setup_true_lang-BkZZyHcA.js";import{_ as li}from"./index.vue_vue_type_script_setup_true_lang-PdFImspl.js";import{_ as mi}from"./ContactList.vue_vue_type_script_setup_true_lang-BYr0nk9x.js";import{_ as ui}from"./BusinessUpdateStatusForm.vue_vue_type_script_setup_true_lang-D7P6PvwK.js";import{_ as pi}from"./ContractList.vue_vue_type_script_setup_true_lang-Bv1adOHr.js";import{_ as ni}from"./BusinessProductList.vue_vue_type_script_setup_true_lang-DTP1iJ74.js";import"./el-timeline-item-r9TewDuU.js";import"./formatTime-DFFN_xWx.js";import"./ContentWrap.vue_vue_type_script_setup_true_lang-sm5dIhPQ.js";import"./el-card-DyMugU68.js";import"./el-descriptions-item-BL6ba85F.js";import"./el-collapse-item-BgajxfOI.js";import"./DictTag.vue_vue_type_script_lang-CTpVFm77.js";import"./color-BN7ZL7BD.js";import"./PermissionForm.vue_vue_type_script_setup_true_lang-BA269V0x.js";import"./Dialog.vue_vue_type_style_index_0_lang-CtaLqQeX.js";import"./index-QrlE36WK.js";import"./index-CwB7FJGa.js";import"./index-BZptzjxi.js";import"./BusinessProductForm.vue_vue_type_script_setup_true_lang-23yRPDfu.js";import"./index-BVTl5RdT.js";import"./index-IYA49QTG.js";import"./index-B_QTmj5f.js";import"./index-jPQDaA_X.js";import"./index.vue_vue_type_script_setup_true_lang-DYHi04Tm.js";import"./index-CrBeVHKs.js";import"./FollowUpRecordForm.vue_vue_type_script_setup_true_lang-CX5nVT22.js";import"./FollowUpRecordBusinessForm.vue_vue_type_script_setup_true_lang-DxrArb3L.js";import"./FollowUpRecordContactForm.vue_vue_type_script_setup_true_lang-DLVeCN1i.js";import"./BusinessListModal.vue_vue_type_script_setup_true_lang-DoLUy-ZT.js";import"./ContactListModal.vue_vue_type_script_setup_true_lang-KXTfVMT0.js";import"./ContactForm.vue_vue_type_script_setup_true_lang-CLRF_VIq.js";import"./index-w2FCJT7Q.js";import"./tree-BMqZf9_I.js";import"./ContractForm.vue_vue_type_script_setup_true_lang-BKXLCfjR.js";import"./ContractProductForm.vue_vue_type_script_setup_true_lang-BBuHPlBt.js";const di=L({name:"CrmBusinessDetail",__name:"index",setup(fi){const N=H(),p=r(0),f=r(!0),a=r({}),n=r(),b=async()=>{f.value=!0;try{a.value=await ei(p.value),await g(p.value)}finally{f.value=!1}},S=r(),v=r(),R=r(),U=()=>{var o;(o=R.value)==null||o.open(a.value.id)},k=r([]),g=async o=>{if(!o)return;const l=await X({bizType:m.CRM_BUSINESS,bizId:o});k.value=l.list},{delView:x}=ii(),{currentRoute:F}=O(),_=()=>{x(i(F))},{params:C}=Q();return V(async()=>{if(!C.id)return N.warning("\u53C2\u6570\u9519\u8BEF\uFF0C\u5546\u673A\u4E0D\u80FD\u4E3A\u7A7A\uFF01"),void _();p.value=C.id,await b()}),(o,l)=>{const y=J,s=K,D=Y,T=P,W=Z,h=$;return u(),j(G,null,[A((u(),d(ai,{business:i(a)},{default:t(()=>{var w,I,B;return[(w=i(n))!=null&&w.validateWrite?(u(),d(y,{key:0,onClick:l[0]||(l[0]=q=>{return E="update",M=i(a).id,void S.value.open(E,M);var E,M})},{default:t(()=>[c(" \u7F16\u8F91 ")]),_:1})):z("",!0),(I=i(n))!=null&&I.validateWrite?(u(),d(y,{key:1,disabled:i(a).endStatus,type:"success",onClick:l[1]||(l[1]=q=>{v.value.open(a.value)})},{default:t(()=>[c(" \u53D8\u66F4\u5546\u673A\u72B6\u6001 ")]),_:1},8,["disabled"])):z("",!0),(B=i(n))!=null&&B.validateOwnerUser?(u(),d(y,{key:2,type:"primary",onClick:U},{default:t(()=>[c(" \u8F6C\u79FB ")]),_:1})):z("",!0)]}),_:1},8,["business"])),[[h,i(f)]]),e(W,null,{default:t(()=>[e(T,null,{default:t(()=>[e(s,{label:"\u8DDF\u8FDB\u8BB0\u5F55"},{default:t(()=>[e(li,{"biz-id":i(p),"biz-type":i(m).CRM_BUSINESS},null,8,["biz-id","biz-type"])]),_:1}),e(s,{label:"\u8BE6\u7EC6\u8D44\u6599"},{default:t(()=>[e(ti,{business:i(a)},null,8,["business"])]),_:1}),e(s,{label:"\u8054\u7CFB\u4EBA",lazy:""},{default:t(()=>[e(mi,{"biz-id":i(a).id,"biz-type":i(m).CRM_BUSINESS,"business-id":i(a).id,"customer-id":i(a).customerId},null,8,["biz-id","biz-type","business-id","customer-id"])]),_:1}),e(s,{label:"\u4EA7\u54C1"},{default:t(()=>[e(ni,{business:i(a)},null,8,["business"])]),_:1}),e(s,{label:"\u5408\u540C",lazy:""},{default:t(()=>[e(pi,{"biz-id":i(a).id,"biz-type":i(m).CRM_BUSINESS},null,8,["biz-id","biz-type"])]),_:1}),e(s,{label:"\u64CD\u4F5C\u65E5\u5FD7"},{default:t(()=>[e(D,{"log-list":i(k)},null,8,["log-list"])]),_:1}),e(s,{label:"\u56E2\u961F\u6210\u5458"},{default:t(()=>[e(ri,{ref_key:"permissionListRef",ref:n,"biz-id":i(a).id,"biz-type":i(m).CRM_BUSINESS,"show-action":!0,onQuitTeam:_},null,8,["biz-id","biz-type"])]),_:1})]),_:1})]),_:1}),e(si,{ref_key:"formRef",ref:S,onSuccess:b},null,512),e(ui,{ref_key:"statusFormRef",ref:v,onSuccess:b},null,512),e(oi,{ref_key:"transferFormRef",ref:R,"biz-type":i(m).CRM_BUSINESS,onSuccess:_},null,8,["biz-type"])],64)}}});export{di as default};
